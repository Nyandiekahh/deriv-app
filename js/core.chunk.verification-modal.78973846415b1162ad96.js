"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1470],{114321:(e,t,i)=>{i.d(t,{A:()=>a});i(286326);var n=i(237064),o=i(592353),r=i(919796),s=i(836870);const a=({children:e,className:t,full_width:i,icon:a,is_disabled_for_mobile:l=!1,message:c,text:d})=>{const{isDesktop:u}=(0,r.Y)();return(0,s.jsx)(o.Div100vhContainer,{className:(0,n.A)("account-management__message-wrapper",{"account-management__message-wrapper-full-width":i}),is_disabled:u||l,height_offset:"110px",children:(0,s.jsxs)("div",{className:(0,n.A)("account-management__message-content",{[`${t}__message-content`]:t}),children:[a&&(0,s.jsx)("div",{className:(0,n.A)("account-management__message-icon",{[`${t}__message-icon`]:t}),children:a}),(0,s.jsx)(o.Text,{as:"div",color:"general",weight:"bold",align:"center",className:(0,n.A)("account-management__message",{[`${t}__message`]:t}),children:c}),d&&(0,s.jsx)("div",{className:"account-management__text-container",children:(0,s.jsx)(o.Text,{className:(0,n.A)({[`${t}__text`]:t}),as:"p",size:"xs",align:"center",children:d})}),e]})})}},155142:(e,t,i)=>{i.d(t,{A:()=>n});const n=i(114321).A},513617:(e,t,i)=>{i.d(t,{A:()=>_});var n=i(286326),o=i(978513),r=i(338508),s=i(773835),a=i(438295);const l=["data"];function c(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function d(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?c(Object(i),!0).forEach((function(t){u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const _=()=>{const e=(0,o.getActiveAuthTokenIDFromLocalStorage)(),t=(0,r.A)(),{switchEnvironment:i,queryClient:c}=(0,a.xH)(),[u,_]=(0,n.useState)((0,o.getActiveLoginIDFromLocalStorage)()),m=(0,s.A)("authorize",{payload:{authorize:e||""},options:{enabled:Boolean(e),refetchOnWindowFocus:!1,refetchOnReconnect:!1}}),{data:f}=m,p=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(m,l),b=(0,n.useMemo)((()=>d({},null==f?void 0:f.authorize)),[null==f?void 0:f.authorize]);return d({data:b,switchAccount:(0,n.useCallback)((e=>{const t=(0,o.getActiveLoginIDFromLocalStorage)();t!==e&&(sessionStorage.setItem("active_loginid",e),localStorage.setItem("active_loginid",e),i(t),c.cancelQueries(),_(e))}),[t,i,u]),currentLoginID:u},p)}},780146:(e,t,i)=>{i.d(t,{A:()=>c});var n=i(286326),o=i(773835);const r=["data"];function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){l(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function l(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const c=()=>{const e=(0,o.A)("residence_list"),{data:t}=e,i=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,r),s=(0,n.useMemo)((()=>t&&t.residence_list?t.residence_list.map((e=>a({},e))):[]),[t]);return a({data:s},i)}},672313:(e,t,i)=>{i.d(t,{A:()=>f});var n=i(286326),o=i(513617),r=i(773835),s=i(338508),a=i(108340);const l=["data"],c=["mutate"];function d(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function u(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?d(Object(i),!0).forEach((function(t){_(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}const f=()=>{const{isSuccess:e}=(0,o.A)(),t=(0,r.A)("get_settings",{options:{enabled:e}}),{data:i}=t,d=m(t,l),_=(0,a.A)("set_settings",{onSuccess:()=>b("get_settings")}),{mutate:f}=_,p=m(_,c),b=(0,s.A)(),x=(0,n.useCallback)((e=>f({payload:e})),[f]),h=(0,n.useMemo)((()=>{var e,t,n,o,r,s,a,l,c,d;const _=null!==(e=null==i||null===(t=i.get_settings)||void 0===t?void 0:t.citizen)&&void 0!==e?e:"",m=null!==(n=null==i||null===(o=i.get_settings)||void 0===o?void 0:o.account_opening_reason)&&void 0!==n?n:"",f=null!==(r=null==i||null===(s=i.get_settings)||void 0===s?void 0:s.place_of_birth)&&void 0!==r?r:"",p=null!==(a=null==i||null===(l=i.get_settings)||void 0===l?void 0:l.tax_residence)&&void 0!==a?a:"",b=null!==(c=null==i||null===(d=i.get_settings)||void 0===d?void 0:d.tax_identification_number)&&void 0!==c?c:"";return u(u({},null==i?void 0:i.get_settings),{},{has_submitted_personal_details:Boolean(_&&m&&f&&p&&b)})}),[null==i?void 0:i.get_settings]);return u({data:h,update:x,mutation:p},d)}},338508:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(286326),o=i(348932);const r=()=>{const e=(0,o.jE)();return(0,n.useCallback)(((t,i)=>e.invalidateQueries(Array.isArray(t)?t:[t],i)),[e])}},95627:(e,t,i)=>{i.r(t),i.d(t,{default:()=>on});var n=i(286326),o=i(592353),r=i(500309),s=i(414646),a=i(504377),l=i(33118),c=i(155142),d=i(836870);const u=({onClick:e})=>(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:(0,d.jsx)(l.Localize,{i18n_default_text:"New proof of address is needed"}),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Your document for proof of address is expired. <0/>Please submit again.",components:[(0,d.jsx)("br",{},0)]}),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaUpload",size:128}),children:(0,d.jsx)(o.Button,{onClick:e,has_effect:!0,primary:!0,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Resubmit"})})})})}),_=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of address verification not required"),text:(0,l.localize)("Your account does not need address verification at this time. We will inform you if address verification is required in the future."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128})});var m=i(824223),f=i(919796),p=i(205007);const b=({error_message:e})=>(0,d.jsx)(c.A,{message:e,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaLock",size:128})});var x=i(291218);const h=({back:e,leave:t})=>{const{isMobile:i}=(0,f.Y)();return(0,d.jsx)(c.A,{className:"leave-confirm",message:(0,l.localize)("Unsaved changes"),text:(0,l.localize)("You have unsaved changes. Are you sure you want to discard changes and leave this page?"),icon:(0,d.jsx)(o.Icon,{icon:"IcUnsavedChanges",size:i?93:128,data_testid:"dt_unsaved_changes_icon"}),is_disabled_for_mobile:!0,children:(0,d.jsxs)("div",{className:"account-management-flex-wrapper account-management-leave-confirm",children:[(0,d.jsx)(o.Button,{type:"button",has_effect:!0,onClick:e,text:(0,l.localize)("Cancel"),secondary:!0,large:i}),(0,d.jsx)(o.Button,{type:"button",has_effect:!0,onClick:t,text:(0,l.localize)("Leave Settings"),primary:!0,large:i})]})})},y=(0,x.withRouter)((({dirty:e,onDirty:t})=>{const i=(0,x.useHistory)(),r=(0,x.useLocation)(),{isMobile:s}=(0,f.Y)(),[a,l]=n.useState(!1),[c,u]=n.useState(r.pathname);n.useEffect((()=>{const n=i.block((i=>!(e&&!a)||(t&&t(!1),u(i.pathname),l(!0),!1)));return()=>n()}),[e,a,i,t]);const _=n.useCallback((()=>{c&&(l(!1),i.push(c),t&&t(!1))}),[c,i,t]),m=()=>{l(!1),u(r.pathname),t&&t(!0)};return(0,d.jsx)(d.Fragment,{children:a&&s?(0,d.jsx)(h,{back:m,leave:_}):(0,d.jsx)(o.Modal,{is_open:a,small:!0,toggleModal:m,children:(0,d.jsx)(o.Modal.Body,{children:(0,d.jsx)(h,{back:m,leave:_})})})})})),g=({onDirty:e})=>(0,d.jsx)(m.FormikConsumer,{children:t=>(0,d.jsx)(y,{onDirty:e,dirty:t.dirty&&0===t.submitCount})});var v=i(837062);const j=Object.freeze({DUPLICATE_ACCOUNT:"DuplicateAccount",CLAIMED_DOCUMENT:"ClaimedDocument",DUPLICATE_DOCUMENT:"DuplicateUpload"});var O=i(596176),w=i(237064);const S=()=>{const{isDesktop:e,isMobile:t}=(0,f.Y)();return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Icon,{icon:"IcUpload",className:"dc-file-dropzone__message-icon",size:30}),(0,d.jsxs)("div",{className:"dc-file-dropzone__message-subtitle",children:[(0,d.jsx)(o.Text,{size:"xxs",align:"center",weight:"bold",color:"less-prominent",children:e?(0,d.jsx)(l.Localize,{i18n_default_text:"Drag and drop a file or click to browse your files."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Click here to browse your files."})}),(0,d.jsx)(o.Text,{size:t?"xxxxs":"xxxs",align:"center",color:"less-prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Remember, selfies, pictures of houses, or non-related images will be rejected."})})]})]})},P=({onFileDrop:e,onError:t})=>{const[i,r]=n.useState([]),[s,c]=n.useState(null);n.useEffect((()=>{i&&(e(i),null==t||t(""))}),[i,e,t]);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.FileDropzone,{accept:a.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:26,hover_message:(0,l.localize)("Drop files here.."),max_size:a.max_document_size,message:(0,d.jsx)(S,{}),multiple:!1,onDropAccepted:e=>{e.length>0&&(r(e),c(null),null==t||t(""))},onDropRejected:e=>{const i=e.length>0&&e[0].file.size>a.max_document_size,n=e.filter((e=>(0,a.getSupportedFiles)(e.file.name))),o=i&&n.length>0?(0,l.localize)("File size should be 8MB or less"):(0,l.localize)("File uploaded is not supported");r([]),null==t||t(o),c(o)},validation_error_message:s,value:i}),(i&&(null==i?void 0:i.length)>0||s)&&(0,d.jsx)("div",{className:"file-uploader__remove-btn-container",children:(0,d.jsx)(o.Icon,{icon:"IcCloseCircle",className:(0,w.A)("file-uploader__remove-btn",{"file-uploader__remove-btn--error":s}),onClick:()=>{r([]),c(null),null==t||t("")},color:"secondary",data_testid:"dt_remove_file_icon"})})]})};var z=i(773835);const N=["data"];function D(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function k(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const A=e=>{const{client:t}=(0,s.A)(),{is_authorize:i}=t,n=(0,z.A)("kyc_auth_status",{payload:e,options:{enabled:i}}),{data:o}=n,r=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(n,N);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?D(Object(i),!0).forEach((function(t){k(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({kyc_auth_status:null==o?void 0:o.kyc_auth_status},r)},T=(e,t)=>{const i={title:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must be recent and include your name and address:"}),descriptions:[{id:"signed_document",value:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must be up-to-date and signed by the issuance authority."})},{id:"contains_letterhead",value:(0,d.jsx)(O.Localize,{i18n_default_text:"The document must contain a letterhead."})},{id:"invalid_rejected",value:(0,d.jsx)(O.Localize,{i18n_default_text:"Invalid or incomplete documents shall be rejected."})}]},n={title:(0,d.jsx)(O.Localize,{i18n_default_text:"Upload an original (unaltered) document that clearly shows your name and address, issued within the past {{expiry_in_months}} months. We accept:",values:{expiry_in_months:t?6:12}}),descriptions:[{id:"utility_bill",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Utility bill:</0> Electricity, water, gas, or landline phone bill.",components:[(0,d.jsx)("strong",{},0)]})},{id:"financial_legal_government_document",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Financial, legal, or government document:</0> Recent bank statement, affidavit, or government-issued letter.",components:[(0,d.jsx)("strong",{},0)]})},{id:"tenancy_agreement",value:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Tenancy agreement:</0> Valid and current agreement.",components:[(0,d.jsx)("strong",{},0)]})}]};return"poinc"===e?i:"poa"===e?n:{title:"",descriptions:[]}},I=()=>[{value:"utility_bill",text:(0,O.localize)("Utility bill (electricity, water, gas)")},{value:"phone_bill",text:(0,O.localize)("Landline phone bill")},{value:"bank_statement",text:(0,O.localize)("Bank statement")},{value:"affidavit",text:(0,O.localize)("Official residence declaration or affidavit")},{value:"official_letter",text:(0,O.localize)("Official letter issued by the government or solicitor")},{value:"rental_agreement",text:(0,O.localize)("Rental/tenancy agreement")},{text:(0,O.localize)("Others"),value:"poa_others"}];function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach((function(t){L(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function L(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const F=({examples:e,files_description:t,country_of_residence:i,onFileDrop:r,onError:s,placeholder:a})=>{const{isMobile:l}=(0,f.Y)(),{localize:c}=(0,O.useTranslations)(),{kyc_auth_status:u,isLoading:_}=A({country:i}),[p,b]=n.useState([]);return n.useEffect((()=>{if(u){const{address:e}=u,{supported_documents:t}=e,i=I().filter((e=>null==t?void 0:t.includes(e.value)));b(i)}}),[u]),_?(0,d.jsx)(o.Loading,{is_fullscreen:!1}):(0,d.jsxs)("div",{className:"file-uploader__container","data-testid":"dt_file_uploader_container",children:[t,e,i&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{size:l?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Select the type of document:"})}),(0,d.jsx)(m.Field,{name:"document_type",children:({field:e,form:{setFieldValue:t}})=>(0,d.jsx)(o.Autocomplete,C(C({},e),{},{"data-lpignore":"true",autoComplete:"off",list_items:p,type:"text",value:e.value,label:a,placeholder:null!=a?a:c("Select a document"),onItemSelection:e=>{t("document_type",e.text,!0)},required:!0}))})]}),(0,d.jsx)(o.Text,{size:l?"xxs":"xs",as:"div",className:"file-uploader__file-title",weight:"bold",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Upload file"})}),(0,d.jsx)("div",{className:"file-uploader__file-dropzone-wrapper",children:(0,d.jsx)(P,{onError:s,onFileDrop:r})}),(0,d.jsxs)("div",{className:"file-uploader__file-supported-formats",children:[(0,d.jsx)(o.Text,{size:l?"xxxs":"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Supported formats: JPEG, JPG, PNG, PDF, and GIF only"})}),(0,d.jsx)(o.Text,{size:l?"xxxs":"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"Maximum size: 8MB"})})]})]})},R=({descriptions:e,title:t})=>{const{isMobile:i}=(0,f.Y)();return(0,d.jsxs)("div",{className:"files-description",children:[(0,d.jsx)(o.Text,{size:i?"xxs":"xs",as:"div",className:"files-description__title",weight:"bold",children:t}),(0,d.jsx)("ul",{children:e.map((e=>(0,d.jsx)("li",{children:(0,d.jsx)(o.Text,{size:i?"xxs":"xs",line_height:i?"l":"xl",children:e.value})},e.id)))})]})},M=({children:e,className:t,scroll_offset:i,isFullHeight:n=!1})=>{const{isDesktop:r}=(0,f.Y)(),s=n?"100vh":"100%";return(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:!r,height:i?`calc(${s} - ${i})`:"100%",children:(0,d.jsx)("div",{className:(0,w.A)("account__scrollbars_container",t),"data-testid":"dt_scrollbar_container_div",children:e})})},U=({children:e,scroll_offset:t,className:i,isFullHeight:r})=>{const{isDesktop:s}=(0,f.Y)();return(0,d.jsx)(n.Fragment,{children:s?(0,d.jsx)(M,{className:(0,w.A)("account__scrollbars_container--grid-layout",i),scroll_offset:t,isFullHeight:r,children:e}):(0,d.jsx)(o.Div100vhContainer,{className:(0,w.A)("account__scrollbars_container--grid-layout",i),height_offset:t||"100%",children:e})})};var V=i(37811);const B=({children:e,className:t})=>(0,d.jsx)("div",{className:(0,w.A)("account-form__footer",t),"data-testid":"form-footer-container",children:e});var Y=i(138768),q=i(678891),$=i(602012),W=i(429106),H=i(338535),G=i(496148),J=i(936017),Z=i(296049);function K(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach((function(t){X(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function X(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var ee=i(345102);const te=({description:e,image:t})=>(0,d.jsxs)("div",{className:"common-mistake-examples__content-layout",children:[t,(0,d.jsxs)("div",{className:"common-mistake-examples__content-description",children:[(0,d.jsx)(ee.A,{iconSize:"xs"}),(0,d.jsx)(o.Text,{size:"xxxs",line_height:"s",role:"document",children:e})]})]}),ie=()=>{const{isDesktop:e}=(0,f.Y)(),{client:t}=(0,s.A)(),{is_eu:i}=t,r=(e=>[{image:q.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Name in document doesn’t match your Deriv profile."}),ref:"name_mismatch"},{image:$.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Address in document doesn’t match address you entered above."}),ref:"address_mismatch"},Q({},e?{image:W.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 6-months ago."}),ref:"old_6_month_issued_document"}:{image:H.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Document issued more than 12-months ago."}),ref:"old_12_month_issued_document"}),{image:G.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Blurry document. All information must be clear and visible."}),ref:"blurry_document"},{image:J.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"Cropped document. All information must be clear and visible."}),ref:"cropped_document"},{image:Z.A,description:(0,d.jsx)(l.Localize,{i18n_default_text:"An envelope with your name and address."}),ref:"envelope"}])(i);return(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{as:"div",weight:"bold",size:e?"xs":"xxs",className:"common-mistake-examples__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Common mistakes"})}),(0,d.jsx)("div",{className:"common-mistake-examples__content",children:r.map((e=>(0,d.jsx)(te,{description:e.description,image:(0,d.jsx)(e.image,{})},e.ref)))})]})};var ne=i(791768);const oe=(0,r.observer)((({className:e,setOffset:t,is_for_cfd_modal:i,is_resubmit:r,setDocumentFiles:a,document_files:l,form_state:c})=>{const{status:u,handleSubmit:_,isSubmitting:p,isValid:b}=(0,m.useFormikContext)(),{isDesktop:x}=(0,f.Y)(),{client:h}=(0,s.A)(),[y,g]=n.useState(null),{localize:v}=(0,O.useTranslations)(),{states_list:j,account_settings:w,is_eu:S,getChangeableFields:P}=h,z=P(),N=n.useMemo((()=>T("poa",S)),[]);return(0,d.jsxs)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:_,children:[(0,d.jsx)(o.ThemedScrollbars,{height:"572px",is_bypassed:!i||!x,className:e,children:(0,d.jsxs)(U,{scroll_offset:t(u),isFullHeight:!x,children:[((null==u?void 0:u.msg)||r)&&(0,d.jsx)(o.InlineMessage,{type:"error",message:(0,d.jsxs)(o.Text,{as:"p",size:"xs",children:[!(null!=u&&u.msg)&&r&&(0,d.jsx)(O.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==u?void 0:u.msg]}),id:"dt_poa_submit-error"}),(0,d.jsx)(Y.A,{title:v("Enter your address"),title_text_size:"s"}),(0,d.jsx)(ne.A,{is_qualified_for_poa:!0,editable_fields:z,states_list:j}),(0,d.jsx)(Y.A,{title:v("Submit your document"),title_text_size:"s"}),(0,d.jsx)(V.A,{children:(0,d.jsx)(F,{onFileDrop:e=>{a(e)},onError:g,files_description:(0,d.jsx)(R,{title:N.title,descriptions:N.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==w?void 0:w.country_code,placeholder:v("Type of document")})})]})}),i?(0,d.jsx)(o.Modal.Footer,{has_separator:!0,children:(0,d.jsx)(o.FormSubmitButton,{is_disabled:p||!b||l&&l.length<1||!!y,label:v("Continue"),is_loading:p})}):(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"submit",is_disabled:p||!b||l&&l.length<1||!!y,has_effect:!0,is_loading:c.is_btn_loading,is_submit_success:c.is_submit_success,text:v("Save and submit"),primary:!0})})]})}));var re=i(182997);function se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ae(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?se(Object(i),!0).forEach((function(t){le(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function le(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ce=({is_active:e})=>(0,d.jsx)("div",{className:"progress-container",children:(0,d.jsx)("div",{className:(0,w.A)("progress-bar",{"progress-bar--animate":e})})}),de=(0,r.observer)((({setOffset:e,is_resubmit:t,form_state:i,document_files:r,setDocumentFiles:a,is_for_cfd_modal:l})=>{const{localize:c}=(0,O.useTranslations)(),{status:u,handleSubmit:_,isSubmitting:f,isValid:p,values:b,errors:x}=(0,m.useFormikContext)(),{client:h}=(0,s.A)(),[y,g]=n.useState(null),[v,j]=n.useState({id:1,text:c("Enter your address")}),{states_list:S,account_settings:P,is_eu:z,getChangeableFields:N}=h,D=N(),k=n.useMemo((()=>T("poa",z)),[z]),A=n.useMemo((()=>2!==v.id&&!(b.address_line_1&&!x.address_line_1&&!x.address_line_2&&b.address_city&&!x.address_city&&!x.address_state&&!x.address_postcode)),[b,x,v.id]);return(0,d.jsxs)("div",{className:"poa-mobile-layout",children:[(0,d.jsxs)("div",{className:(0,w.A)("poa-header",{"poa-header--non-modal":!l}),children:[(0,d.jsxs)("div",{className:"timeline",children:[2===v.id&&(0,d.jsx)(re.A,{onClick:()=>j({id:1,text:c("Enter your address")})}),(0,d.jsx)(o.Text,{as:"p",size:"xxs",children:(0,d.jsx)(O.Localize,{i18n_default_text:"<0>Step {{step}}/2: </0> {{title}}",values:{step:v.id,title:v.text},components:[(0,d.jsx)("strong",{},0)]})})]}),(0,d.jsxs)("div",{className:"timeline-item",children:[(0,d.jsx)(ce,{is_active:v.id<=2}),(0,d.jsx)(ce,{is_active:2===v.id})]})]}),(0,d.jsx)(m.Form,{noValidate:!0,className:"account-form account-form_poa",onSubmit:_,children:(0,d.jsxs)(U,{scroll_offset:e(u),children:[((null==u?void 0:u.msg)||t)&&(0,d.jsx)(o.InlineMessage,{type:"error",message:(0,d.jsxs)(o.Text,{as:"p",size:"xxxs",children:[!(null!=u&&u.msg)&&t&&(0,d.jsx)(O.Localize,{i18n_default_text:"We were unable to verify your address with the details you provided. Please check and resubmit or choose a different document type."}),null==u?void 0:u.msg]}),className:"poa-error-banner",id:"dt_poa_submit-error"}),1===v.id&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(ne.A,{is_qualified_for_poa:!0,editable_fields:D,states_list:S}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"button",has_effect:!0,text:c("Next"),primary:!0,is_disabled:A,onClick:()=>j((e=>ae(ae({},e),{},{id:2,text:c(" Document submission")})))})})]}),2===v.id&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(F,{onFileDrop:e=>{a(e)},onError:g,files_description:(0,d.jsx)(R,{title:k.title,descriptions:k.descriptions}),examples:(0,d.jsx)(ie,{}),country_of_residence:null==P?void 0:P.country_code,placeholder:c("Type of document")}),(0,d.jsx)(B,{className:"account-form__footer-poa",children:(0,d.jsx)(o.Button,{className:"account-form__footer-btn",type:"submit",has_effect:!0,text:c("Submit"),primary:!0,is_disabled:f||!p||r&&r.length<1||!!y,is_loading:i.is_btn_loading,is_submit_success:i.is_submit_success})})]})]})})]})}));function ue(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _e(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(i),!0).forEach((function(t){me(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ue(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function me(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const fe=(0,r.observer)((({is_resubmit:e,is_for_cfd_modal:t,onSubmit:i,onSubmitForCFDModal:r,className:l})=>{const{isMobile:c,isDesktop:u}=(0,f.Y)(),{client:_,notifications:x}=(0,s.A)(),{account_settings:h,fetchResidenceList:y,fetchStatesList:w,states_list:S}=_,{addNotificationMessageByKey:P,removeNotificationMessage:z,removeNotificationByKey:N}=x,[D,k]=n.useState([]),[A,T]=n.useState(!0),[E,C]=n.useState({address_line_1:"",address_line_2:"",address_city:"",address_state:"",address_postcode:""}),[L,F]=n.useState(null),[R,M]=n.useState({is_btn_loading:!1,is_submit_success:!1,should_allow_submit:!0,should_show_form:!0}),[U,V]=n.useState(!1),{upload:B}=(0,p.A)(),{localize:Y}=(0,O.useTranslations)();n.useEffect((()=>{null==y||y().then((async()=>{Promise.all([w(),a.WS.wait("get_settings")]).then((()=>{var e,t,i,n,o;C({address_line_1:null!==(e=h.address_line_1)&&void 0!==e?e:"",address_line_2:null!==(t=h.address_line_2)&&void 0!==t?t:"",address_city:null!==(i=h.address_city)&&void 0!==i?i:"",address_state:null!==(n=h.address_state)&&void 0!==n?n:"",address_postcode:null!==(o=h.address_postcode)&&void 0!==o?o:""}),T(!1)}))}))}),[h,y,w]),n.useEffect((()=>{if(U){var e;const t=document.querySelector("#dt_poa_submit-error"),i=null!==(e=null==t?void 0:t.parentElement)&&void 0!==e?e:t;"function"==typeof(null==i?void 0:i.scrollIntoView)&&(null==i||i.scrollIntoView({behavior:"smooth",block:"start"})),V(!1)}}),[U]);const q=e=>{M(_e(_e({},R),{should_show_form:e}))},{address_line_1:$,address_line_2:W,address_city:H,address_state:G,address_postcode:J}=E,Z={address_line_1:$,address_line_2:W,address_city:H,address_state:G,address_postcode:J,document_type:""};if(L)return(0,d.jsx)(b,{error_message:L});if(A)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(Z.address_state){const e=(0,a.getLocation)(S,Z.address_state,"text");Z.address_state=S.length&&e?e:Z.address_state}else Z.address_state="";const K=e=>{const i=null!=e&&e.msg?"200px":"166px";return u||t?"94px":i};return(0,d.jsx)(m.Formik,{initialValues:Z,onSubmit:async(e,{setStatus:n,setSubmitting:o})=>{n({msg:""}),M(_e(_e({},R),{is_btn_loading:!0}));const s=_e({},e);e.address_state&&S.length&&(s.address_state=(0,a.getLocation)(S,e.address_state,"value")||""),null==s||delete s.document_type;const l=await a.WS.setSettings(s);if(l.error)return n({msg:l.error.message}),M(_e(_e({},R),{is_btn_loading:!1})),o(!1),void V(!0);const c=await a.WS.authorized.storage.getSettings();if(c.error)return F(c.error.message),void o(!1);const d=c.get_settings,{address_line_1:u,address_line_2:_,address_city:m,address_state:f,address_postcode:p}=d;C({address_line_1:u,address_line_2:_,address_city:m,address_state:f,address_postcode:p});try{const s=I().find((t=>t.text===e.document_type)),l=await B(D,{document_type:null==s?void 0:s.value});if(null!=l&&l.warning)return M(_e(_e({},R),{is_btn_loading:!1})),void(l.warning===j.DUPLICATE_DOCUMENT?t?null==r||r(e,!0):null==i||i(!1,!0):(n({msg:null==l?void 0:l.message}),V(!0)));const c=await a.WS.authorized.getAccountStatus();if(!c||c.error)return F(c.error.message),void o(!1);const d=c.get_account_status;M(_e(_e({},R),{is_submit_success:!0,is_btn_loading:!1}));const{needs_verification:u}=d.authentication,_=Boolean(u.length)&&u.includes("identity");null==i||i(_),["authenticate","needs_poa","poa_expired"].forEach((e=>{z({key:e}),N({key:e})})),_&&P("needs_poi")}catch(e){(0,v.GQ)(e)&&(n({msg:e.message}),o(!1),M(_e(_e({},R),{is_btn_loading:!1})),V(!0))}t&&(null==r||r(e))},validate:e=>{M(_e(_e({},R),{should_allow_submit:!1}));const t={};(0,v.tf)(t,e)((e=>e),["address_line_1","address_city"],Y("This field is required"));const i=(0,a.validAddress)(e.address_line_1,{is_required:!0});i.is_ok||(t.address_line_1=i.message);const n=(0,a.validAddress)(e.address_line_2);n.is_ok||(t.address_line_2=n.message);const o=Y("Only letters, space, hyphen, period, and apostrophe are allowed.");return e.address_city&&!(0,a.validLetterSymbol)(e.address_city)&&(t.address_city=o),e.address_state&&!(0,a.validAddressState)(e.address_state)&&(null==S?void 0:S.length)<1&&(t.address_state=o),e.address_postcode&&((0,a.validLength)(e.address_postcode,{min:0,max:20})?(0,a.validPostCode)(e.address_postcode)||(t.address_postcode=Y("Only letters, numbers, space, and hyphen are allowed.")):t.address_postcode=Y("Please enter a {{field_name}} under {{max_number}} characters.",{field_name:Y("Postal/ZIP code"),max_number:20,interpolation:{escapeValue:!1}})),e.document_type||(t.document_type=Y("Document type is required.")),t},enableReinitialize:!0,validateOnMount:!0,children:()=>(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(g,{onDirty:u?void 0:q}),R.should_show_form&&(c?(0,d.jsx)(de,{setOffset:K,is_for_cfd_modal:t,is_resubmit:e,setDocumentFiles:k,document_files:D,form_state:R}):(0,d.jsx)(oe,{className:l,setOffset:K,is_for_cfd_modal:t,is_resubmit:e,setDocumentFiles:k,document_files:D,form_state:R}))]})})})),pe=({button_label:e,className:t,route:i})=>(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",t),to:i,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"route_btn_text",children:e})}),be=({needs_poi:e,redirect_button:t})=>{const i=(0,l.localize)("Review in progress"),n=(0,a.isNavigationFromP2P)()||(0,a.isNavigationFromDerivGO)();return e?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsxs)(c.A,{message:i,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days.")}),(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:(0,l.localize)("To start trading, you also need to verify your identity.")})]}),(0,d.jsx)(pe,{button_label:(0,l.localize)("Next"),route:a.routes.proof_of_identity})]})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:i,text:(0,l.localize)("Your proof of address is under review. We’ll get back to you in 1–3 working days."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:t||!n&&(0,d.jsx)(pe,{button_label:(0,l.localize)("Return to Trader's Hub"),route:a.routes.traders_hub})})})},xe=({title:e,description:t,button_text:i,onClick:n})=>(0,d.jsx)(c.A,{message:null!=e?e:(0,l.localize)("We could not verify your proof of address"),text:null!=t?t:(0,l.localize)("Please check your email for details."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaError",size:128}),children:(0,d.jsx)(o.Button,{onClick:n,has_effect:!0,primary:!0,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",size:"xs",weight:"bold",as:"p",children:null!=i?i:(0,l.localize)("Resubmit")})})});var he=i(119180);const ye=({className:e})=>(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",e),to:he.routes.trade,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"continue_btn_text",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Continue trading"})})}),ge=()=>(0,d.jsx)(o.ButtonLink,{className:"account-management__button",to:"/account/proof-of-identity",children:(0,d.jsx)(o.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:(0,l.localize)("Proof of identity")})}),ve=({needs_poi:e,redirect_button:t})=>{const i=(0,l.localize)("Your proof of address is verified"),n=(0,a.isNavigationFromP2P)()||(0,a.isNavigationFromDerivGO)();return e?(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:i,text:(0,l.localize)("To continue trading, you must also submit a proof of identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:(0,d.jsx)(ge,{})})}):(0,d.jsx)("div",{className:"account-management__container",children:(0,d.jsx)(c.A,{message:i,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),children:t||!n&&(0,d.jsx)(ye,{})})})},je=ve,Oe=e=>{if(!e||!e.authentication)return{};const{attempts:t,document:i,identity:n,income:o,needs_verification:r}=e.authentication,s=n.status,a=i.status,l=o.status,c=e.status.some((e=>"allow_document_upload"===e)),d=e.status.some((e=>"allow_poi_resubmission"===e)),u=e.status.some((e=>"allow_poa_resubmission"===e)),_=e.status.some((e=>"allow_poinc_resubmission"===e)),m=e.status.some((e=>"age_verification"===e)),f=e.status.some((e=>"authenticated"===e)),p=e.status.some((e=>"idv_disallowed"===e)),b=e.status.some((e=>"poa_address_mismatch"===e)),x=e.status.some((e=>"poi_expiring_soon"===e)),h=e.status.some((e=>"poa_authenticated_with_idv"===e)),y=e.status.some((e=>"poa_authenticated_with_idv_photo"===e)),g=e.status.some((e=>"poa_expiring_soon"===e)),v=["pending","verified"].includes(s),j=!(i&&"none"===i.status),O=!(n&&"none"===n.status),w=!(o&&"none"===o.status),S="pending"===a&&!u,P=!(S||"verified"===a)||r.length&&r.includes("document"),z=!v||Boolean(r.length)&&r.includes("identity"),N=r.length&&r.includes("income"),{idv:D,onfido:k,manual:A}=n.services,T=t.latest;return{allow_document_upload:c,allow_poa_resubmission:u,allow_poi_resubmission:d,allow_poinc_resubmission:_,has_attempted_idv:Boolean(t.history.length&&t.history.find((e=>"idv"===e.service))),has_poa:j,has_poi:O,has_poinc:w,has_submitted_poa:S,identity_last_attempt:T,identity_status:s,document_status:a,income_status:l,idv:D,is_age_verified:m,is_fully_authenticated:f,is_idv_disallowed:p,manual:A,needs_poa:P,needs_poi:z,needs_poinc:N,needs_verification:r,onfido:k,poa_address_mismatch:b,poa_authenticated_with_idv:h,poa_authenticated_with_idv_photo:y,poi_expiring_soon:x,poa_expiring_soon:g}};function we(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Se(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?we(Object(i),!0).forEach((function(t){Pe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):we(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Pe(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ze=(0,r.observer)((({onSubmit:e})=>{var t;const[i,r]=n.useState(!0),[c,m]=n.useState({allow_document_upload:!1,allow_poi_resubmission:!1,allow_poa_resubmission:!1,needs_poi:!1,needs_poa:!1,has_poi:!1,resubmit_poa:!1,has_submitted_poa:!1,document_status:void 0,is_age_verified:!1,poa_address_mismatch:!1,poa_expiring_soon:!1,poa_authenticated_with_idv:!1,poa_authenticated_with_idv_photo:!1,has_submitted_duplicate_poa:!1}),{client:f,notifications:p,common:b,ui:x}=(0,s.A)(),{app_routing_history:h}=b,{has_restricted_mt5_account:y,is_switching:g}=f,{is_verification_modal_visible:v}=x,{refreshNotifications:j}=p,O=localStorage.getItem("mt5_poa_status");n.useEffect((()=>{g||a.WS.authorized.getAccountStatus().then((e=>{const{get_account_status:t}=e;if(t){const{allow_document_upload:e,allow_poa_resubmission:i,document_status:n,has_submitted_poa:o,is_age_verified:s,needs_poa:a,needs_poi:l,poa_address_mismatch:c,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}=Oe(t);m((t=>Se(Se({},t),{},{allow_document_upload:e,allow_poa_resubmission:i,document_status:n,has_submitted_poa:o,is_age_verified:s,needs_poa:a,needs_poi:l,poa_address_mismatch:c,poa_authenticated_with_idv:d,poa_authenticated_with_idv_photo:u,poa_expiring_soon:_}))),r(!1),j()}}))}),[g,j]),n.useEffect((()=>()=>{localStorage.removeItem("mt5_poa_status")}),[]);const w=()=>{m((e=>Se(Se({},e),{resubmit_poa:!0})))},S=(t,i)=>{m((e=>Se(Se({},e),{has_submitted_poa:!0,needs_poi:t,poa_expiring_soon:!1,has_submitted_duplicate_poa:null!=i&&i}))),v&&(null==e||e())},{allow_document_upload:P,allow_poa_resubmission:z,document_status:N,needs_poi:D,resubmit_poa:k,has_submitted_poa:A,poa_address_mismatch:T,poa_expiring_soon:I,poa_authenticated_with_idv:E,poa_authenticated_with_idv_photo:C,has_submitted_duplicate_poa:L}=c,F=(0,a.getPlatformRedirect)(h),R=Object.keys(a.platforms).includes(null!==(t=null==F?void 0:F.ref)&&void 0!==t?t:""),M=k||z||y&&N&&["expired","rejected","suspected"].includes(N)||T||I||(E||C)&&(null==F?void 0:F.route)===a.routes.cashier_p2p,U=R&&(0,d.jsx)(o.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{var e;const t=null===(e=a.platforms[F.ref])||void 0===e?void 0:e.url;t&&(window.location.href=t,window.sessionStorage.removeItem("config.platform"))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:F.name}})});if(i)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});if(!P)return(0,d.jsx)(_,{});if(L)return(0,d.jsx)(xe,{title:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of address documents upload failed"}),description:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),button_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Try again"}),onClick:()=>{m((e=>Se(Se({},e),{resubmit_poa:!0,has_submitted_duplicate_poa:!1,has_submitted_poa:!1})))}});if(A&&!T)return(0,d.jsx)(be,{needs_poi:D,redirect_button:U});if(M)return(0,d.jsx)(fe,{is_resubmit:!I,onSubmit:S});const V=e=>{switch(e){case a.AUTH_STATUS_CODES.NONE:return(0,d.jsx)(fe,{onSubmit:S});case a.AUTH_STATUS_CODES.PENDING:return(0,d.jsx)(be,{needs_poi:D,redirect_button:U});case a.AUTH_STATUS_CODES.VERIFIED:return(0,d.jsx)(je,{needs_poi:D,redirect_button:U});case a.AUTH_STATUS_CODES.EXPIRED:return(0,d.jsx)(u,{onClick:w});case a.AUTH_STATUS_CODES.REJECTED:case a.AUTH_STATUS_CODES.SUSPECTED:return(0,d.jsx)(xe,{onClick:w});default:return null}};return O?V(O):N?V(N):null})),Ne={none:"none",pending:"pending",rejected:"rejected",verified:"verified",expired:"expired",suspected:"suspected"},De="selecting",ke="submitting",Ae="complete",Te="idv",Ie="onfido",Ee="manual",Ce=(0,r.observer)((({has_button:e,icon:t,message:i})=>{const{client:n,ui:r}=(0,s.A)(),{isDesktop:a}=(0,f.Y)(),{has_any_real_account:c}=n,{toggleAccountsDialog:u,toggleShouldShowRealAccountsList:_}=r;return(0,d.jsxs)("div",{className:"da-icon-with-message",children:[(0,d.jsx)(o.Icon,{icon:t,size:128}),(0,d.jsx)(o.Text,{className:"da-icon-with-message__text",as:"p",color:"general",size:a?"s":"xs",line_height:"m",weight:"bold",children:i}),e&&(0,d.jsx)(o.Button,{primary:!0,onClick:()=>{_(!0),u()},className:"account__demo-message-button","data-testid":"icon-with-message-button",children:c?(0,l.localize)("Switch to real account"):(0,l.localize)("Add a real account")})]})})),Le=({has_button:e})=>{const{localize:t}=(0,O.useTranslations)();return(0,d.jsx)(Ce,{icon:"IcPoaLock",message:t("This feature is not available for demo accounts."),has_button:e})};var Fe=i(662988),Re=i(610447),Me=i(160756);const Ue=/deriv\.(com)/.test(window.location.hostname)||/localhost:8443/.test(window.location.host),Ve=({header:e,message:t,code:i,redirect_label:r,redirectOnClick:s,should_show_refresh:l=!0})=>{const{isTmbEnabled:c}=(0,Me.A)(),[u,_]=(0,n.useState)(!1);(0,n.useEffect)((()=>{(async()=>{const e=await c();_(e)})()}),[c]);const m=l?(0,d.jsx)(O.Localize,{i18n_default_text:"Please refresh this page to continue."}):"";if("InvalidToken"===i&&"true"===Re.A.get("logged_state")&&Ue&&!u){try{(0,Fe.ZF)({redirectCallbackUri:`${window.location.origin}/callback`}).catch((e=>{console.error(e)}))}catch(e){console.error(e)}return null}return(0,d.jsx)(o.PageError,{header:e||(0,d.jsx)(O.Localize,{i18n_default_text:"Oops, something went wrong."}),messages:t?[t,m]:[(0,d.jsx)(O.Localize,{i18n_default_text:"Sorry, an error occurred while processing your request."},0),m],redirect_urls:[a.routes.trade],redirect_labels:[null!=r?r:(0,d.jsx)(O.Localize,{i18n_default_text:"Refresh"})],buttonOnClick:null!=s?s:()=>location.reload()})},Be=({handleRequireSubmission:e,is_from_external:t,redirect_button:i})=>(0,d.jsxs)(c.A,{message:(0,l.localize)("New proof of identity document needed"),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiUpload",size:128}),children:[(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:e,large:!0,text:(0,l.localize)("Upload Document"),primary:!0}),!t&&i]});var Ye=i(138150);const qe=({handleRequireSubmission:e})=>{const{setSubmissionStatus:t}=n.useContext(a.POIContext);return(0,d.jsxs)("div",{className:"proof-of-identity__container",children:[(0,d.jsx)(Ye.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(0,l.localize)("ID verification failed")}),(0,d.jsxs)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",size:"xs",children:[(0,l.localize)("We were unable to verify your ID with the details you provided. "),(0,l.localize)("Please upload your identity document.")]}),(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:()=>{e(),t(De)},large:!0,text:(0,l.localize)("Upload identity document"),primary:!0})]})};var $e=i(794216);const We=(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"}),He=({custom_text:e=We,class_name:t})=>(0,d.jsx)(o.ButtonLink,{className:(0,w.A)("account-management__button",t),to:a.routes.proof_of_address,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",as:"p",weight:"bold","data-testid":"poa_button_text",children:e})}),Ge=He,Je=(0,r.observer)((({is_from_external:e,mismatch_status:t,needs_poa:i,redirect_button:r})=>{const{client:c}=(0,s.A)(),{is_already_attempted:u}=c,_=t===a.IDV_ERROR_STATUS.NameDobMismatch.code||t===a.IDV_ERROR_STATUS.DobMismatch.code||t===a.IDV_ERROR_STATUS.NameMismatch.code,m=t===a.IDV_ERROR_STATUS.Expired.code||t===a.IDV_ERROR_STATUS.Failed.code,f=!e&&(0,d.jsx)(Ge,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Next"})});return(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container","proof-of-identity__container--status"),children:[(0,d.jsx)($e.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:(()=>{if(u){if(_)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your profile is updated"});if(m)return(0,d.jsx)(l.Localize,{i18n_default_text:"Your document has been submitted"})}return(0,d.jsx)(l.Localize,{i18n_default_text:"Review in progress"})})()}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text text",size:"xs",align:"center",children:u&&(_||m)?(0,d.jsx)(l.Localize,{i18n_default_text:"We'll review your proof of identity again and will give you an update as soon as possible."}):(0,d.jsx)(l.Localize,{i18n_default_text:"Your proof of identity is under review. We’ll get back to you within 5 minutes."})}),i?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"To start trading, you also need to verify your address."})}),f]}):(0,d.jsx)("div",{className:"proof-of-identity__redirection",children:r})]})})),Ze=n.memo(Je);var Ke=i(84158);const Qe=({needs_poa:e,is_from_external:t,redirect_button:i})=>{const r=e?(0,d.jsx)(l.Localize,{i18n_default_text:"Your ID is verified. You will also need to submit proof of your address."}):(0,d.jsx)(l.Localize,{i18n_default_text:"ID verification passed"}),{isDesktop:s}=(0,f.Y)();return(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container","proof-of-identity__container--status"),"data-testid":"poi_idv_verified_container",children:[(0,d.jsx)(Ke.A,{className:"icon"}),(0,d.jsx)(o.Text,{className:"proof-of-identity__text btm-spacer",align:"center",weight:"bold",children:r}),e?(0,d.jsxs)(n.Fragment,{children:[s&&(0,d.jsx)(o.Text,{className:"text",size:"xs",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Next, we'll need your proof of address."})}),!t&&(0,d.jsx)(He,{custom_text:(0,d.jsx)(l.Localize,{i18n_default_text:"Submit proof of address"})})]}):i||(0,d.jsx)(ye,{className:"continue-trade"})]})},Xe=({handleRequireSubmission:e,idv:t,is_from_external:i,needs_poa:n,redirect_button:o})=>{const{status:r,submissions_left:s,last_rejected:l}=t;switch(r){case Ne.pending:return(0,d.jsx)(Ze,{is_from_external:i,mismatch_status:(0,a.formatIDVError)(l,r),needs_poa:n,redirect_button:o});case Ne.rejected:case Ne.suspected:case Ne.expired:return Number(s)<1?(0,d.jsx)(qe,{handleRequireSubmission:e}):null;case Ne.verified:return(0,d.jsx)(Qe,{is_from_external:i,needs_poa:n,redirect_button:o});default:return null}};var et=i(978513);const tt=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("You've reached the limit for uploading your documents."),text:(0,d.jsx)(l.Localize,{i18n_default_text:"Please contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:et.Chat.open},0)]}),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128})}),it=()=>(0,d.jsx)(c.A,{message:(0,l.localize)("Proof of identity verification not required"),text:(0,l.localize)("Your account does not need identity verification at this time. We will inform you if identity verification is required in the future."),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128})});var nt=i(114321);const ot=({needs_poa:e,redirect_button:t,is_from_external:i,is_manual_upload:r=!1})=>{const{localize:s}=(0,O.useTranslations)(),l=s("Review in progress"),c=s(r?"Your proof of identity is under review. We’ll get back to you within 1–3 working days.":"Your proof of identity is under review. We’ll get back to you within 5 minutes.");return e?(0,d.jsxs)(nt.A,{message:l,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128}),children:[(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:"account-management__text-container",children:[(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:c}),(0,d.jsx)(o.Text,{align:"center",size:"xs",as:"p",children:s("To start trading, you also need to verify your address.")})]}),(0,d.jsx)(Ge,{custom_text:s("Next")})]}),!i&&t]}):(0,d.jsx)(nt.A,{message:l,text:c,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiVerified",size:128}),children:!i&&(0,d.jsx)(pe,{button_label:s("Return to Trader's Hub"),route:a.routes.traders_hub})})},rt=ot,st=ye,at=({needs_poa:e,redirect_button:t,is_from_external:i,service:r})=>{const s=r===Te?(0,l.localize)("ID verification passed"):(0,l.localize)("Your proof of identity is verified");return e?(0,d.jsx)(c.A,{message:s,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128}),className:"account-management-dashboard",text:(0,l.localize)("To continue trading, you must also submit a proof of address."),children:!i&&(0,d.jsx)(n.Fragment,{children:(0,d.jsx)(Ge,{})})}):(0,d.jsx)(c.A,{message:s,icon:(0,d.jsx)(o.Icon,{icon:"IcPoaVerified",size:128,data_testid:"dt_IcPoaVerified"}),className:"account-management-dashboard",children:!i&&(t||(0,d.jsx)(st,{}))})},lt=at,ct=({text:e,index:t})=>{const{isDesktop:i}=(0,f.Y)(),n=i?"xs":"xxs";return(0,d.jsxs)("div",{className:"account-management__list-text-container",children:[t&&(0,d.jsxs)(o.Text,{size:n,className:"account-management__list-text",children:[(0,d.jsx)(l.Localize,{i18n_default_text:"{{index}}.",values:{index:t}})," "]}),(0,d.jsx)(o.Text,{size:n,className:"account-management__list-text",children:e})]})},dt=({className:e,icon:t,message:i,message_list:n=[],onContinue:r})=>{const{isDesktop:s,isMobile:c}=(0,f.Y)();return(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:c,children:(0,d.jsx)(o.Div100vhContainer,{className:"account-management__message-wrapper",is_disabled:s,height_offset:"110px",children:(0,d.jsxs)("div",{className:(0,w.A)("account-management__message-content",{[`${e}__message-content`]:e}),"data-testid":"dt_icon_message_list",children:[t&&(0,d.jsx)("div",{className:(0,w.A)("account-management__message-icon",{[`${e}__message-icon`]:e}),children:t}),(0,d.jsx)(o.Text,{as:"div",weight:"bold",className:(0,w.A)("account-management__message",{[`${e}__message`]:e}),size:s?"s":"xs",children:i}),n&&(0,d.jsx)("div",{className:"account-management__list-container",children:(0,d.jsxs)("div",{className:"account-management__list-message",children:[(0,d.jsx)("div",{className:"account-management__list-icon",children:(0,d.jsx)(o.Icon,{icon:"IcAlertDanger",color:"red"})}),(0,d.jsx)("section",{children:n.length<2?(0,d.jsx)(ct,{text:(0,a.getOnfidoError)(n[0])}):n.map(((e,t)=>(0,d.jsx)(ct,{text:(0,a.getOnfidoError)(n[t]),index:t+1},e)))})]})}),r&&(0,d.jsx)(o.Button,{type:"button",className:"account-management__continue",onClick:r,large:!0,primary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Verify again"})})]})})})},ut=({handleRequireSubmission:e,rejected_reasons:t})=>(0,d.jsx)(dt,{message:(0,l.localize)("Your proof of identity submission failed because:"),icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128}),message_list:t,onContinue:e}),_t=({children:e,message:t,error:i})=>(0,d.jsx)(c.A,{message:null!=t?t:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity documents upload failed"}),text:i,icon:(0,d.jsx)(o.Icon,{icon:"IcPoiFailed",size:128}),className:"account-management-dashboard",children:e});var mt=i(649524),ft=i.n(mt);const pt=e=>(0,l.localize)("Unable to read file {{name}}",{name:e}),bt=(e,t,i)=>new Promise(((n,o)=>{e||o();const r=new(ft())({connection:t()});let s=!1;(0,a.compressImageFiles)([e]).then((e=>{(0,a.readFiles)(e,pt,i).then((e=>{e.forEach((e=>{e.message&&(s=!0,o(e))}));const t=e.length;!s&&t&&r.upload(e[0]).then(n).catch(o)})).catch((e=>console.error("error: ",e)))})).catch((e=>console.error("error: ",e)))}));var xt=i(557344),ht=i(672313),yt=i(751506),gt=i(539943);const vt=({anchor:e,from:t,text:i})=>{const n=t?`?from=${t}`:"",r=e?`#${e}`:"";return(0,d.jsx)(o.ButtonLink,{to:`/account/personal-details${n}${r}`,children:(0,d.jsx)(o.Text,{className:"dc-btn__text",weight:"bold",as:"p",children:null!=i?i:(0,l.localize)("Go to personal details")})})},jt=({has_invalid_postal_code:e,from:t})=>e?(0,d.jsx)(c.A,{message:(0,l.localize)("Your postal code is invalid"),text:(0,l.localize)("Please check and update your postal code before submitting proof of identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(vt,{anchor:"address_postcode",from:t,text:(0,l.localize)("Update postal code")})}):(0,d.jsx)(c.A,{message:(0,l.localize)("Your personal details are missing"),text:(0,l.localize)("Please complete your personal details before you verify your identity."),icon:(0,d.jsx)(o.Icon,{icon:"IcAccountMissingDetails",size:128}),children:(0,d.jsx)(vt,{from:t})});var Ot=i(406941),wt=i(263610),St=i(560798);const Pt=()=>et.Chat.open(),zt=(0,d.jsx)(l.Localize,{i18n_default_text:"Sorry, an internal error occurred. Hit the above checkbox to try again."}),Nt=(0,d.jsx)(l.Localize,{i18n_default_text:"An account with these details already exists. Please make sure the details you entered are correct as only one real account is allowed per client. If this is a mistake, contact us via <0>live chat</0>.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:Pt,onKeyDown:Pt},0)]}),Dt=(0,d.jsx)(l.Localize,{i18n_default_text:"This document number was already submitted for a different account. It seems you have an account with us that doesn't need further verification. Please contact us via <0>live chat</0> if you need help.",components:[(0,d.jsx)("span",{className:"link link--orange",onClick:Pt,onKeyDown:Pt},0)]}),kt=(e,t,i,n)=>{const o=e?"identity document":(0,v.xy)(t,i);switch(n){case a.IDV_ERROR_STATUS.NameMismatch.code:return{required_fields:["first_name","last_name"],side_note_image:(0,d.jsx)(wt.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:a.IDV_ERROR_STATUS.NameMismatch.message};case a.IDV_ERROR_STATUS.DobMismatch.code:return{required_fields:["date_of_birth"],side_note_image:(0,d.jsx)(St.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>date of birth</0> exactly as it appears on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:a.IDV_ERROR_STATUS.DobMismatch.message};default:return{required_fields:["first_name","last_name","date_of_birth"],side_note_image:(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your {{document_name}}.",components:[(0,d.jsx)("strong",{},0)],values:{document_name:o}}),failure_message:(0,a.getIDVError)(n)}}};function At(){return At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)({}).hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},At.apply(null,arguments)}function Tt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function It(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(i),!0).forEach((function(t){Et(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Tt(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Et(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ct=({account_settings:e,getChangeableFields:t,onFormConfirm:i})=>{const{isDesktop:r}=(0,f.Y)(),[s,c]=n.useState(!0),[u,_]=n.useState(!1),[p,x]=n.useState({show_form:!0,form_initial_values:{first_name:"",last_name:"",date_of_birth:""},changeable_fields:[],api_error:""}),h=(0,d.jsx)(Ot.A,{height:"195px",width:"285px"});n.useEffect((()=>{(async()=>{try{await(null===a.WS||void 0===a.WS?void 0:a.WS.wait("get_settings"));const i=["first_name","last_name","date_of_birth"],n=(0,a.filterObjProperties)(e,i);n.date_of_birth&&(n.date_of_birth=(0,a.toMoment)(n.date_of_birth).format("YYYY-MM-DD")),x(It(It({},p),{},{changeable_fields:t(),form_initial_values:n})),c(!1)}catch(e){console.error(e)}})()}),[e]);const{api_error:y}=p,g=At({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(p.form_initial_values),p.form_initial_values));return y?(0,d.jsx)(b,{error_message:y}):s?(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"}):(0,d.jsx)(m.Formik,{initialValues:g,enableReinitialize:!0,onSubmit:async(e,{setStatus:t,setSubmitting:n})=>{if(u)return;t({error_msg:""});const o=(0,v.Di)(e,null!=p&&p.changeable_fields?[...p.changeable_fields]:[]),r=await a.WS.setSettings(o);if(null!=r&&r.error){var s;t({error_msg:(null===(s=r.error)||void 0===s?void 0:s.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),n(!1)}else{var l;const e=await a.WS.authorized.storage.getSettings();if(null!=e&&e.error)return void x(It(It({},p),{},{api_error:e.error.message}));const{first_name:t,last_name:n,date_of_birth:o}=null!==(l=null==e?void 0:e.get_settings)&&void 0!==l?l:It({},p.form_initial_values);x(It(It({},p),{},{form_initial_values:{first_name:t,last_name:n,date_of_birth:o}})),_(!0),c(!1),i&&setTimeout((()=>{i()}),500)}},validate:e=>{const t={};return(0,v.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,v.yS)(e.first_name)),e.last_name&&(t.last_name=(0,v.yS)(e.last_name)),x(It(It({},p),{},{errors:!(0,a.isEmptyObject)((0,a.removeEmptyPropertiesFromObject)(t))})),(0,a.removeEmptyPropertiesFromObject)(t)},children:({errors:e,handleSubmit:t,isSubmitting:i,status:n})=>(0,d.jsx)(m.Form,{className:"account-form__poi-confirm-example",onSubmit:t,children:(0,d.jsxs)(U,{children:[(0,d.jsx)(ne.A,{editable_fields:p.changeable_fields,is_rendered_for_onfido:!0,side_note:h,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})}),(0,d.jsx)("button",{type:"submit",className:(0,w.A)("account-form__poi-confirm-example--button",{"account-form__poi-confirm-example--button__disabled":u||!(0,a.isEmptyObject)(e)}),children:(0,d.jsx)(o.Checkbox,{value:u,label:(0,d.jsx)(o.Text,{size:r?"xs":"xxs",children:(0,l.localize)("I confirm that the name and date of birth above match my chosen identity document (see below)")}),disabled:i})}),(null==n?void 0:n.error_msg)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--status-message",children:(0,d.jsx)(o.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:null==n?void 0:n.error_msg}),is_danger:!0,className:"hint-box-layout"})})]})})})},Lt=({is_onfido_disabled:e,is_onfido_container_hidden:t,onfido_element_id:i="onfido",is_confirmed:r,data_testid:s,is_onfido_initialized:a})=>{const[c,u]=n.useState(!1),_=n.useRef(),m=n.useRef();return n.useEffect((()=>{r&&(_.current=setTimeout((()=>{u(!0)}),800),m.current=setTimeout((()=>{u(!1)}),4650))}),[r]),n.useEffect((()=>()=>{clearTimeout(_.current),clearTimeout(m.current)}),[]),(0,d.jsxs)("div",{className:"onfido-container-view_wrapper",children:[(0,d.jsx)("div",{className:(0,w.A)({"onfido-container__status-message_container":!e}),children:(0,d.jsx)(xt.A,{appear:c,in:c,timeout:{exit:350},classNames:{exit:"onfido-container__status-message--exit"},unmountOnExit:!0,children:(0,d.jsx)(o.HintBox,{className:"onfido-container__status-message",icon:"IcAlertAnnounce",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your personal details have been saved successfully."})}),is_info:!0})})}),(0,d.jsxs)("section",{children:[e&&a&&(0,d.jsx)("div",{className:"onfido-container__info-message",children:(0,d.jsx)(o.HintBox,{icon:"IcInfoBlue",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Hit the checkbox above to choose your document."})}),is_info:!0})}),(0,d.jsx)("div",{"data-testid":s,id:i,className:(0,w.A)({"onfido-container__disabled":e,"onfido-container__hidden":t})})]})]})};var Ft=i(442438);const Rt=(0,r.observer)((({country_code:e,documents_supported:t,getChangeableFields:i,handleViewComplete:r,height:a,is_default_enabled:l})=>{var c;const[u,_]=n.useState(),[m,p]=n.useState(""),[b,x]=n.useState(!0),[h,y]=n.useState(!1),[g,j]=n.useState(!1),[O,w]=n.useState(!1),{data:S}=(0,ht.A)(),{send:P,isSuccess:z}=(0,yt.A)(),{common:N}=(0,s.A)(),{current_language:D}=N,{isMobile:k}=(0,f.Y)(),A=(0,v.aZ)(e),T=(0,v.IW)(e),{service_token:I,isSuccess:E,isError:C,error:L,isLoading:F}=(0,gt.A)({service:"onfido",country:T}),R=n.useRef(),M=Array.isArray(t)?t:Object.keys(t).map((e=>t[e].display_name));let U;const V=n.useCallback((e=>{var t;null==R||null===(t=R.current)||void 0===t||t.tearDown();const i=Object.keys(e).map((t=>{var i;return null===(i=e[t])||void 0===i?void 0:i.id}));null!=i&&i.length&&P({category:"authentication",event:"poi_documents_uploaded",args:{documents:i}})}),[P]),B=n.useCallback((async e=>{if(e)try{R.current=await window.Onfido.init({containerId:"onfido",language:{locale:(0,v.hf)(D),phrases:(0,Ft.e)(),mobilePhrases:(0,Ft.e)()},token:e,useModal:!1,useMemoryHistory:!0,onComplete:V,steps:[{type:"document",options:{documentTypes:{passport:M.some((e=>/Passport/g.test(e))),driving_licence:!!M.some((e=>/Driving Licence/g.test(e)))&&{country:A},national_identity_card:!!M.some((e=>/National Identity Card/g.test(e)))&&{country:A}},hideCountrySelection:!0}},"face"]}),j(!0)}catch(e){var t;_(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:e),x(!0),R.current=void 0}finally{w(!0)}}),[V,M,A,D]),Y=n.useCallback((e=>{var t,i;null===(t=document.getElementById("onfido_sdk"))||void 0===t||t.remove(),null===(i=document.getElementById("onfido_style"))||void 0===i||i.remove();const n=document.createElement("script"),o=document.createElement("link");n.id="onfido_sdk",n.src="https://assets.onfido.com/web-sdk-releases/13.8.4/onfido.min.js",o.href="https://assets.onfido.com/web-sdk-releases/13.8.4/style.css",o.rel="stylesheet",o.id="onfido_style",document.body.appendChild(n),document.body.appendChild(o),n.addEventListener("load",(()=>{B(e)}))}),[B]),q=(0,n.useCallback)((()=>{y(!0),x(!1)}),[]);return n.useEffect((()=>{var e,t;E&&null!=I&&null!==(e=I.onfido)&&void 0!==e&&e.token&&!O?Y(null==I||null===(t=I.onfido)||void 0===t?void 0:t.token):C&&(e=>{switch(e.code){case"MissingPersonalDetails":p("all");break;case"InvalidPostalCode":p("postal_code");break;default:_(e.message)}})(L)}),[L,C,E,O,Y,null==I||null===(c=I.onfido)||void 0===c?void 0:c.token]),n.useEffect((()=>{l&&x(!1)}),[l]),n.useEffect((()=>{z&&r()}),[r,z]),F||!O?U=(0,d.jsx)(o.Loading,{is_fullscreen:!1}):m?U=(0,d.jsx)(jt,{has_invalid_postal_code:"postal_code"===m,from:"proof_of_identity"}):u&&(U=(0,d.jsx)(Ve,{message:u})),(0,d.jsx)(o.ThemedScrollbars,{is_bypassed:k,height:a,children:(0,d.jsxs)("div",{className:"onfido-container",children:[U||(0,d.jsx)(xt.A,{appear:b,in:b,timeout:{exit:350},classNames:{exit:"account-form__poi-confirm-example_wrapper--exit"},unmountOnExit:!0,children:(0,d.jsx)("div",{className:"account-form__poi-confirm-example_wrapper account-form__poi-confirm-example_container",children:(0,d.jsx)(Ct,{account_settings:S,getChangeableFields:i,onFormConfirm:q})})}),(0,d.jsx)(Lt,{is_onfido_disabled:b,is_confirmed:h,is_onfido_container_hidden:!!U,is_onfido_initialized:g})]})})}));Rt.displayName="OnfidoSdkViewContainer";const Mt=Rt;function Ut(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Vt(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(i),!0).forEach((function(t){Bt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ut(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Bt(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Yt="manual-poi-details",qt="national_identity_card",$t="nimc_slip",Wt="passport",Ht="driving_licence",Gt="birth_certificate",Jt="front",Zt="back",Kt="photo",Qt={document_type:"selfie_with_id",pageType:Kt,name:"selfie_with_id",icon:"IcSelfie",info:(0,l.localize)("Upload your selfie.")},Xt={name:"expiry_date",label:(0,l.localize)("Expiry date"),type:"date",required:!0};function ei(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ti(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ei(Object(i),!0).forEach((function(t){ii(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ei(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ii(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ni=({data:e})=>{const t=(0,a.toMoment)().add(6,"months").format("YYYY-MM-DD");switch(e.type){case"text":return(0,d.jsx)(m.Field,{name:e.name,children:({field:t,form:{errors:i,touched:n}})=>(0,d.jsx)(o.Input,ti(ti({},t),{},{className:`${Yt}__field`,type:"text",label:`${e.label}${e.required?"*":""}`,error:n[t.name]&&i[t.name]}))});case"date":return(0,d.jsx)(m.Field,{name:e.name,children:({field:i,form:{errors:n,touched:r}})=>(0,d.jsx)(o.DatePicker,ti(ti({},i),{},{className:`${Yt}__field`,date_format:"YYYY-MM-DD",display_format:"DD-MM-YYYY",start_date:t,min_date:t,name:e.name,label:`${e.label}${e.required?"*":""}`,error:r[i.name]&&n[i.name],readOnly:!0}))});default:return null}};function oi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ri(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(i),!0).forEach((function(t){si(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):oi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function si(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const ai={"file-too-large":(0,l.localize)("File size should be 8MB or less"),"file-invalid-type":(0,l.localize)("File uploaded is not supported"),"too-many-files":(0,l.localize)("Please select one file only"),GENERAL:(0,l.localize)("Sorry, an error occured. Please select another file.")},li=({data:e,open:t})=>{const{isDesktop:i}=(0,f.Y)();return(0,d.jsxs)("div",{className:`${Yt}__uploader-details`,children:[(0,d.jsx)(o.Icon,{className:`${Yt}__uploader-icon`,icon:null==e?void 0:e.icon,size:236}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==e?void 0:e.info}),(0,d.jsx)(o.Button,{medium:!0,secondary:!0,text:i?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:t})]})},ci=({data:e,setFieldValue:t,value:i,has_frame:r,handleChange:s})=>{const[a,l]=n.useState("");return n.useEffect((()=>{l(null!=i&&i.file?URL.createObjectURL(null==i?void 0:i.file):"")}),[i]),(0,d.jsxs)("div",{className:`${Yt}__uploader-details ${Yt}__uploader-details--preview`,children:[(0,d.jsxs)("div",{className:(0,w.A)(`${Yt}__uploader-image`,{[`${Yt}__uploader-image--has-frame`]:r}),style:{backgroundImage:`url(${a})`},children:[r&&(0,d.jsx)(o.Icon,{icon:"IcPoiFrame",className:`${Yt}__uploader-frame`}),(!a||-1!==(null==i?void 0:i.file.type.indexOf("pdf")))&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Icon,{icon:"IcCloudUpload",size:50}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==i?void 0:i.file.name})]}),(0,d.jsx)(o.Icon,{icon:"IcCloseCircle",className:`${Yt}__uploader-remove`,onClick:()=>{null==s||s(null,t)},size:16})]}),(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",align:"center",children:null==e?void 0:e.info})]})},di=({data:e,value:t,is_full:i,onChange:r,has_frame:s})=>{const{isDesktop:c}=(0,f.Y)(),[u,_]=n.useState();n.useEffect((()=>{_(t)}),[t]);const p=(t,i)=>{null==r||r(t),null==i||i(null==e?void 0:e.name,t)},b=e=>{var t;return(0,d.jsxs)("div",{className:`${Yt}__uploader-details`,children:[null==u||null===(t=u.errors)||void 0===t?void 0:t.map(((e,t)=>(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"secondary",align:"center",children:e},t))),(0,d.jsx)(o.Button,{medium:!0,secondary:!0,text:c?(0,l.localize)("Drop file or click here to upload"):(0,l.localize)("Tap here to upload"),onClick:e})]})};return(0,d.jsx)(m.Field,{name:null==e?void 0:e.name,children:({form:{setFieldValue:n}})=>{var r;return(0,d.jsx)("div",{className:(0,w.A)(`${Yt}__uploader`,{[`${Yt}__uploader--full`]:i}),children:(0,d.jsx)(o.FileDropzone,{accept:a.supported_filetypes,error_message:(0,l.localize)("Please upload supported file type."),filename_limit:32,hover_message:(0,l.localize)("Drop files here.."),max_size:a.max_document_size,message:t=>(0,d.jsx)(li,{open:t,data:e}),preview_single:u&&(0,d.jsx)(ci,{data:e,value:u,has_frame:s,setFieldValue:n,handleChange:p}),multiple:!1,onDropAccepted:t=>((t,i)=>{const n=ri({file:t[0],errors:[]},e);p(n,i)})(t,n),onDropRejected:t=>((t,i)=>{var n;const o=null===(n=t[0].errors)||void 0===n?void 0:n.map((e=>ai[e.code]?ai[e.code]:ai.GENERAL)),r=ri(ri({},t[0]),{},{errors:o},e);p(r,i)})(t,n),validation_error_message:null!=t&&null!==(r=t.errors)&&void 0!==r&&r.length?b:void 0,noClick:!0,value:u?[u]:[]})})}})},ui=e=>{const t={};return e.forEach((e=>{t[e.name]=""})),t},_i=e=>"string"==typeof e?!e.trim():!e,mi=(e,t=[],i=[])=>{const n={};return t.forEach((t=>{const{name:i,label:o,type:r}=t,s=e[i];t.required&&_i(s)?n[i]=(0,l.localize)("{{label}} is required.",{label:o}):"text"===r&&s.length>30?n[i]=(0,l.localize)("{{label}} must be less than 30 characters.",{label:o}):"text"!==r||/^[\w\s-]{0,30}$/g.test(s)||(n[i]=(0,l.localize)("Only letters, numbers, space, underscore, and hyphen are allowed for {{label}}.",{label:o}))})),i.forEach((t=>{var i;const{name:o}=t,r=e[o];_i(r)?n[o]=(0,l.localize)("{{name}} is required.",{name:o}):null!==(i=r.errors)&&void 0!==i&&i.length&&(n[o]=r.errors[0])})),n},fi=[{icon:"IcPoiClearPhoto",text:(0,l.localize)("A clear colour photo or scanned image")},{icon:"IcPoiFileFormat",text:(0,l.localize)("JPEG, JPG, PNG, PDF, or GIF")},{icon:"IcPoiFileSize",text:(0,l.localize)("Less than 8MB")},{icon:"IcPoiDocExpiry",text:(0,l.localize)("Must be valid for at least 6 months")}],pi=({data:e})=>(0,d.jsxs)("div",{className:`${Yt}__icons-item`,children:[(0,d.jsx)(o.Icon,{icon:e.icon,size:24}),(0,d.jsx)(o.Text,{as:"p",size:"xxxs",align:"center",children:e.text})]}),bi=({initial_values:e,is_from_external:t,data:i,goToCards:n,onSubmit:r})=>{const{isDesktop:s}=(0,f.Y)(),{fields:a,documents_title:c,documents:u}=i,_=a.some((e=>e.name===Xt.name)),p=_?(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}} and the expiry date.",values:{label:null==a?void 0:a[0].label}}):(0,d.jsx)(l.Localize,{i18n_default_text:"First, enter your {{label}}.",values:{label:null==a?void 0:a[0].label}});return(0,d.jsx)("div",{className:(0,w.A)(Yt,{[`${Yt}--mobile`]:!s}),children:(0,d.jsx)(m.Formik,{initialValues:e||ui([...a||[],...u||[]]),validate:e=>mi(e,a,u),onSubmit:r,children:({values:e,isValid:i,touched:r})=>{const f=Object.keys(r).length>0,b=Object.values(e).some(((e,t)=>{var i;return(null===e||""===e)&&(null==a||null===(i=a[t])||void 0===i?void 0:i.required)}));return(0,d.jsxs)(m.Form,{className:`${Yt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:s?"80px":"180px",children:(0,d.jsxs)("div",{className:`${Yt}__fields-content`,children:[(0,d.jsx)(o.Text,{as:"h3",size:"s",color:"prominent",children:p}),(0,d.jsx)("div",{className:`${Yt}__fields-wrap`,children:null==a?void 0:a.map((e=>(0,d.jsx)(ni,{data:e},e.name)))}),(0,d.jsx)("div",{className:`${Yt}__divider`}),(0,d.jsx)(o.Text,{as:"h3",size:"s",color:"prominent",children:c}),(0,d.jsx)("div",{className:`${Yt}__uploaders-wrap`,children:null==u?void 0:u.map((i=>(0,d.jsx)(di,{data:i,value:e[i.name],is_full:1===u.length||t},i.name)))}),(0,d.jsx)("div",{className:`${Yt}__icons`,children:fi.map((e=>"IcPoiDocExpiry"!==e.icon||_?(0,d.jsx)(pi,{data:e},e.icon):null))})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Yt}__btns`,children:[(0,d.jsx)(o.Button,{onClick:n,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(o.Button,{type:"submit",primary:!0,large:!0,is_disabled:!i||!f&&b,text:(0,l.localize)("Next")})]})})]})}})})},xi=({initial_values:e,goBack:t,onConfirm:i,onFileDrop:n})=>{const{isDesktop:r}=(0,f.Y)();return(0,d.jsx)("div",{className:(0,w.A)(Yt,{[`${Yt}--mobile`]:!r}),children:(0,d.jsx)(m.Formik,{initialValues:e||ui([Qt]),validate:e=>mi(e,void 0,[Qt]),onSubmit:i,children:({values:e,isValid:i,isSubmitting:s,touched:a})=>{let c,u;return a&&(c=Object.keys(a).length>0),e&&(u=Object.values(e).some((e=>null===e||""===e))),(0,d.jsxs)(m.Form,{className:`${Yt}__form`,children:[(0,d.jsx)(U,{className:"form-body",scroll_offset:r?"8rem":"18rem",children:(0,d.jsxs)("div",{className:`${Yt}__fields-content`,children:[(0,d.jsx)(o.Text,{as:"h3",size:"s",weight:"bold",color:"prominent",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Upload your selfie"})}),(0,d.jsx)("div",{className:`${Yt}__uploaders-wrap`,children:(0,d.jsx)(di,{data:Qt,value:e?e[Qt.name]:"",is_full:!0,onChange:n,has_frame:!0})}),(0,d.jsx)("div",{className:`${Yt}__notice`,children:(0,d.jsx)(o.Text,{as:"p",size:"xs",color:"general",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Before uploading, please ensure that you’re facing forward in the selfie, your face is within the frame, and your eyes are clearly visible even if you’re wearing glasses."})})})]})}),(0,d.jsx)(B,{children:(0,d.jsxs)("div",{className:`${Yt}__btns`,children:[(0,d.jsx)(o.Button,{onClick:t,secondary:!0,large:!0,text:(0,l.localize)("Back")}),(0,d.jsx)(o.Button,{type:"submit",primary:!0,large:!0,is_disabled:!i||s||!c&&u,text:(0,l.localize)("Confirm and upload")})]})})]})}})})};function hi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function yi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?hi(Object(i),!0).forEach((function(t){gi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function gi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const vi=({data:e,goToCards:t,onComplete:i,is_from_external:o})=>{const[r,s]=n.useState(),[a,l]=n.useState(),[c,u]=n.useState(!1);return(0,d.jsx)(n.Fragment,{children:c?(0,d.jsx)(xi,{initial_values:a,goBack:()=>u(!1),onConfirm:e=>{i(yi(yi({},r),e))},onFileDrop:e=>l({[Qt.name]:e})}):(0,d.jsx)(bi,{initial_values:r,is_from_external:o,data:e,goToCards:t,onSubmit:e=>{s(e),u(!0)}})})},ji=["document","onClickBack","root_class","country_code_key","height","handleComplete","is_onfido_supported","is_from_external","is_for_mt5","handlePOIforMT5Complete","needs_poa"];function Oi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function wi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Oi(Object(i),!0).forEach((function(t){Si(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Oi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Si(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Pi={IS_UPLOADING:"IS_UPLOADING",IS_COMPLETED:"IS_COMPLETED",IS_FAILED:"IS_FAILED"},zi=e=>{let{document:t,onClickBack:i,root_class:r,country_code_key:s,height:c,handleComplete:u,is_onfido_supported:_,is_from_external:m,is_for_mt5:f,handlePOIforMT5Complete:p,needs_poa:b}=e,x=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,ji);const[h,y]=n.useState(""),[g,v]=n.useState("");let O=!1;const w=e=>{var i;y(Pi.IS_UPLOADING),(i=e,new Promise(((e,n)=>{const o=t.details.documents.map((e=>e.name)),r=Object.values(i).filter((e=>[...o,Qt.name].includes(e.name))),c=r.length;let d=0;const u=[],_=()=>{var t;const o=r[d],{file:m,document_type:f,pageType:p,lifetime_valid:b}=o,x="function"==typeof(null===(t=i.expiry_date)||void 0===t?void 0:t.format)?i.expiry_date.format("YYYY-MM-DD"):void 0;bt(m,a.WS.getSocket,{document_type:f,page_type:p,expiration_date:x,document_id:i.document_id||"",lifetime_valid:+(b&&!x),document_issuing_country:s}).then((t=>{d+=1,(null==t?void 0:t.warning)===j.DUPLICATE_DOCUMENT?y(Pi.IS_DUPLICATE_UPLOAD):null!=t&&t.warning||t.error?(O=!0,y(Pi.IS_FAILED),v(t.message||(t.error?t.error.message:(0,l.localize)("Failed"))),d<c&&_()):d<c?(u.push(t),_()):e(u)})).catch((e=>{n(e)}))};_()}))).then((()=>{O||(f?null==p||p():y(Pi.IS_COMPLETED))})).catch((e=>{y(Pi.IS_FAILED),v(e.message)}))};switch(h){case Pi.IS_UPLOADING:return(0,d.jsx)(o.Loading,{is_fullscreen:!1,is_slow_loading:!0,status:[(0,l.localize)("Uploading documents")]});case Pi.IS_COMPLETED:return(0,d.jsx)(ot,{is_from_external:!0,needs_poa:b,is_manual_upload:!0});case Pi.IS_FAILED:return(0,d.jsx)(_t,{error:g});case Pi.IS_DUPLICATE_UPLOAD:return(0,d.jsx)(_t,{error:(0,d.jsx)(l.Localize,{i18n_default_text:"It seems you’ve submitted this document before. Upload a new document."}),children:(0,d.jsx)(o.Button,{onClick:i,large:!0,primary:!0,className:"upload_error_btn",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Try Again"})})});default:return(0,d.jsx)(n.Fragment,{children:_?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:`${r}__detail-header`,onClick:i,children:[(0,d.jsx)(o.Icon,{icon:"IcArrowLeftBold"}),(0,d.jsx)(o.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",className:`${r}__back-title`,children:(0,l.localize)("Back")})]}),(0,d.jsx)(Mt,wi({country_code:s,documents_supported:[t.onfido_name],height:null!=c?c:null,handleComplete:f?p:u,is_default_enabled:!0,handleViewComplete:f?p:u},x))]}):(0,d.jsx)(vi,{data:t.details,onComplete:w,goToCards:i,is_from_external:m})})}},Ni=({onClick:e,title:t,description:i,icon:n})=>{const{isDesktop:r}=(0,f.Y)();return(0,d.jsxs)("div",{className:"manual-poi__card",onClick:e,children:[(0,d.jsx)(o.Icon,{className:"manual-poi__card-icon",icon:n,size:64}),(0,d.jsxs)("div",{className:"manual-poi__card-content",children:[(0,d.jsx)(o.Text,{as:"p",size:"xs",weight:"bold",color:"prominent",children:t}),(0,d.jsx)(o.Text,{as:"p",size:r?"xxs":"xxxs",children:i})]}),(0,d.jsx)(o.Icon,{icon:"IcChevronRight",size:r?31:23})]})};function Di(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ki(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ai=({toggleDetail:e,documents:t})=>(0,d.jsx)(n.Fragment,{children:t.map(((t,i)=>{var n;return(0,d.jsx)(o.Card,{renderContent:()=>(0,d.jsx)(Ni,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Di(Object(i),!0).forEach((function(t){ki(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Di(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({onClick:()=>e(i)},t.card))},null===(n=t.card)||void 0===n?void 0:n.icon)}))}),Ti=["country_code","handlePOIforMT5Complete","manual","redirect_button","needs_poa","handleBack","handleRequireSubmission","allow_poi_resubmission","handleViewComplete","onfido","is_for_mt5","is_resubmission"];function Ii(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ei(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ci=e=>{let{country_code:t,handlePOIforMT5Complete:i,manual:r,redirect_button:s,needs_poa:a,handleBack:c,handleRequireSubmission:u,allow_poi_resubmission:_,handleViewComplete:m,onfido:f,is_for_mt5:p,is_resubmission:b}=e,x=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,Ti);const[h,y]=n.useState(null),g=(({country_code:e})=>[{onfido_name:"Passport",card:{title:(0,l.localize)("Passport"),description:(0,l.localize)("Upload the page that contains your photo."),icon:"IcPoiPassport"},details:{fields:[{name:"document_id",label:(0,l.localize)("Passport number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the page of your passport that contains your photo."),documents:[{document_type:Wt,pageType:Jt,name:"passport",icon:"IcPassport",info:(0,l.localize)("Upload the page of your passport that contains your photo.")}]}},{onfido_name:"Driving Licence",card:{title:(0,l.localize)("Driving licence"),description:(0,l.localize)("Upload the front and back of your driving licence."),icon:"IcPoiDrivingLicence"},details:{fields_title:(0,l.localize)("First, enter your driving licence number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Driving licence number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the front and back of your driving licence."),documents:[{document_type:Ht,pageType:Jt,name:"driving_licence_front",icon:"IcDrivingLicenceFront",info:(0,l.localize)("Upload the front of your driving licence.")},{document_type:Ht,pageType:Zt,name:"driving_licence_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your driving licence.")}]}},{onfido_name:"National Identity Card",card:{title:(0,l.localize)("Identity card"),description:(0,l.localize)("Upload the front and back of your identity card."),icon:"IcPoiIdentityCard"},details:{fields_title:(0,l.localize)("First, enter your identity card number and the expiry date."),fields:[{name:"document_id",label:(0,l.localize)("Identity card number"),type:"text",required:!0},Vt({},Xt)],documents_title:(0,l.localize)("Next, upload the front and back of your identity card."),documents:[{document_type:qt,pageType:Jt,name:"identity_card_front",icon:"IcIdCardFront",info:(0,l.localize)("Upload the front of your identity card.")},{document_type:qt,pageType:Zt,name:"identity_card_back",icon:"IcIdCardBack",info:(0,l.localize)("Upload the back of your identity card.")}]}},..."ng"===e?[{card:{title:(0,l.localize)("NIMC slip and proof of age"),description:(0,l.localize)("Upload both of these documents to prove your identity."),icon:"IcPoiNimcSlip"},details:{fields:[{name:"document_id",label:(0,l.localize)("NIMC slip number"),type:"text",required:!0}],documents_title:(0,l.localize)("Next, upload both of the following documents."),documents:[{document_type:$t,lifetime_valid:!0,pageType:Jt,name:"nimc_slip",icon:"IcPoiNimcSlipHorizontal",info:(0,l.localize)("Upload your NIMC slip.")},{document_type:Gt,pageType:Kt,name:"birth_certificate_front",icon:"IcDop",info:(0,l.localize)("Upload your proof of age: birth certificate or age declaration document.")}]}}]:[]])({country_code:t});if(r){if(r.status===Ne.pending)return(0,d.jsx)(rt,{is_manual_upload:!0,needs_poa:a,redirect_button:s});if([Ne.rejected,Ne.suspected].some((e=>e===r.status))){if(!_)return(0,d.jsx)(tt,{})}else{if(r.status===Ne.verified)return(0,d.jsx)(lt,{needs_poa:a,redirect_button:s});if(r.status===Ne.expired)return(0,d.jsx)(Be,{redirect_button:s,handleRequireSubmission:u})}}if(null!==h){const e="ng"===t&&!(e=>{let t=!1;return e.forEach((e=>{e.document_type===$t&&(t=!0)})),t})(g[null!=h?h:0].details.documents)&&f&&f.submissions_left>0;return(0,d.jsx)(zi,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(i),!0).forEach((function(t){Ei(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ii(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({is_onfido_supported:e,country_code_key:t,document:g[h],root_class:"manual-poi",onClickBack:()=>y(null),handlePOIforMT5Complete:i,handleComplete:m,is_for_mt5:p,needs_poa:a},x))}return(0,d.jsxs)("div",{className:"manual-poi",children:[(0,d.jsx)(o.Text,{as:"h2",color:"prominent",size:"xs",className:"manual-poi__title",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Please upload one of the following documents:"})}),(0,d.jsx)(Ai,{documents:g,toggleDetail:e=>y(e)}),!p&&!b&&(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(o.Button,{className:"back-btn",onClick:c,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})})})]})},Li=Ci,Fi=({handleRequireSubmission:e,is_from_external:t,needs_poa:i,onfido:n,redirect_button:o,manual:r,country_code:s,handleViewComplete:l})=>{const{status:c,submissions_left:u,last_rejected:_}=n;switch(c){case Ne.pending:return(0,d.jsx)(rt,{is_from_external:t,needs_poa:i,redirect_button:o});case Ne.rejected:case Ne.suspected:case Ne.expired:{const i=(0,a.formatOnfidoError)(c,_);return Number(u)<1?(0,d.jsx)(Li,{manual:r,is_from_external:t,country_code:s,handleViewComplete:l,onfido:n}):(0,d.jsx)(ut,{rejected_reasons:i,handleRequireSubmission:e})}case Ne.verified:return(0,d.jsx)(lt,{is_from_external:t,needs_poa:i,redirect_button:o,service:Ie});default:return null}};var Ri=i(780146);function Mi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ui(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Mi(Object(i),!0).forEach((function(t){Vi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Mi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Vi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Bi=({handleSelectionNext:e,is_from_external:t,mismatch_status:i})=>{var r,s;const{setSelectedCountry:c}=n.useContext(a.POIContext),{data:u,isLoading:_}=(0,Ri.A)(),{isDesktop:p}=(0,f.Y)(),b=e=>{const t=null==u?void 0:u.find((t=>t.text===e));t&&(null==c||c(t))},x=i&&null!==(r=null===(s=a.IDV_ERROR_STATUS[i])||void 0===s?void 0:s.message)&&void 0!==r?r:null;return(0,d.jsx)(m.Formik,{initialValues:{country_input:""},validate:e=>{const t={},{country_input:i}=e;return i?u.find((e=>e.text===i))||(t.country_input=(0,l.localize)("Please select a valid country of document issuance.")):t.country_input=(0,l.localize)("Please select the country of document issuance."),t},onSubmit:(t,{setSubmitting:i})=>{b(t.country_input),i(!1),null==e||e()},children:({dirty:e,errors:i,handleBlur:r,handleChange:s,handleSubmit:a,isSubmitting:c,isValid:f,setFieldValue:h,touched:y,values:g})=>(0,d.jsxs)(n.Fragment,{children:[(0,d.jsxs)("div",{className:(0,w.A)("proof-of-identity__container proof-of-identity__country-container",{"min-height":!t}),children:[x?(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(o.Text,{align:"center",weight:"bold",size:p?"s":"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),(0,d.jsx)(o.HintBox,{className:(0,w.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:p?"xs":"xxs",children:x}),is_danger:!0})]}):(0,d.jsx)(o.Text,{className:"proof-of-identity__header",align:"center",weight:"bold",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Proof of identity"})}),(0,d.jsx)(o.Text,{className:"proof-of-identity__country-text ",size:"xs",children:(0,d.jsx)(l.Localize,{i18n_default_text:"In which country was your document issued?"})}),(0,d.jsx)("fieldset",{className:"proof-of-identity__fieldset",children:(0,d.jsx)(m.Field,{name:"country_input",children:({field:e})=>(0,d.jsx)(n.Fragment,{children:p?(0,d.jsx)(o.Autocomplete,Ui(Ui({className:(0,w.A)({"external-dropdown":t})},e),{},{data_testid:"dt_external_dropdown",name:"country_input","data-lpignore":"true",error:y.country_input&&i.country_input,autoComplete:"off",type:"text",label:(0,l.localize)("Country"),list_items:u,value:g.country_input,onBlur:e=>{r(e);const t=e.target.value;u.find((e=>e.text===t))||(h("country_input","",!0),b(""))},onChange:s,onItemSelection:({text:e})=>{h("country_input","No results found"!==e&&e?e:"",!0),b(e)},required:!0})):(0,d.jsx)("div",{className:"proof-of-identity__dropdown-container",children:(0,d.jsx)(o.SelectNative,Ui(Ui({},e),{},{name:"country_input",error:y.country_input&&i.country_input,label:(0,l.localize)("Country"),placeholder:(0,l.localize)("Please select"),list_items:u,value:g.country_input,onChange:e=>{s(e),b(e.target.value)},use_text:!0,required:!0}))})})})})]}),(0,d.jsx)(B,{className:(0,w.A)("proof-of-identity__footer",{"external-footer":t}),children:(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",onClick:()=>a(),has_effect:!0,is_disabled:!e||c||!f||_,is_loading:!1,text:(0,l.localize)("Next"),large:!0,primary:!0})})]})})};var Yi=i(434828);function qi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function $i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(i),!0).forEach((function(t){Wi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Wi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Hi=(0,r.observer)((({handleBack:e,handleViewComplete:t,handleSelectionNext:i,selected_country:r})=>{const{client:c}=(0,s.A)(),{account_settings:u,getChangeableFields:_}=c,{isDesktop:p}=(0,f.Y)(),b=n.useMemo((()=>(0,a.getIDVNotApplicableOption)()),[]),x=e=>e===b.id,h=(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),y=(0,a.filterObjProperties)(u,["first_name","last_name","date_of_birth"]);y.date_of_birth&&(y.date_of_birth=(0,a.toMoment)(y.date_of_birth).format("YYYY-MM-DD"));const g=_(),O=$i($i({document_type:{id:"",text:"",value:"",example_format:""},document_number:""},y),{},{confirmation_checkbox:!1});return(0,d.jsx)(m.Formik,{initialValues:$i({},O),validate:e=>{const t={},{document_type:i,document_number:n,document_additional:o}=e;if(x(i.id))return t;const r=!!i.additional;t.document_type=(0,v.k4)(i),(0,v.DY)(null==i?void 0:i.id)||(r&&(t.document_additional=(0,v.dC)(i,o)),t.document_number=(0,v.Zy)(n,i));return(0,v.tf)(t,e)((e=>e),["first_name","last_name","date_of_birth"],(0,l.localize)("This field is required")),e.first_name&&(t.first_name=(0,v.yS)(e.first_name)),e.last_name&&(t.last_name=(0,v.yS)(e.last_name)),e.confirmation_checkbox||(t.confirmation_checkbox="error"),(0,a.removeEmptyPropertiesFromObject)(t)},onSubmit:async(e,{setSubmitting:n,setStatus:o})=>{var s;if(x(null==e||null===(s=e.document_type)||void 0===s?void 0:s.id))return void(null==i||i(!0));n(!0);const l=(0,v.Di)(e,g),c=await a.WS.setSettings(l);if(null!=c&&c.error){var d;return o({error_message:(null===(d=c.error)||void 0===d?void 0:d.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),void n(!1)}const u=await a.WS.authorized.storage.getSettings();var _,m;if(null!=u&&u.error)return o({error_message:null!==(_=null==u||null===(m=u.error)||void 0===m?void 0:m.message)&&void 0!==_?_:zt}),void n(!1);const f=$i({identity_verification_document_add:1},(0,a.formatIDVFormValues)(e,r.value)),p=await a.WS.send(f);if(null!=p&&p.error){var b,h,y;return o({error_message:(null===(b=p.error)||void 0===b?void 0:b.code)===j.CLAIMED_DOCUMENT?Dt:null!==(h=null===(y=p.error)||void 0===y?void 0:y.message)&&void 0!==h?h:zt}),void n(!1)}n(!1),t()},enableReinitialize:!0,children:({dirty:t,isSubmitting:i,isValid:s,values:a,status:c})=>{var u,_,f;const b=x(null==a||null===(u=a.document_type)||void 0===u?void 0:u.id),y=!b&&(!t||i||!s);return(0,d.jsxs)(m.Form,{className:(0,w.A)("proof-of-identity__container proof-of-identity__container--reset",{"min-height":x(null==a||null===(_=a.document_type)||void 0===_?void 0:_.id)}),children:[(null==c?void 0:c.error_message)&&(0,d.jsx)("div",{className:"account-form__poi-confirm-example--generic-error-msg",children:(0,d.jsx)(o.HintBox,{icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:"xxxs",children:c.error_message}),is_danger:!0,className:"hint-box-layout"})}),(0,d.jsxs)(U,{className:"form-body",scroll_offset:p?"80px":"180px",children:[(0,d.jsx)(Y.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Yi.A,{selected_country:r,class_name:"idv-layout"}),!x(null==a||null===(f=a.document_type)||void 0===f?void 0:f.id)&&(0,d.jsxs)(n.Fragment,{children:[(0,d.jsx)(Y.A,{title:(0,l.localize)("Details")}),(0,d.jsx)(ne.A,{class_name:"account-form__poi-confirm-example_container",is_rendered_for_idv:!0,editable_fields:a.confirmation_checkbox?[]:g,side_note:h,inline_note_text:(0,d.jsx)(l.Localize,{i18n_default_text:"To avoid delays, enter your <0>name</0> and <0>date of birth</0> exactly as they appear on your identity document.",components:[(0,d.jsx)("strong",{},0)]})})]})]}),(0,d.jsxs)(B,{className:"proof-of-identity__footer ",children:[p&&(0,d.jsx)(o.Button,{className:"back-btn",onClick:e,type:"button",has_effect:!0,large:!0,secondary:!0,children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back"})}),(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:y,large:!0,primary:!0,children:b?(0,d.jsx)(l.Localize,{i18n_default_text:"Next"}):(0,d.jsx)(l.Localize,{i18n_default_text:"Verify"})})]})]})}})}));function Gi(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ji(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Gi(Object(i),!0).forEach((function(t){Zi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Gi(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Zi(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const Ki=({getChangeableFields:e,is_from_external:t,residence_list:i,account_settings:r,handleSubmit:c,mismatch_status:u=a.IDV_ERROR_STATUS.Failed.code,latest_status:_,selected_country:p,handleSelectionNext:x})=>{var h,y;const{client:g}=(0,s.A)(),{setIsAlreadyAttempted:O}=g,{isMobile:S,isDesktop:P}=(0,f.Y)(),[z,N]=n.useState({required_fields:[],side_note_image:(0,d.jsx)(Ot.A,{height:"195px",width:"285px"}),failure_message:null,inline_note_text:null}),[D,k]=n.useState(!0),[A,T]=n.useState({api_error:"",errors:!1,form_initial_values:{},changeable_fields:[]}),I=n.useMemo((()=>![a.IDV_ERROR_STATUS.DobMismatch.code,a.IDV_ERROR_STATUS.NameMismatch.code,a.IDV_ERROR_STATUS.NameDobMismatch.code].includes(u)),[u]),E=n.useMemo((()=>{var e;return I&&!t?null!=p?p:{}:null!==(e=i.find((e=>e.value===(null==_?void 0:_.country_code))))&&void 0!==e?e:{}}),[p,I,null==_?void 0:_.country_code,i,t]),C=n.useMemo((()=>(0,a.getIDVNotApplicableOption)()),[]),L=e=>e===C.id;n.useEffect((()=>{var t;O(!0);const i=kt(I,_,E,u);N(i),(async t=>{await(null===a.WS||void 0===a.WS?void 0:a.WS.wait("get_settings"));const i=(0,a.filterObjProperties)(r,t);i.date_of_birth&&(i.date_of_birth=(0,a.toMoment)(i.date_of_birth).format("YYYY-MM-DD")),i.confirmation_checkbox=!1;let n=i;I&&(n=Ji({document_type:{id:"",text:"",value:"",example_format:"",sample_image:""},document_number:""},n)),T({form_initial_values:Ji({},n),changeable_fields:[...e()],api_error:""}),k(!1)})(null!==(t=null==i?void 0:i.required_fields)&&void 0!==t?t:[]).catch((e=>{var t;T({form_initial_values:{},changeable_fields:[],api_error:null==e||null===(t=e.error)||void 0===t?void 0:t.message})}))}),[u,r,I,e,kt,O]);if(null!=A&&A.api_error)return(0,d.jsx)(b,{error_message:A.api_error});if(D&&0===Object.keys(null!==(h=null==A?void 0:A.form_initial_values)&&void 0!==h?h:{}).length)return(0,d.jsx)(o.Loading,{is_fullscreen:!1,className:"account__initial-loader"});return(0,d.jsx)(m.Formik,{initialValues:null!==(y=null==A?void 0:A.form_initial_values)&&void 0!==y?y:{},onSubmit:async(e,{setStatus:t,setSubmitting:i})=>{var n;if(L(null==e||null===(n=e.document_type)||void 0===n?void 0:n.id))return void(null==x||x(!0));delete e.confirmation_checkbox,i(!0),t({error_msg:null});const{document_number:o,document_type:r}=e,s=(0,v.Di)(e,null!=A&&A.changeable_fields?[...A.changeable_fields]:[]),l=await a.WS.setSettings(s);if(l.error){var d;t({error_msg:(null===(d=l.error)||void 0===d?void 0:d.code)===j.DUPLICATE_ACCOUNT?Nt:zt}),i(!1)}else{const e=await a.WS.authorized.storage.getSettings();if(e.error)return T((t=>Ji(Ji({},t),{},{api_error:e.error.message}))),void i(!1);const n={identity_verification_document_add:1,document_number:o,document_type:null==r?void 0:r.id,issuing_country:E.value};if(!n.document_type||L(n.document_type))return i(!1),void c();const s=await a.WS.send(n);if(null!=s&&s.error){var u,_,m;return t({error_msg:(null===(u=s.error)||void 0===u?void 0:u.code)===j.CLAIMED_DOCUMENT?Dt:null!==(_=null==s||null===(m=s.error)||void 0===m?void 0:m.message)&&void 0!==_?_:zt}),void i(!1)}i(!1),c()}},validate:e=>{var t;const i={};if(I){const{document_type:t,document_number:n,document_additional:o}=e;if(L(null==t?void 0:t.id))return i;const r=!(null==t||!t.additional);i.document_type=(0,v.k4)(t),(0,v.DY)(null==t?void 0:t.id)||(r&&(i.document_additional=(0,v.dC)(t,o)),i.document_number=(0,v.Zy)(null!=n?n:"",t))}return(0,v.tf)(i,e)((e=>e),null!==(t=null==z?void 0:z.required_fields)&&void 0!==t?t:[],(0,l.localize)("This field is required")),e.first_name&&(i.first_name=(0,v.yS)(e.first_name)),e.last_name&&(i.last_name=(0,v.yS)(e.last_name)),e.confirmation_checkbox||(i.confirmation_checkbox="error"),T((e=>Ji(Ji({},e),{},{errors:!(0,a.isEmptyObject)((0,a.removeEmptyPropertiesFromObject)(i))}))),(0,a.removeEmptyPropertiesFromObject)(i)},className:"proof-of-identity__container",children:({isSubmitting:e,isValid:i,dirty:n,status:r,values:s})=>{var a,c,_,f,p,b;return(0,d.jsxs)(m.Form,{className:(0,w.A)("proof-of-identity__mismatch-container",{"upload-layout":I,"min-height":L(null==s||null===(a=s.document_type)||void 0===a?void 0:a.id)}),children:[(0,d.jsxs)(U,{className:"form-body",scroll_offset:P?"80px":t?"140px":"180px",children:[(0,d.jsx)(o.Text,{size:S?"xs":"s",weight:"bold",align:"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Your identity verification failed because:"})}),((null==r?void 0:r.error_msg)||(null==z?void 0:z.failure_message))&&(0,d.jsx)(o.HintBox,{className:(0,w.A)("proof-of-identity__failed-message","hint-box-layout"),icon:"IcAlertDanger",message:(0,d.jsx)(o.Text,{as:"p",size:S?"xxs":"xs","data-testid":u,children:null!==(c=null==r?void 0:r.error_msg)&&void 0!==c?c:null==z?void 0:z.failure_message}),is_danger:!0}),I&&(0,d.jsxs)("div",{children:[(0,d.jsx)(o.Text,{size:"xs",align:S?"left":"center",children:(0,d.jsx)(l.Localize,{i18n_default_text:"Let’s try again. Choose another document and enter the corresponding details."})}),(0,d.jsx)(Y.A,{title:(0,l.localize)("Identity verification")}),(0,d.jsx)(Yi.A,{selected_country:E,class_name:"idv-layout idv-resubmit"}),!L(null==s||null===(_=s.document_type)||void 0===_?void 0:_.id)&&(0,d.jsx)(Y.A,{title:(0,l.localize)("Details")})]}),!L(null==s||null===(f=s.document_type)||void 0===f?void 0:f.id)&&(0,d.jsx)(ne.A,{class_name:"account-form__poi-confirm-example_container",editable_fields:s.confirmation_checkbox?[]:null==A?void 0:A.changeable_fields,is_rendered_for_idv:!0,side_note:null==z?void 0:z.side_note_image,inline_note_text:null==z?void 0:z.inline_note_text,mismatch_status:u})]}),(0,d.jsx)(B,{className:"proof-of-identity__footer",children:(0,d.jsx)(o.Button,{className:"proof-of-identity__submit-button",type:"submit",has_effect:!0,is_disabled:!n||e||!i,text:(b=L(null==s||null===(p=s.document_type)||void 0===p?void 0:p.id),b?(0,l.localize)("Next"):I?(0,l.localize)("Verify"):(0,l.localize)("Update profile")),large:!0,primary:!0})})]})}})},Qi=(0,r.observer)((({allow_poi_resubmission:e,has_require_submission:t,height:i,identity_last_attempt:o,idv:r,is_from_external:l,is_idv_disallowed:c,needs_poa:u,onfido:_,onStateChange:m,redirect_button:f,residence_list:p,should_show_mismatch_form:b})=>{const{submission_service:x,setSubmissionService:h,submission_status:y,setSubmissionStatus:g,selected_country:v,setSelectedCountry:j}=n.useContext(a.POIContext),{client:O,notifications:w}=(0,s.A)(),{account_settings:S,getChangeableFields:P,account_status:z}=O,{refreshNotifications:N}=w,D="high"===z.risk_classification,k=(e=!1)=>{if(Object.keys(v).length){const{submissions_left:t}=r,{submissions_left:i}=_,n=v.identity.services.idv.is_country_supported,o=v.identity.services.onfido.is_country_supported&&"ng"!==v.value;!e&&n&&Number(t)>0&&!c?h(Te):!e&&Number(i)>0&&o?h(Ie):h(Ee),g(ke)}},A=()=>{m&&"function"==typeof m&&m(Ne.pending),g(Ae),a.WS.authorized.getAccountStatus().then((()=>{N()}))},T=()=>g(De),I=n.useCallback((e=>p.find((t=>t.value===e))),[p]),E=t||e,C=(0,a.isIDVReportNotAvailable)(r),L=(0,a.formatIDVError)(r.last_rejected,r.status,D,C),F=n.useCallback((e=>{const{service:t,country_code:i}=e;switch(j(I(i)),t){case Te:case Ie:Number(r.submissions_left)>0||Number(_.submissions_left)>0?g(De):(h(Ee),g(ke));break;case Ee:h(Ee),g(ke)}}),[I,r.submissions_left,_.submissions_left,j,h,g,c]);switch(n.useEffect((()=>{y==De&&(E&&o?F(o):L&&[a.IDV_ERROR_STATUS.DobMismatch.code,a.IDV_ERROR_STATUS.NameMismatch.code,a.IDV_ERROR_STATUS.NameDobMismatch.code].includes(L)&&r.submissions_left>0?(h(Te),g(ke)):g(De))}),[e,o,E,F,y,r,L,h,g]),y){case De:return(0,d.jsx)(Bi,{handleSelectionNext:k,is_from_external:l,mismatch_status:L});case ke:switch(x){case Te:return b?(0,d.jsx)(Ki,{account_settings:S,getChangeableFields:P,mismatch_status:L,residence_list:p,handleSubmit:A,latest_status:o,selected_country:v,handleSelectionNext:k,report_available:!(null==r||!r.report_available)}):(0,d.jsx)(Hi,{handleSelectionNext:k,handleViewComplete:A,handleBack:T,selected_country:v});case Ie:{const e=v.value,t=v.identity.services.onfido.documents_supported,n=Object.keys(t).map((e=>t[e].display_name));return(0,d.jsx)(Mt,{country_code:e,documents_supported:n,getChangeableFields:P,handleViewComplete:A,height:i})}case Ee:return(0,d.jsx)(Li,{country_code:v.value,is_from_external:l,allow_poi_resubmission:e,handleViewComplete:A,onfido:_,handleBack:T,is_resubmission:E});default:return null}case Ae:switch(x){case Te:return(0,d.jsx)(Ze,{is_from_external:l,mismatch_status:L,needs_poa:u,redirect_button:f});case Ee:return(0,d.jsx)(rt,{is_from_external:l,needs_poa:u,redirect_button:f,is_manual_upload:!0});case Ie:return(0,d.jsx)(rt,{is_from_external:l,needs_poa:u,redirect_button:f});default:return null}default:return null}})),Xi=Qi,en=(0,r.observer)((({height:e,is_from_external:t,onStateChange:i,getChangeableFields:r,updateAccountStatus:c})=>{const u=(0,x.useHistory)(),[_,m]=n.useState(),[f,p]=n.useState(!1),[b,h]=n.useState([]),[y,g]=n.useState(!0),{client:v,common:j,notifications:O}=(0,s.A)(),{account_settings:w,account_status:S,fetchResidenceList:P,is_switching:z,is_high_risk:N,is_withdrawal_lock:D,should_allow_authentication:k,is_virtual:A}=v,{app_routing_history:T,routeBackInApp:I,is_language_changing:E}=j,{refreshNotifications:C}=O,L=(0,a.getPlatformRedirect)(T),F=Object.keys(a.platforms).includes(null==L?void 0:L.ref),R=()=>p(!0),M=(null==w?void 0:w.citizen)||(null==w?void 0:w.country_code),U=()=>{a.WS.authorized.getAccountStatus().then((()=>{C()}))},V=n.useCallback((()=>{P().then((e=>{e.error?m(e.error):h(e.residence_list)}))}),[P]);if(n.useEffect((()=>{E&&V()}),[E,V]),n.useEffect((()=>{z||(m(null),a.WS.authorized.getAccountStatus().then((e=>{if(e.error)return m(e.error),void g(!1);V(),g(!1)})))}),[V,z]),_)return(0,d.jsx)(Ve,{error_message:(null==_?void 0:_.message)||_});if(y||z||(0,a.isEmptyObject)(S)||0===b.length)return(0,d.jsx)(o.Loading,{is_fullscreen:!1});if(A)return(0,d.jsx)(Le,{});const B=Oe(S),{identity:Y,idv:q,allow_poi_resubmission:$,identity_last_attempt:W,identity_status:H,is_age_verified:G,is_idv_disallowed:J,manual:Z,needs_poa:K,onfido:Q,poi_expiring_soon:X}=B,ee=N&&D;if(!k&&!G&&!X)return(0,d.jsx)(it,{});const te=F&&(0,d.jsx)(o.Button,{primary:!0,className:"proof-of-identity__redirect",onClick:()=>{const e=a.platforms[L.ref],{is_hard_redirect:t=!1,url:i=""}=null!=e?e:{};var n;t?(window.location.href=i,window.sessionStorage.removeItem("config.platform")):(n=L.route,I(u,[n]))},children:(0,d.jsx)(l.Localize,{i18n_default_text:"Back to {{platform_name}}",values:{platform_name:L.name}})}),ie=H!=Ne.verified&&q.submissions_left>0&&[Ne.rejected,Ne.suspected,Ne.expired].includes(q.status);if(H===Ne.none||f||$||ie||X)return(0,d.jsx)(Xi,{account_settings:w,allow_poi_resubmission:$,has_require_submission:f,height:null!=e?e:null,getChangeableFields:r,identity_last_attempt:W,idv:q,is_from_external:!!t,is_idv_disallowed:J||ee,manual:Z,needs_poa:K,onfido:Q,onStateChange:i,redirect_button:te,refreshNotifications:C,residence_list:b,updateAccountStatus:c,should_show_mismatch_form:ie});if(!W||H===Ne.verified&&H!==(null==Y?void 0:Y.services[null==W?void 0:W.service].status))switch(H){case Ne.pending:return(0,d.jsx)(rt,{is_from_external:!!t,needs_poa:K,redirect_button:te,is_manual_upload:"pending"===(null==Z?void 0:Z.status)});case Ne.verified:return(0,d.jsx)(lt,{is_from_external:!!t,needs_poa:K,redirect_button:te,service:null==W?void 0:W.service});case Ne.expired:return(0,d.jsx)(Be,{is_from_external:!!t,redirect_button:te,handleRequireSubmission:R});case Ne.rejected:case Ne.suspected:return(0,d.jsx)(tt,{handleRequireSubmission:R})}switch(W.service){case Te:return(0,d.jsx)(Xe,{account_settings:w,handleRequireSubmission:R,getChangeableFields:r,idv:q,is_from_external:!!t,needs_poa:K,redirect_button:te,residence_list:b});case Ie:return(0,d.jsx)(Fi,{handleRequireSubmission:R,is_from_external:!!t,needs_poa:K,onfido:Q,manual:Z,redirect_button:te,country_code:M,handleViewComplete:U});case Ee:return(0,d.jsx)(Li,{manual:Z,country_code:M,is_from_external:t,needs_poa:K,redirect_button:te,handleRequireSubmission:R,handleViewComplete:U,onfido:Q});default:return null}})),tn=en,nn=(0,r.observer)((e=>{const[t,i]=n.useState(0),[r,l]=n.useState(""),c=t;let u=n.useRef(!0).current;const{client:_,notifications:m}=(0,s.A)(),{authentication_status:f,fetchStatesList:p}=_,{refreshNotifications:b}=m,x={body:tn},h={body:ze},y=[...!["pending","verified"].includes(f.identity_status)?[x]:[],...!["pending","verified"].includes(f.document_status)?[h]:[]],[g,v]=n.useState(y);n.useEffect((()=>{b()}),[g,b]),n.useEffect((()=>{p()}),[p]);const j=()=>{u=!1,e.onFinish()},O=()=>{if(!u)return;const e=[...g];v(e)},w=()=>{l(""),t+1<g.length?(O(),i(t+1)):j()},S=(P="body")?g[c][P]:g[c];var P;return(0,d.jsx)(o.Div100vhContainer,{className:"proof-of-identity",id:"verification_modal_content",is_disabled:(0,a.isDesktop)(),height_offset:"40px",children:(0,d.jsx)("div",{className:"proof-of-identity__main-container","data-testid":"dt_verification_modal_body",children:(0,d.jsx)(S,{index:c,onSubmit:w,onStateChange:()=>{O(),w()},height:"auto",onCancel:()=>{t-1>=0?(i(t-1),l("")):j()},onSave:O,form_error:r})})})})),on=(0,r.observer)((()=>{const{ui:e,client:t}=(0,s.A)(),{authentication_status:i}=t,{is_verification_modal_visible:r,setIsVerificationModalVisible:a,setIsVerificationSubmitted:c}=e,u=!["pending","verified"].includes(i.identity_status),_=!["pending","verified"].includes(i.document_status);let m;return m=u&&_?(0,l.localize)("Submit your proof of identity and address"):u&&!_?(0,l.localize)("Submit your proof of identity"):(0,l.localize)("Submit your proof of address"),(0,d.jsxs)(n.Suspense,{fallback:(0,d.jsx)(o.UILoader,{}),children:[(0,d.jsx)(o.DesktopWrapper,{children:(0,d.jsx)(o.Modal,{className:"verification-modal",is_open:r,title:m,toggleModal:()=>a(!1),height:"70rem",width:"99.6rem",exit_classname:"verification-modal--custom-exit",children:(0,d.jsx)(nn,{onFinish:()=>{a(!1),c(!0)}})})}),(0,d.jsx)(o.MobileWrapper,{children:(0,d.jsx)(o.MobileDialog,{portal_element_id:"deriv_app",title:m,wrapper_classname:"verification-modal",visible:r,onClose:()=>a(!1),children:(0,d.jsx)(nn,{onFinish:()=>{a(!1),c(!0)}})})})]})}))},205007:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(649524),o=i.n(n),r=i(504377),s=i(286326);const a=e=>`Unable to read file ${e}`,l=()=>{const[e,t]=(0,s.useState)(null),i=(0,s.useMemo)((()=>new(o())({connection:r.WS.getSocket()})),[]),n=(0,s.useCallback)((async(e,n,o)=>null!=e&&e.length?new Promise(((s,l)=>{let c=!1,d=null;(async()=>{try{const t=await(0,r.compressImageFiles)(e),u=await(0,r.readFiles)(t,a,null!=n?n:{});if(u.forEach((e=>{e&&"message"in e&&(c=!0,d=e.message,l(e.message))})),c||!u.length)return null==o||o(),l(new Error(null!=d?d:"Something went wrong!"));const _=await i.upload(u[0]);s(_)}catch(e){t(e),l(e)}})()})):Promise.reject(new Error("No files selected"))),[i]);return{error:e,upload:n,uploader_instance:i}}},751506:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(286326),o=i(108340);const r=["data","mutate"];function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function a(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const l=()=>{const e=(0,o.A)("notification_event"),{data:t,mutate:i}=e,l=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(e,r),c=n.useCallback((e=>i({payload:e})),[i]);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({notification_event:null==t?void 0:t.notification_event,send:c},l)}},539943:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(773835);const o=["data"];function r(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function s(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const a=e=>{const t=(0,n.A)("service_token",{payload:e,options:{retry:3,enabled:Boolean(e)}}),{data:i}=t,a=function(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;i[n]=e[n]}return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)i=r[n],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}(t,o);return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({service_token:null==i?void 0:i.service_token},a)}}}]);
//# sourceMappingURL=core.chunk.verification-modal.78973846415b1162ad96.js.map