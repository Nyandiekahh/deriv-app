{"version":3,"file":"js/core.chunk.set-residence-modal.78973846415b1162ad96.js","mappings":"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","sources":["webpack:///./App/Containers/SetResidenceModal/set-residence-modal.jsx","webpack:///./App/Containers/SetResidenceModal/index.js","webpack:///./App/Containers/SetResidenceModal/set-residence-form.jsx"],"sourcesContent":["import React from 'react';\nimport classNames from 'classnames';\nimport { Form, Formik } from 'formik';\nimport PropTypes from 'prop-types';\nimport { Button, Dialog, Text } from '@deriv/components';\nimport { website_name } from '@deriv/shared';\nimport { Localize, localize } from '@deriv/translations';\nimport SetResidenceForm from './set-residence-form.jsx';\nimport 'Sass/app/modules/set-residence.scss';\nimport { observer, useStore } from '@deriv/stores';\n\n// TODO: Move some of these functions to helpers since some of them are shared with AccountSignUpModal\nconst isResidenceText = (item, values) => item.text.toLowerCase() === values.residence.toLowerCase();\n\nconst validateResidence = (values, residence_list) => {\n    const errors = {};\n\n    if (!values.residence) {\n        errors.residence = true;\n    } else {\n        const index_of_selection = residence_list.findIndex(item => isResidenceText(item, values));\n\n        if (index_of_selection === -1 || residence_list[index_of_selection].disabled === 'DISABLED') {\n            errors.residence = localize('Unfortunately, {{website_name}} is not available in your country.', {\n                website_name,\n            });\n        }\n    }\n\n    return errors;\n};\n\nconst SetResidence = ({ enableApp, onSetResidence, residence_list, toggleModalVisibility }) => {\n    const onSetResidenceComplete = error => {\n        // TODO: Proper error handling (currently we have no place to put the message)\n        if (error) {\n            throw Error(error);\n        }\n        // Handle lower level modal controls due to overriding modal rendering\n        toggleModalVisibility(false);\n        enableApp();\n    };\n\n    const onSetResidencePassthrough = values => {\n        const index_of_selection = residence_list.findIndex(item => isResidenceText(item, values));\n        const modded_values = { ...values, residence: residence_list[index_of_selection].value };\n        onSetResidence(modded_values, onSetResidenceComplete);\n    };\n    return (\n        <div className='set-residence'>\n            <Formik\n                initialValues={{ residence: '' }}\n                validate={values => validateResidence(values, residence_list)}\n                onSubmit={onSetResidencePassthrough}\n            >\n                {({ isSubmitting, errors, values, setFieldValue, touched }) => (\n                    <Form>\n                        <React.Fragment>\n                            <SetResidenceForm\n                                errors={errors}\n                                touched={touched}\n                                setFieldValue={setFieldValue}\n                                residence_list={residence_list}\n                            >\n                                <Text as='p' size='xxs' weight='bold' className='set-residence__subtext'>\n                                    <Localize i18n_default_text='We need this to make sure our service complies with laws and regulations in your country.' />\n                                </Text>\n                                <Button\n                                    className={classNames('set-residence__btn', {\n                                        'set-residence__btn--disabled':\n                                            !values.residence || errors.residence || isSubmitting,\n                                    })}\n                                    type='submit'\n                                    is_disabled={!values.residence || !!errors.residence || isSubmitting}\n                                    primary\n                                    large\n                                >\n                                    <Localize i18n_default_text='Set residence' />\n                                </Button>\n                            </SetResidenceForm>\n                        </React.Fragment>\n                    </Form>\n                )}\n            </Formik>\n        </div>\n    );\n};\n\nSetResidence.propTypes = {\n    enableApp: PropTypes.func,\n    onSetResidence: PropTypes.func,\n    residence_list: PropTypes.array,\n    toggleModalVisibility: PropTypes.func,\n};\n\nconst SetResidenceModal = observer(() => {\n    const { ui, client } = useStore();\n    const {\n        is_set_residence_modal_visible: is_visible,\n        toggleSetResidenceModal,\n        enableApp,\n        disableApp,\n        is_loading,\n    } = ui;\n    const { onSetResidence, residence_list } = client;\n    if (residence_list.length < 1) return null;\n    return (\n        <Dialog\n            is_visible={is_visible}\n            disableApp={disableApp}\n            enableApp={enableApp}\n            is_loading={is_loading || !residence_list.length}\n            is_content_centered\n        >\n            <SetResidence\n                onSetResidence={onSetResidence}\n                residence_list={residence_list}\n                toggleModalVisibility={toggleSetResidenceModal}\n                enableApp={enableApp}\n            />\n        </Dialog>\n    );\n});\n\nexport default SetResidenceModal;\n","import SetResidenceModal from './set-residence-modal.jsx';\n\nexport default SetResidenceModal;\n","import React from 'react';\nimport { Field } from 'formik';\nimport PropTypes from 'prop-types';\n\nimport { Autocomplete, Text } from '@deriv/components';\nimport { Localize, localize } from '@deriv/translations';\n\nconst SetResidenceForm = ({\n    children,\n    class_prefix = 'set-residence',\n    default_value,\n    history_value,\n    errors,\n    onResidenceSelectionChanged,\n    touched,\n    setFieldTouched,\n    setFieldValue,\n    residence_list,\n}) => {\n    React.useEffect(() => {\n        if (default_value) {\n            setFieldTouched('residence', true);\n            setFieldValue('residence', default_value, true);\n        }\n    }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n    return (\n        <div className={`${class_prefix}__residence-selection`}>\n            <Field name='residence'>\n                {({ field }) => (\n                    <React.Fragment>\n                        <Autocomplete\n                            {...field}\n                            autoComplete='off'\n                            input_id='dt_core_set-residence-form_signup-residence-select'\n                            type='text'\n                            label={localize('Country of residence')}\n                            historyValue={history_value}\n                            error={touched.residence && errors.residence}\n                            required\n                            list_items={residence_list}\n                            onItemSelection={({ value, text }) => {\n                                setFieldValue('residence', value ? text : '', true);\n                                onResidenceSelectionChanged?.();\n                            }}\n                        />\n                    </React.Fragment>\n                )}\n            </Field>\n            {!errors?.residence?.length && (\n                <Text as='p' size='xxs' className='account-signup__subtext' color='less-prominent'>\n                    <Localize i18n_default_text='Select the country where you currently live.' />\n                </Text>\n            )}\n            <div className={`${class_prefix}__button_wrapper`}>{children}</div>\n        </div>\n    );\n};\n\nSetResidenceForm.propTypes = {\n    children: PropTypes.object,\n    class_prefix: PropTypes.string,\n    default_value: PropTypes.string,\n    history_value: PropTypes.string,\n    errors: PropTypes.object,\n    onResidenceSelectionChanged: PropTypes.func,\n    residence_list: PropTypes.arrayOf(PropTypes.object),\n    setFieldTouched: PropTypes.func,\n    setFieldValue: PropTypes.func,\n    touched: PropTypes.object,\n};\n\nexport default SetResidenceForm;\n"],"names":["isResidenceText","item","values","text","toLowerCase","residence","SetResidence","enableApp","onSetResidence","residence_list","toggleModalVisibility","onSetResidenceComplete","error","Error","_jsx","className","children","Formik","initialValues","validate","validateResidence","errors","index_of_selection","findIndex","disabled","localize","website_name","onSubmit","modded_values","_objectSpread","value","isSubmitting","setFieldValue","touched","Form","React","_jsxs","SetResidenceForm","Text","as","size","weight","Localize","i18n_default_text","Button","classNames","type","is_disabled","primary","large","propTypes","PropTypes","observer","ui","client","useStore","is_set_residence_modal_visible","is_visible","toggleSetResidenceModal","disableApp","is_loading","length","Dialog","is_content_centered","class_prefix","default_value","history_value","onResidenceSelectionChanged","setFieldTouched","_errors$residence","Field","name","field","Autocomplete","autoComplete","input_id","label","historyValue","required","list_items","onItemSelection","color"],"sourceRoot":""}