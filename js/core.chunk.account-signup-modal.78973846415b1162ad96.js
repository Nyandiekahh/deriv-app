"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3225],{289881:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var n=r(286326),i=r(824223),s=r(597598),o=r.n(s),a=r(592353),c=r(488814),l=r(504377),u=r(500309),d=r(414646),p=r(33118),_=r(281476),f=r(391289),b=r(836870);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const h=({class_prefix:e,errors:t,touched:r,setFieldValue:s,citizenship_list:o})=>(0,b.jsxs)("div",{className:`${e}__residence-selection`,children:[(0,b.jsx)(i.Field,{name:"citizenship",children:({field:e})=>(0,b.jsx)(n.Fragment,{children:(0,b.jsx)(a.Autocomplete,m(m({},e),{},{autoComplete:"off",input_id:"dt_core_set-citizenship-form_signup-citizenship-select",type:"text",label:(0,p.localize)("Citizenship"),error:r.citizenship&&t.citizenship,required:!0,list_items:o,onItemSelection:({value:e,text:t})=>s("citizenship",e?t:"",!0)}))})}),(0,b.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",color:"less-prominent",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Select your citizenship/nationality as it appears on your passport or other government-issued ID."})})]});h.propTypes={class_prefix:o().string,citizenship_list:o().arrayOf(o().object),errors:o().object,setFieldTouched:o().func,setFieldValue:o().func,touched:o().object};const w=h;var y=r(255530),j=r.n(y);const x=({children:e})=>(0,b.jsx)("div",{className:"signup-separator-container",children:e});x.Line=({is_invisible:e})=>(0,b.jsx)("div",{className:j()("signup-separator-container__line",{"signup-separator-container__line--invisible":e})});const O=x;function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const E=(0,u.observer)((({api_error:e,errors:t,handleBlur:r,handleChange:s,isModalVisible:o,isSubmitting:c,touched:u,pw_input:_,setFieldTouched:f,updatePassword:g,values:m})=>{const{ui:v}=(0,d.A)(),{is_mobile:h}=v;return n.useEffect((()=>{l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"password_screen_opened",form_name:h?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}}}])}),[h]),(0,b.jsxs)("div",{className:"account-signup__password-selection",children:[(0,b.jsx)(a.Text,{as:"p",size:h?"xs":"s",weight:"bold",className:"account-signup__heading",align:"center",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Keep your account secure with a password"})}),(0,b.jsx)(i.Field,{name:"password",children:({field:e})=>(0,b.jsx)(a.PasswordMeter,{input:_,has_error:!(!u.password||!t.password),custom_feedback_messages:(0,l.getErrorMessages)().password_warnings,children:(0,b.jsx)(a.PasswordInput,P(P({},e),{},{autoComplete:"new-password",className:"account-signup__password-field",label:(0,p.localize)("Create a password"),error:u.password&&t.password,required:!0,value:m.password,onBlur:r,onChange:e=>{const t=e.target;f("password",!0),t&&g(t.value),s(e)},input_id:"dt_core_account-signup-modal_account-signup-password-field"}))})}),(0,b.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",align:"center",children:(0,b.jsx)(p.Localize,{i18n_default_text:"Strong passwords contain at least 8 characters, combine uppercase and lowercase letters, numbers, and symbols."})}),(0,b.jsx)(O,{}),e?(0,b.jsxs)(n.Fragment,{children:[(0,b.jsx)(a.Text,{as:"p",size:"xxs",color:"loss-danger",className:"account-signup__subtext account-signup__subtext--error",align:"center",children:e}),(0,b.jsxs)("div",{className:"account-signup__error-wrapper",children:[(0,b.jsx)(a.Button,{large:!0,secondary:!0,text:(0,p.localize)("Cancel"),type:"button",onClick:()=>o(!1)}),(0,b.jsx)(a.Button,{large:!0,primary:!0,text:(0,p.localize)("Create new account"),type:"button",onClick:()=>(0,l.redirectToSignUp)()})]})]}):(0,b.jsx)("div",{className:"account-signup__footer",children:(0,b.jsx)(a.Button,{className:j()("account-signup__btn",{"account-signup__btn--disabled":!m.password||t.password||c}),id:"dt_core_account-signup-modal_submit-btn",type:"submit",is_disabled:!m.password||!!t.password||c,text:(0,p.localize)("Start trading"),large:!0,primary:!0})})]})})),C=({ab_questionnaire:e,handleSignup:t})=>{var r,i;const s=!(null===(r=e[1].answers)||void 0===r||null===(r=r[0])||void 0===r||!r.header);n.useEffect((()=>{_.Analytics.trackEvent("ce_questionnaire_form",{action:"open"})}),[e]);return(0,b.jsxs)("div",{className:"questionnaire-modal",children:[(0,b.jsx)(a.Text,{as:"h2",size:"xs",weight:"bold",align:"center",children:e[1].question}),(0,b.jsx)("ul",{className:j()({"questionnaire-modal__answers":s,"questionnaire-modal__options":!s}),children:null===(i=e[1])||void 0===i||null===(i=i.answers)||void 0===i?void 0:i.map((({code:r,text:n,header:i},o)=>(0,b.jsx)("li",{className:j()({"questionnaire-modal__answers_content":s,"questionnaire-modal__options_card":!s}),children:(0,b.jsxs)(a.Button,{"data-testid":`dt_questionnaire_${r}`,onClick:()=>{return n=r,i=o+1,window.dataLayer=[...window.dataLayer,{event:"ce_questionnaire_form",analyticsData:{action:"choose_answer",question:e[0].question,answer_content:e[0].answers.filter((({code:e})=>e===n))[0].text,answer_code:n,answer_index:i}}],void t();var n,i},transparent:!0,children:[i&&(0,b.jsx)(a.Text,{as:"p",size:"xs",weight:"bold",children:i}),(0,b.jsx)(a.Text,{as:"p",size:"xs",children:n})]})},`${r}_questionnaire`)))})]})};var k=r(76958);const N=(e,t)=>{const r={};if((0,l.validLength)(e.password,{min:8,max:25})?(0,l.validPassword)(e.password)||(r.password=(0,l.getErrorMessages)().password()):r.password=(0,p.localize)("You should enter {{min_number}}-{{max_number}} characters.",{min_number:8,max_number:25}),e.residence){const n=t.findIndex((t=>t.text.toLowerCase()===e.residence.toLowerCase()));-1!==n&&"DISABLED"!==t[n].disabled||(r.residence=(0,p.localize)("Unfortunately, {{website_name}} is not available in your country.",{website_name:l.website_name}))}else r.residence=!0;if(e.citizenship){-1===t.findIndex((t=>t.text.toLowerCase()===e.citizenship.toLowerCase()))&&(r.citizenship=!0)}else r.citizenship=!0;return r};function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function A(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const D=({enableApp:e,is_mobile:t,isModalVisible:r,clients_country:s,onSignup:o,residence_list:u,setIsFromSignupAccount:d})=>{const[g,m]=n.useState(!1),[v,h]=n.useState(!0),[y,j]=n.useState(""),x=n.useRef(),[O,S]=n.useState(""),[P,z]=n.useState(!1),T=n.useRef(!1),A=n.useRef(!1),[D,q]=n.useState(!1),[L,V]=n.useState(!1),[I,B]=n.useState(),[M,R]=n.useState({}),$=(0,p.getLanguage)(),[U]=(0,c.A)({featureFlag:"signup_flow_error",defaultValue:!0}),K=e=>{var t;return e&&"br"===(null===(t=u[H(e)])||void 0===t||null===(t=t.value)||void 0===t?void 0:t.toLowerCase())},W=(e,t)=>!((!K(e.residence)||D)&&e.residence&&!t.residence&&e.citizenship&&!t.citizenship),Y=e=>{S(e)};n.useEffect((()=>{l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"country_selection_screen_opened",form_name:t?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}},cache:!0}]),l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:"signup_confirmed",form_name:t?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}},cache:!0}]),f.WS.wait("website_status","residence_list").then((()=>{s&&u&&j((0,l.getLocation)(u,s,"text")),h(!1)}));B((()=>{var e,t,r,n,i;let s=_.Analytics.getFeatureValue("questionnaire-config","inactive")||"inactive";const o=s;var a;(s=null!==(e=null!==(t=null===(r=s)||void 0===r?void 0:r[$])&&void 0!==t?t:null===(n=s)||void 0===n?void 0:n.EN)&&void 0!==e?e:s,null!==(i=s)&&void 0!==i&&i.show_answers_in_random_order)?s=[F({},null==o?void 0:o.default),F(F({},s),{},{answers:(0,l.shuffleArray)(null===(a=s)||void 0===a?void 0:a.answers)})]:"inactive"!==s&&(s=[F({},null==o?void 0:o.default),F({},s)]);return s})())}),[]);const G=(e,r,n)=>{const i=t?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default";l.cacheTrackEvents.loadEvent([{event:{name:"ce_virtual_signup_form",properties:{action:e,form_name:i,error_message:r,screen_name:n}}}])};n.useEffect((()=>{T.current=P}),[P]),n.useEffect((()=>{l.cacheTrackEvents.trackConsoleErrors((e=>{if(U&&e){const t=T.current?"password_screen_opened":"country_selection_screen";"country_selection_screen"===t?A.current&&A.current===e||(G("signup_flow_error",e,t),A.current=e):"password_screen_opened"===t&&G("signup_flow_error",e,t)}}))}),[U]);const H=e=>u.findIndex((t=>t.text.toLowerCase()===(null==e?void 0:e.toLowerCase()))),J=()=>o(M,Q),Q=n=>{n?(m(n),_.Analytics.trackEvent("ce_virtual_signup_form",{action:"signup_flow_error",form_name:t?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default",error_message:n,screen_name:"password_screen_opened"})):(d(!0),r(!1),l.SessionStore.remove("signup_query_param"),e(),_.Analytics.trackEvent("ce_virtual_signup_form",{action:"signup_done",form_name:t?"virtual_signup_web_mobile_default":"virtual_signup_web_desktop_default"}))};return v||(0,l.setPerformanceValue)("signup_time"),(0,b.jsx)("div",{className:"account-signup",children:v?(0,b.jsx)(a.Loading,{is_fullscreen:!1}):(0,b.jsx)(i.Formik,{initialValues:{citizenship:"",password:"",residence:""},validate:e=>N(e,u),onSubmit:e=>{const t=H(e.residence),r=H(e.citizenship),n=F(F({},e),{},{residence:u[t].value,citizenship:u[r].value});R(n),"inactive"===I?o(n,Q):V(!!I)},residence_list:u,children:({isSubmitting:e,handleBlur:s,errors:o,handleChange:c,values:l,setFieldValue:d,setFieldTouched:_,touched:f})=>(0,b.jsx)(i.Form,{children:P?(0,b.jsx)(n.Fragment,{children:L?(0,b.jsx)(C,{ab_questionnaire:I,handleSignup:J}):(0,b.jsx)(E,{api_error:g,errors:o,handleBlur:s,handleChange:c,isModalVisible:r,isSubmitting:e,touched:f,pw_input:O,setFieldTouched:_,updatePassword:Y,values:l})}):(0,b.jsxs)("div",{className:"account-signup__location-selection",children:[(0,b.jsx)(a.Text,{as:"h1",size:t?"xs":"s",weight:"bold",className:"account-signup__heading",children:(0,p.localize)("Select your country and citizenship:")}),(0,b.jsx)(k.A,{class_prefix:"account-signup",errors:o,touched:f,onResidenceSelectionChanged:()=>q(!1),setFieldTouched:_,setFieldValue:d,residence_list:u,default_value:y,history_value:x.current}),(0,b.jsx)(w,{class_prefix:"account-signup",errors:o,touched:f,setFieldTouched:_,setFieldValue:d,citizenship_list:u}),K(l.residence)&&(0,b.jsx)(a.Checkbox,{checked:D,onChange:()=>q(!D),className:"account-signup__checkbox",classNameLabel:"account-signup__label",label:(0,p.localize)("I hereby confirm that my request for opening an account with Deriv to trade OTC products issued and offered exclusively outside Brazil was initiated by me. I fully understand that Deriv is not regulated by CVM and by approaching Deriv I intend to set up a relation with a foreign company.")}),(0,b.jsx)("div",{className:"account-signup__footer",children:(0,b.jsx)(a.Button,{className:"account-signup__btn",is_disabled:W(l,o),type:"button",onClick:()=>{x.current=l,z(!0)},primary:!0,large:!0,text:(0,p.localize)("Next")})})]})})})})};D.propTypes={clients_country:o().string,enableApp:o().func,onSignup:o().func,residence_list:o().array,is_mobile:o().bool,isModalVisible:o().func,setIsFromSignupAccount:o().func};const q=(0,u.observer)((()=>{const{ui:e,client:t}=(0,d.A)(),{onSignup:r,is_logged_in:i,residence_list:s,clients_country:o,logout:c}=t,{is_account_signup_modal_visible:l,toggleAccountSignupModal:u,enableApp:p,disableApp:_,is_loading:f,is_mobile:g,setIsFromSignupAccount:m}=e;return n.useEffect((()=>{l&&i&&c()}),[l,i,c]),(0,b.jsx)(a.Dialog,{className:"account-signup__dialog",is_visible:l,disableApp:_,enableApp:p,is_loading:f||!s.length,is_mobile_full_width:!1,children:(0,b.jsx)(D,{clients_country:o,onSignup:r,residence_list:s,is_mobile:g,isModalVisible:u,enableApp:p,setIsFromSignupAccount:m})})}))},76958:(e,t,r)=>{r.d(t,{A:()=>f});var n=r(286326),i=r(824223),s=r(597598),o=r.n(s),a=r(592353),c=r(33118),l=r(836870);function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){p(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _=({children:e,class_prefix:t="set-residence",default_value:r,history_value:s,errors:o,onResidenceSelectionChanged:u,touched:p,setFieldTouched:_,setFieldValue:f,residence_list:b})=>{var g;return n.useEffect((()=>{r&&(_("residence",!0),f("residence",r,!0))}),[]),(0,l.jsxs)("div",{className:`${t}__residence-selection`,children:[(0,l.jsx)(i.Field,{name:"residence",children:({field:e})=>(0,l.jsx)(n.Fragment,{children:(0,l.jsx)(a.Autocomplete,d(d({},e),{},{autoComplete:"off",input_id:"dt_core_set-residence-form_signup-residence-select",type:"text",label:(0,c.localize)("Country of residence"),historyValue:s,error:p.residence&&o.residence,required:!0,list_items:b,onItemSelection:({value:e,text:t})=>{f("residence",e?t:"",!0),null==u||u()}}))})}),!(null!=o&&null!==(g=o.residence)&&void 0!==g&&g.length)&&(0,l.jsx)(a.Text,{as:"p",size:"xxs",className:"account-signup__subtext",color:"less-prominent",children:(0,l.jsx)(c.Localize,{i18n_default_text:"Select the country where you currently live."})}),(0,l.jsx)("div",{className:`${t}__button_wrapper`,children:e})]})};_.propTypes={children:o().object,class_prefix:o().string,default_value:o().string,history_value:o().string,errors:o().object,onResidenceSelectionChanged:o().func,residence_list:o().arrayOf(o().object),setFieldTouched:o().func,setFieldValue:o().func,touched:o().object};const f=_}}]);
//# sourceMappingURL=core.chunk.account-signup-modal.78973846415b1162ad96.js.map