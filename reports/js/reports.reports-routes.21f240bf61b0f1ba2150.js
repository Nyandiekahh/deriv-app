/*! For license information please see reports.reports-routes.21f240bf61b0f1ba2150.js.LICENSE.txt */
(self.webpackChunk_deriv_reports=self.webpackChunk_deriv_reports||[]).push([["reports-routes"],{"./src/Containers/index.ts":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Se});var r=n("react"),o=n.n(r),a=n("react-router-dom"),l=n("@deriv/components"),i=n("@deriv/shared"),c=n("mobx-react-lite"),s=n("../stores/src/useStore.ts"),u=n("@deriv/translations"),m=n("@deriv-com/analytics"),_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},d="object"==typeof _&&_&&_.Object===Object&&_,p="object"==typeof self&&self&&self.Object===Object&&self;d||p||Function("return this")();var f=typeof window<"u"?r.useLayoutEffect:r.useEffect,v=typeof window>"u";function y(e,{defaultValue:t=!1,initializeWithValue:n=!0}={}){const o=e=>v?t:window.matchMedia(e).matches,[a,l]=(0,r.useState)((()=>n?o(e):t));function i(){l(o(e))}return f((()=>{const t=window.matchMedia(e);return i(),t.addListener?t.addListener(i):t.addEventListener("change",i),()=>{t.removeListener?t.removeListener(i):t.removeEventListener("change",i)}}),[e]),a}const g=()=>({isDesktop:y("(min-width: 1280px)"),isMobile:y("(max-width: 600px)"),isTablet:y("(min-width: 601px) and (max-width: 1279px)"),isTabletPortrait:y("(min-width: 601px) and (max-width: 1279px) and (orientation: portrait)"),isMobileOrTabletLandscape:y("(max-width: 1279px) and (orientation: landscape)")});var E=n("../../node_modules/classnames/index.js"),h=n.n(E);const b=(0,c.observer)((function(e){var t=e.contract_info,n=(0,s.A)(),r=n.common,a=n.portfolio,c=r.server_time,u=a.is_loading;if(!t)return o().createElement("div",null);var m=t.tick_count&&(0,i.getCurrentTick)(t);return c?o().createElement(l.ProgressSlider,{current_tick:m,expiry_time:t.date_expiry,getCardLabels:i.getCardLabels,is_loading:u,server_time:c,start_time:t.date_start,ticks_count:t.tick_count}):null}));var C=function(e){return+e.replace(/,/g,"")>=0?"profit":"loss"};const w=(0,c.observer)((function(e){var t=e.amount,n=e.contract_info,r=e.currency,a=e.is_footer,c=e.is_sell_requested,u=e.profit,m=(0,s.A)().portfolio,_=g().isDesktop,d=m.onClickSell;return o().createElement("div",{className:"open-positions__indicative"},o().createElement("div",{className:"open-positions__indicative--amount"},o().createElement("div",{className:h()({"dc-contract-card--profit":Number(u)>0,"dc-contract-card--loss":Number(u)<0}),"data-testid":"dt_amount_container"},o().createElement(l.Money,{amount:Math.abs(t),currency:r})),o().createElement(l.ArrowIndicator,{value:t,"data-testid":"dt_arrow_indicator"})),!a&&_&&o().createElement(l.ContractCard.Sell,{contract_info:n,is_sell_requested:c,getCardLabels:i.getCardLabels,onClickSell:function(e){e&&d(e)}}))})),x=function(e){var t,n,r,a=e.has_full_contract_title,c=e.icon,s=e.payload,u=e.should_show_accumulator,m=void 0===u||u,_=e.should_show_multiplier,d=void 0===_||_,p="string"==typeof s.shortcode,f=(0,i.extractInfoFromShortcode)(null!==(t=s.shortcode)&&void 0!==t?t:""),v=(0,i.isHighLow)({shortcode_info:f}),y=(0,i.getTradeTypeName)(f.category,{isHighLow:v,showButtonName:a}),g="".concat((0,i.getTradeTypeName)(f.category,{isHighLow:v,showMainTitle:!0})," ").concat(y).trim();return p&&f?o().createElement("div",{className:h()("market-symbol-icon",{"market-symbol-icon__full-title":a})},o().createElement("div",{className:"market-symbol-icon-name"},o().createElement(l.Popover,{classNameTarget:"market-symbol-icon__popover",classNameBubble:"market-symbol-icon__popover-bubble",alignment:"top",message:(0,i.getMarketName)(f.underlying),is_bubble_hover_enabled:!0,disable_target_icon:!0},o().createElement(l.Icon,{icon:f.underlying?"IcUnderlying".concat(f.underlying):"IcUnknown",size:32})),a&&s.display_name),o().createElement("div",{className:"market-symbol-icon-category"},o().createElement(l.Popover,{classNameTarget:"category-type-icon__popover",classNameBubble:"category-type-icon__popover-bubble",alignment:"top",message:g,is_bubble_hover_enabled:!0,disable_target_icon:!0},o().createElement(l.IconTradeTypes,{type:v?"".concat(f.category.toLowerCase(),"_barrier"):f.category.toLowerCase(),color:"brand"})),a&&y),d&&f.multiplier&&o().createElement("div",{className:"market-symbol-icon__multiplier"},"x",f.multiplier),m&&f.growth_rate&&o().createElement("div",{className:"market-symbol-icon__multiplier"},100*+f.growth_rate,"%")):"action_type"in s&&["deposit","hold","release","withdrawal","transfer"].includes(null!==(n=s.action_type)&&void 0!==n?n:"")?o().createElement("div",{className:"market-symbol-icon"},"deposit"===s.action_type&&o().createElement(l.Icon,{icon:c||"IcCashierDeposit",size:32}),"withdrawal"===s.action_type&&o().createElement(l.Icon,{icon:"IcCashierWithdrawal",size:32}),"transfer"===s.action_type&&o().createElement(l.Icon,{icon:"IcAccountTransferColored",size:32}),("hold"===s.action_type||"release"===s.action_type)&&o().createElement(l.Icon,{icon:"IcCashierDp2p",size:32})):["adjustment"].includes(null!==(r=s.action_type)&&void 0!==r?r:"")?o().createElement("div",{className:"market-symbol-icon"},o().createElement(l.Icon,{icon:"IcAdjustment",size:32})):o().createElement("svg",{width:"32",height:"32",className:"unknown-icon","data-testid":"dt_unknown_icon"},o().createElement("rect",{width:"32",height:"32"}))},N=function(e){var t=e.value,n=e.children,r=C(t);return o().createElement("span",{className:"amount--".concat(r)},n)},k=function(e){var t=e.currency;return o().createElement("div",{className:"currency__wrapper"},o().createElement(l.Text,{color:"colored-background",weight:"bold",size:"xxxs"},t))};var S={buy:"success",deposit:"success",hold:"warn",release:"success",sell:"danger",withdrawal:"info",default:"default",adjustment:"adjustment",transfer:"transfer"},T=function(e){return(0,i.isMultiplierContract)(e)?i.CONTRACT_STORAGE_VALUES.MULTIPLIERS:(0,i.isAccumulatorContract)(e)?i.CONTRACT_STORAGE_VALUES.ACCUMULATORS:i.CONTRACT_STORAGE_VALUES.OPTIONS},A=function(e,t){if(e.length>0){var n;if(t&&e.some((function(e){var n,r=null===(n=e.contract_info)||void 0===n?void 0:n.contract_type;return!!r&&T(r)===t})))return t;var r=null===(n=e.reduce((function(e,t){var n,r;return((null===(n=t.contract_info)||void 0===n?void 0:n.date_start)||0)>((null===(r=e.contract_info)||void 0===r?void 0:r.date_start)||0)?t:e})).contract_info)||void 0===n?void 0:n.contract_type;if(r){var o=T(r);return localStorage.setItem("contract_type_value",o),o}}var a,l=localStorage.getItem("contract_type_value");return null!==(a=l)&&Object.values(i.CONTRACT_STORAGE_VALUES).includes(a)?l:i.CONTRACT_STORAGE_VALUES.OPTIONS},O=["row","is_footer","columns_map","server_time","onClickCancel","onClickSell","measure"];function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},D.apply(null,arguments)}var z=function(e){var t,n=e.row,r=void 0===n?{}:n,a=e.is_footer,c=e.columns_map,s=void 0===c?{}:c,u=e.server_time,m=void 0===u?(0,i.toMoment)():u,_=e.onClickCancel,d=e.onClickSell,p=e.measure,f=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,O);if(o().useEffect((function(){a||null==p||p()}),[null===(t=r.contract_info)||void 0===t?void 0:t.underlying,p,a]),a)return o().createElement("div",{className:"open-positions__data-list-footer--content"},o().createElement("div",null,o().createElement(l.DataList.Cell,{row:r,column:s.purchase}),o().createElement(l.DataList.Cell,{row:r,column:s.payout})),o().createElement("div",null,o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:r,column:s.indicative}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:r,column:s.profit})));var v=r,y=v.contract_info,g=v.contract_update,E=v.type,h=v.is_sell_requested,b=y.currency,C=y.date_expiry,w=y.date_start,x=y.tick_count,N=y.purchase_time,k=x?(0,i.getCurrentTick)(y):null,S=x?"ticks":(0,i.getDurationUnitText)((0,i.getDurationPeriod)(y),!0),T=(0,i.getContractDurationType)(((0,i.isTurbosContract)(y.contract_type)?S:y.longcode)||""),A=(0,i.getTimePercentage)(m,null!=w?w:0,null!=C?C:0)/100;return(0,i.isMultiplierContract)(E)||(0,i.isAccumulatorContract)(E)?o().createElement(l.PositionsDrawerCard,D({contract_info:y,contract_update:g,currency:null!=b?b:"",is_link_disabled:!0,onClickCancel:_,onClickSell:d,server_time:m},f)):o().createElement(o().Fragment,null,o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:r,column:s.type}),(0,i.isVanillaContract)(E)||(0,i.isTurbosContract)(E)&&!x?o().createElement(l.ProgressSliderMobile,{current_tick:k,className:"data-list__row--timer",expiry_time:C,getCardLabels:i.getCardLabels,is_loading:!1,server_time:m,start_time:N,ticks_count:x}):o().createElement(l.ProgressBar,{label:null!=T?T:"",value:A})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:r,column:s.reference}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:r,column:s.currency})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:r,column:s.purchase}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:r,column:s.indicative})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:r,column:s.payout}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:r,column:s.profit})),o().createElement("div",{className:"data-list__row-divider"}),o().createElement("div",{className:"data-list__row"},o().createElement(l.ContractCard.Sell,{contract_info:y,is_sell_requested:h,getCardLabels:i.getCardLabels,onClickSell:d})))},M=function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},M.apply(this,arguments)},L=function(e){var t=e.animate,n=void 0===t||t,o=e.animateBegin,a=e.backgroundColor,l=void 0===a?"#f5f6f7":a,i=e.backgroundOpacity,c=void 0===i?1:i,s=e.baseUrl,u=void 0===s?"":s,m=e.children,_=e.foregroundColor,d=void 0===_?"#eee":_,p=e.foregroundOpacity,f=void 0===p?1:p,v=e.gradientRatio,y=void 0===v?2:v,g=e.gradientDirection,E=void 0===g?"left-right":g,h=e.uniqueKey,b=e.interval,C=void 0===b?.25:b,w=e.rtl,x=void 0!==w&&w,N=e.speed,k=void 0===N?1.2:N,S=e.style,T=void 0===S?{}:S,A=e.title,O=void 0===A?"Loading...":A,D=e.beforeMask,z=void 0===D?null:D,L=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["animate","animateBegin","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","gradientDirection","uniqueKey","interval","rtl","speed","style","title","beforeMask"]),I=h||Math.random().toString(36).substring(6),j=I+"-diff",R=I+"-animated-diff",P=I+"-aria",Y=x?{transform:"scaleX(-1)"}:null,U="0; "+C+"; 1",F=k+"s",B="top-bottom"===E?"rotate(90)":void 0;return(0,r.createElement)("svg",M({"aria-labelledby":P,role:"img",style:M(M({},T),Y)},L),O?(0,r.createElement)("title",{id:P},O):null,z&&(0,r.isValidElement)(z)?z:null,(0,r.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+u+"#"+j+")",style:{fill:"url("+u+"#"+R+")"}}),(0,r.createElement)("defs",null,(0,r.createElement)("clipPath",{id:j},m),(0,r.createElement)("linearGradient",{id:R,gradientTransform:B},(0,r.createElement)("stop",{offset:"0%",stopColor:l,stopOpacity:c},n&&(0,r.createElement)("animate",{attributeName:"offset",values:-y+"; "+-y+"; 1",keyTimes:U,dur:F,repeatCount:"indefinite",begin:o})),(0,r.createElement)("stop",{offset:"50%",stopColor:d,stopOpacity:f},n&&(0,r.createElement)("animate",{attributeName:"offset",values:-y/2+"; "+-y/2+"; "+(1+y/2),keyTimes:U,dur:F,repeatCount:"indefinite",begin:o})),(0,r.createElement)("stop",{offset:"100%",stopColor:l,stopOpacity:c},n&&(0,r.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+y),keyTimes:U,dur:F,repeatCount:"indefinite",begin:o})))))},I=function(e){return e.children?(0,r.createElement)(L,M({},e)):(0,r.createElement)(j,M({},e))},j=function(e){return(0,r.createElement)(I,M({viewBox:"0 0 476 124"},e),(0,r.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),(0,r.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),(0,r.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),(0,r.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),(0,r.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),(0,r.createElement)("circle",{cx:"20",cy:"20",r:"20"}))};const R=I;var P=function(e){var t=e.speed;return o().createElement(R,{height:64,width:992,speed:t,backgroundColor:"var(--general-hover)",foregroundColor:"var(--general-active)"},o().createElement("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),o().createElement("rect",{x:"52",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),o().createElement("rect",{x:"132",y:"28",rx:"4",ry:"4",width:"101",height:"8"}),o().createElement("rect",{x:"273",y:"28",rx:"4",ry:"4",width:"120",height:"8"}),o().createElement("rect",{x:"460",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),o().createElement("rect",{x:"593",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),o().createElement("rect",{x:"726",y:"28",rx:"4",ry:"4",width:"64",height:"8"}),o().createElement("rect",{x:"906",y:"28",rx:"4",ry:"4",width:"64",height:"8"}))};const Y=function(e){var t=e.has_selected_date,n=e.component_icon,r=e.localized_message,a=e.localized_period_message;return o().createElement(o().Fragment,null,o().createElement("div",{className:"empty-trade-history"},o().createElement(l.Icon,{data_testid:"dt_empty_trade_history_icon",icon:n,className:"empty-trade-history__icon",color:"disabled",size:96}),o().createElement(l.Text,{size:"xs",align:"center",color:"disabled",className:"empty-trade-history__text"},t?a:r)))},U=function(e){var t=e.className,n=e.is_invisible,r=e.theme,a=e.id,l=e.data_testid;return o().createElement("div",{id:a,"data-testid":l,className:h()("barspinner","barspinner--".concat(r||"dark"),{invisible:n},t)},Array.from(new Array(5)).map((function(e,t){return o().createElement("div",{key:t,className:"barspinner__rect barspinner__rect--".concat(t+1," rect").concat(t+1)})})))},F=function(e){var t=e.component_icon,n=e.empty_message_component,r=e.has_selected_date,a=e.is_empty,l=e.is_loading,i=e.localized_message,c=e.localized_period_message,s=n;return o().createElement(o().Fragment,null,a&&s&&o().createElement(s,{component_icon:t,has_selected_date:r,localized_message:i,localized_period_message:c}),l&&o().createElement(U,{data_testid:"dt_loading_component"}))};var B=function(e){var t=e.is_empty,n=e.component_icon,r=e.children;return o().createElement(o().Fragment,null,t?o().createElement(F,{is_empty:t,empty_message_component:Y,component_icon:n,localized_message:o().createElement(u.Localize,{i18n_default_text:"You have no open positions yet."})}):r)},G=function(e){return isNaN(Number(e.purchase))||!e.purchase},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={},n=(0,i.getUnsupportedContracts)()[e.type];return e.contract_info&&!(0,i.hasContractStarted)(e.contract_info)?t={component:o().createElement(u.Localize,{i18n_default_text:"You'll see these details once the contract starts."})}:(n||e.id)&&(t=n?{component:o().createElement(u.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null==n?void 0:n.name}})}:(0,i.getContractPath)(e.id)),t},q=function(e){var t=e.accumulator_rate,n=e.active_positions,r=e.className,a=e.columns,i=e.component_icon,c=e.contract_type_value,s=e.currency,_=e.is_empty,d=e.is_loading,p=e.mobileRowRenderer,f=e.row_size,v=e.totals,y=g().isDesktop;return o().useEffect((function(){m.Analytics.trackEvent("ce_reports_form",{action:"choose_report_type",form_name:"default",subform_name:"open_positions_form",trade_type_filter:c,growth_type_filter:t})}),[]),o().createElement(o().Fragment,null,d?o().createElement(F,{is_loading:d,empty_message_component:Y,component_icon:i,localized_message:o().createElement(u.Localize,{i18n_default_text:"You have no open positions yet."})}):s&&o().createElement("div",{className:"reports__content"},o().createElement(B,{component_icon:i,is_empty:_},y?o().createElement(l.DataTable,{className:r,columns:a,preloaderCheck:G,footer:v,data_source:n,getRowAction:V,getRowSize:function(){return f},content_loader:P},o().createElement(F,null)):o().createElement(l.DataList,{className:r,data_source:n,footer:v,rowRenderer:p,getRowAction:V,row_gap:8,keyMapper:function(e){return null==e?void 0:e.id}},o().createElement(F,null)))))},W=["component_icon"];function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(null,arguments)}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,i=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Z=(0,c.observer)((function(e){var t=e.component_icon,n=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,W),r=(0,s.A)(),a=r.portfolio,c=r.client,_=r.ui,d=r.common,p=r.contract_trade,f=a.active_positions,v=a.error,y=a.getPositionById,E=a.is_loading,C=a.onClickCancel,N=a.onClickSell,S=a.onMount,T=a.removePositionById,O=c.currency,D=c.is_eu,M=_.notification_messages_ui,L=_.addToast,I=_.current_focus,j=_.is_mobile,R=_.removeToast,P=_.setCurrentFocus,Y=_.should_show_cancellation_warning,U=_.toggleCancellationWarning,F=d.server_time,B={onClickRemove:T,NotificationMessages:M,addToast:L,current_focus:I,is_mobile:j,removeToast:R,setCurrentFocus:P,should_show_cancellation_warning:Y,toggleCancellationWarning:U,getContractById:p.getContractById},G=g().isDesktop,V=(0,l.usePrevious)(f),$=o().useMemo((function(){return function(){var e=new URLSearchParams(location.search).get("contract_type_bots"),t=A(f);if(!e)return[{text:(0,u.localize)("Options"),value:i.CONTRACT_STORAGE_VALUES.OPTIONS,is_default:t===i.CONTRACT_STORAGE_VALUES.OPTIONS},{text:(0,u.localize)("Multipliers"),value:i.CONTRACT_STORAGE_VALUES.MULTIPLIERS,is_default:t===i.CONTRACT_STORAGE_VALUES.MULTIPLIERS},{text:(0,u.localize)("Accumulators"),value:i.CONTRACT_STORAGE_VALUES.ACCUMULATORS,is_default:t===i.CONTRACT_STORAGE_VALUES.ACCUMULATORS}];var n="trade_definition_multiplier"===e,r="trade_definition_accumulator"===e;return[{text:(0,u.localize)("Options"),value:i.CONTRACT_STORAGE_VALUES.OPTIONS,is_default:!n&&!r},{text:(0,u.localize)("Multipliers"),value:i.CONTRACT_STORAGE_VALUES.MULTIPLIERS,is_default:n},{text:(0,u.localize)("Accumulators"),value:i.CONTRACT_STORAGE_VALUES.ACCUMULATORS,is_default:r}]}()}),[V]),Z=K(o().useState((function(){var e,t=sessionStorage.getItem("open_positions_filter");return t&&Object.values(i.CONTRACT_STORAGE_VALUES).includes(t)?t:(null===(e=$.find((function(e){return e.is_default})))||void 0===e?void 0:e.value)||"options"})),2),X=Z[0],J=Z[1],Q=(0,l.usePrevious)(X),ee=[{text:(0,u.localize)("All growth rates"),value:"all growth rates"},{text:"1%",value:"1%"},{text:"2%",value:"2%"},{text:"3%",value:"3%"},{text:"4%",value:"4%"},{text:"5%",value:"5%"}],te=K(o().useState(ee[0].value),2),ne=te[0],re=te[1],oe=(0,l.usePrevious)(ne),ae=X===$[2].value,le=X===$[1].value,ie=$.filter((function(e){return"accumulators"!==e.value||!D})).map((function(e){return{text:e.text,value:e.value}})),ce=null==f?void 0:f.filter((function(e){var t=e.contract_info;return!t||(le?(0,i.isMultiplierContract)(t.contract_type||""):ae?(0,i.isAccumulatorContract)(t.contract_type)&&("".concat((0,i.getGrowthRatePercentage)(Number(t.growth_rate)),"%")===ne||!ne.includes("%")):!(0,i.isMultiplierContract)(t.contract_type||"")&&!(0,i.isAccumulatorContract)(t.contract_type))})),se=function(e,t,n){var r;if(t){var o=0,a=0,l=0,c=0,s=0;e.forEach((function(e){if(l+=Number(e.contract_info.buy_price),c+=Number(e.contract_info.bid_price),s+=Number(e.purchase),e.contract_info){var t,n,r={bid_price:null!==(t=e.contract_info.bid_price)&&void 0!==t?t:0,buy_price:null!==(n=e.contract_info.buy_price)&&void 0!==n?n:0};a+=(0,i.getTotalProfit)(r),e.contract_info.cancellation&&(o+=e.contract_info.cancellation.ask_price||0)}})),r={contract_info:{profit:a,buy_price:l,bid_price:c},purchase:s},o>0&&r.contract_info&&(r.contract_info.cancellation={ask_price:o})}else if(n){var u=0,m=0,_=0,d=0;null==e||e.forEach((function(e){var t,n,r=e.contract_info;u+=Number(r.buy_price),m+=Number(r.bid_price),null!==(t=r.limit_order)&&void 0!==t&&null!==(n=t.take_profit)&&void 0!==n&&n.order_amount&&(_+=r.limit_order.take_profit.order_amount),r&&(d+=(0,i.getTotalProfit)(r))})),r={contract_info:{buy_price:u,bid_price:m,profit:d,limit_order:{take_profit:{order_amount:_}}},purchase:u}}else{var p=0,f=0,v=0,y=0;null==e||e.forEach((function(e){p+=+e.indicative,f+=Number(e.purchase),v+=Number(e.profit_loss),y+=Number(e.payout)})),r={indicative:p,purchase:f,profit_loss:v,payout:y}}return r}(ce,le,ae);o().useEffect((function(){S()}),[]),o().useEffect((function(){var e=sessionStorage.getItem("open_positions_filter");V&&V.length>f.length&&e&&sessionStorage.removeItem("open_positions_filter");var t=sessionStorage.getItem("open_positions_filter");if(!t||!Object.values(i.CONTRACT_STORAGE_VALUES).includes(t)){var n=A(f,X);n!==X&&J(n)}}),[V,f,ce.length]),o().useEffect((function(){Q&&m.Analytics.trackEvent("ce_reports_form",{action:"filter_trade_type",form_name:"default",subform_name:"open_positions_form",trade_type_filter:X})}),[X]),o().useEffect((function(){oe&&m.Analytics.trackEvent("ce_reports_form",{action:"filter_growth_rate",form_name:"default",subform_name:"open_positions_form",growth_type_filter:ne})}),[ne]);var ue=function(e){J(e),sessionStorage.setItem("open_positions_filter",e)};if(v)return o().createElement("p",null,v);var me=le&&F?function(e){var t=e.currency,n=e.onClickCancel,r=e.onClickSell,a=e.getPositionById,c=e.server_time,s=e.isDesktop;return[{title:s?(0,u.localize)("Type"):"",col_index:"type",renderCellContent:function(e){var t=e.row_obj;return e.is_footer?(0,u.localize)("Total"):o().createElement(x,{key:t.id,payload:t.contract_info,should_show_multiplier:!1})}},{title:(0,u.localize)("Multiplier"),col_index:"multiplier",renderCellContent:function(e){var t=e.row_obj;return t.contract_info&&t.contract_info.multiplier?"x".concat(t.contract_info.multiplier):""}},{title:(0,u.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return o().createElement(k,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,u.localize)("Contract cost"),col_index:"buy_price",renderCellContent:function(e){var n=e.row_obj;if(n.contract_info){var r=(n.contract_info.cancellation||{}).ask_price,a=void 0===r?0:r;return o().createElement(l.Money,{amount:n.contract_info.buy_price-a,currency:t})}return""}},{title:(0,u.localize)("Deal cancel. fee"),col_index:"cancellation",renderCellContent:function(e){var n=e.row_obj;return n.contract_info&&n.contract_info.underlying&&n.contract_info.cancellation?o().createElement(l.Money,{amount:n.contract_info.cancellation.ask_price,currency:t}):"-"}},{title:o().createElement(u.Localize,{i18n_default_text:"Stake"}),col_index:"purchase",renderCellContent:function(e){var n=e.cell_value;return o().createElement(l.Money,{amount:n,currency:t})}},{title:o().createElement(u.Localize,{i18n_default_text:"Take profit<0 />Stop loss",components:[o().createElement("br",{key:0})]}),col_index:"limit_order",renderCellContent:function(e){var n,r=e.row_obj;if(e.is_footer)return"";var a=(null===(n=r.contract_info)||void 0===n?void 0:n.limit_order)||{},i=a.take_profit,c=a.stop_loss;return o().createElement(o().Fragment,null,o().createElement("div",null,null!=i&&i.order_amount?o().createElement(l.Money,{has_sign:!0,amount:i.order_amount,currency:t}):"-"),o().createElement("div",null,null!=c&&c.order_amount?o().createElement(l.Money,{has_sign:!0,amount:c.order_amount,currency:t}):"-"))}},{title:(0,u.localize)("Contract value"),col_index:"bid_price",renderCellContent:function(e){var n=e.row_obj;if(e.is_footer)return"";if(!n.contract_info||!n.contract_info.bid_price)return"-";var r=(0,i.getTotalProfit)(n.contract_info);return o().createElement("div",{className:h()("open-positions__bid_price",{"open-positions__bid_price--negative":r<0,"open-positions__bid_price--positive":r>0})},o().createElement(l.Money,{amount:n.contract_info.bid_price,currency:t}),o().createElement(l.ArrowIndicator,{className:"open-positions__bid_price--movement",value:r}))}},{title:s?o().createElement(u.Localize,{i18n_default_text:"Total<0 />profit/loss",components:[o().createElement("br",{key:0})]}):o().createElement(u.Localize,{i18n_default_text:"Total profit/loss"}),col_index:"profit",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.profit)return null;var r=(0,i.getTotalProfit)(n.contract_info);return o().createElement("div",{className:h()("open-positions__profit-loss",{"open-positions__profit-loss--negative":r<0,"open-positions__profit-loss--positive":r>0})},o().createElement(l.Money,{amount:Math.abs(r),currency:t}),o().createElement(l.ArrowIndicator,{className:"open-positions__profit-loss--movement",value:r}))}},{title:(0,u.localize)("Action"),col_index:"action",renderCellContent:function(e){var t=e.row_obj;if(e.is_footer)return o().createElement("div",{className:"open-positions__row-action"});var s=t.contract_info,u=(a(s.contract_id)||{}).is_sell_requested;return o().createElement("div",{className:"open-positions__row-action"},o().createElement(l.ContractCard.MultiplierCloseActions,{contract_info:s,getCardLabels:i.getCardLabels,is_sell_requested:u,onClickCancel:n,onClickSell:r,server_time:c}))}}]}({currency:O,onClickCancel:C,onClickSell:N,getPositionById:y,server_time:F,isDesktop:G}):ae?function(e){var t=e.currency,n=e.onClickSell,r=e.getPositionById,a=e.isDesktop;return[{title:a?(0,u.localize)("Type"):"",col_index:"type",renderCellContent:function(e){var t=e.row_obj;return e.is_footer?(0,u.localize)("Total"):o().createElement(x,{key:t.id,payload:t.contract_info,should_show_multiplier:!1,should_show_accumulator:!1})}},{title:(0,u.localize)("Growth rate"),col_index:"growth_rate",renderCellContent:function(e){var t=e.row_obj;return t.contract_info&&t.contract_info.growth_rate?"".concat((0,i.getGrowthRatePercentage)(t.contract_info.growth_rate),"%"):""}},{title:(0,u.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return o().createElement(k,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,u.localize)("Stake"),col_index:a?"buy_price":"purchase",renderCellContent:function(e){var n=e.row_obj;return n.contract_info?o().createElement(l.Money,{amount:n.contract_info.buy_price,currency:t}):""}},{title:(0,u.localize)("Take profit"),col_index:"limit_order",renderCellContent:function(e){var n,r=((null===(n=e.row_obj.contract_info)||void 0===n?void 0:n.limit_order)||{}).take_profit;return o().createElement("div",null,null!=r&&r.order_amount?o().createElement(l.Money,{has_sign:!0,amount:r.order_amount,currency:t}):"-")}},{title:(0,u.localize)("Contract value"),col_index:"bid_price",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.bid_price)return"-";var r=(0,i.getTotalProfit)(n.contract_info);return o().createElement("div",{className:h()("open-positions__bid_price",{"open-positions__bid_price--negative":r<0,"open-positions__bid_price--positive":r>0})},o().createElement(l.Money,{amount:n.contract_info.bid_price,currency:t}),o().createElement(l.ArrowIndicator,{className:"open-positions__bid_price--movement",value:r}))}},{title:(0,u.localize)("Total profit/loss"),col_index:"profit",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.profit)return null;var r=(0,i.getTotalProfit)(n.contract_info);return o().createElement("div",{className:h()("open-positions__profit-loss",{"open-positions__profit-loss--negative":r<0,"open-positions__profit-loss--positive":r>0})},o().createElement(l.Money,{amount:Math.abs(r),currency:t}),o().createElement(l.ArrowIndicator,{className:"open-positions__profit-loss--movement",value:r}))}},{title:(0,u.localize)("Action"),col_index:"action",renderCellContent:function(e){var t=e.row_obj;if(e.is_footer)return o().createElement("div",{className:"open-positions__row-action"});var a=t.contract_info,c=(r(a.contract_id)||{}).is_sell_requested;return o().createElement("div",{className:"open-positions__row-action"},o().createElement(l.ContractCardSell,{contract_info:a,is_sell_requested:c,getCardLabels:i.getCardLabels,onClickSell:n}))}}]}({currency:O,onClickSell:N,getPositionById:y,isDesktop:G}):function(e,t){return[{key:"icon",title:t?(0,u.localize)("Type"):"",col_index:"type",renderCellContent:function(e){var t=e.row_obj,n=e.is_footer,r=e.is_vanilla,a=e.is_turbos;return n?(0,u.localize)("Total"):o().createElement(x,{key:t.id,payload:t.contract_info,has_full_contract_title:r||a})}},{title:(0,u.localize)("Ref. ID"),col_index:"reference"},{title:(0,u.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return o().createElement(k,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,u.localize)("Stake"),col_index:"purchase",renderCellContent:function(t){var n=t.cell_value;return o().createElement(l.Money,{amount:n,currency:e})}},{title:(0,u.localize)("Potential payout"),col_index:"payout",renderHeader:function(e){var t=e.title,n=e.is_vanilla;return o().createElement("span",null,n?(0,u.localize)("Strike"):t)},renderCellContent:function(t){var n,r=t.cell_value,a=t.row_obj,i=t.is_vanilla,c=r?o().createElement(l.Money,{amount:r,currency:e}):o().createElement("span",null,"-");return i?null===(n=a.barrier)||void 0===n?void 0:n.toFixed(2):c}},{title:(0,u.localize)("Total profit/loss"),col_index:"profit",renderCellContent:function(t){var n=t.row_obj,r=null!=n?n:{},a=r.profit_loss,i=r.contract_info;if(a||0===a||null!=i&&i.profit||0===(null==i?void 0:i.profit)){var c=null!=a?a:i.profit;return o().createElement("div",{className:h()("open-positions__profit-loss",{"open-positions__profit-loss--negative":c<0,"open-positions__profit-loss--positive":c>0})},o().createElement(l.Money,{amount:Math.abs(c),currency:e}),o().createElement(l.ArrowIndicator,{className:"open-positions__profit-loss--movement",value:c}))}}},{title:(0,u.localize)("Contract value"),col_index:"indicative",renderCellContent:function(t){var n=t.cell_value,r=t.row_obj,a=t.is_footer,l=null!=r?r:{},i=l.profit_loss,c=l.contract_info,s=null!=i?i:c.profit;return o().createElement(w,{amount:+n,currency:e,contract_info:r.contract_info,is_sell_requested:r.is_sell_requested,is_footer:a,profit:s})}},{title:(0,u.localize)("Remaining time"),col_index:"id",renderCellContent:function(e){var t=e.row_obj;return o().createElement(b,{contract_info:t.contract_info})}}]}(O,G),_e={};me.forEach((function(e){_e[e.col_index]=e}));var de,pe,fe={accumulator_rate:ne,active_positions:ce,component_icon:t,contract_type_value:X,currency:O,is_loading:E,mobileRowRenderer:function(e){return o().createElement(z,H({},e,{columns_map:_e,server_time:F||(0,i.toMoment)(),onClickCancel:C,onClickSell:N},n,B))},totals:se};return o().createElement(o().Fragment,null,o().createElement(M,null),0!==f.length&&(G?o().createElement("div",{className:ae?"open-positions__accumulator-container":"open-positions__contract-types-selector-container"},o().createElement("div",{className:"open-positions__accumulator-container__contract-dropdown"},o().createElement(l.Dropdown,{is_align_text_left:!0,name:"contract_types",list:ie,value:X,onChange:function(e){return ue(e.target.value)}})),ae&&!D&&o().createElement("div",{className:"open-positions__accumulator-container__rates-dropdown"},o().createElement(l.Dropdown,{is_align_text_left:!0,name:"accumulator_rates",list:ee,value:ne,onChange:function(e){return re(e.target.value)}}))):o().createElement("div",{className:ae?"open-positions__accumulator-container--mobile":"open-positions__contract-types-selector-container--mobile"},o().createElement(l.SelectNative,{className:"open-positions__accumulator-container-mobile__contract-dropdown",list_items:ie,value:X,should_show_empty_option:!1,onChange:function(e){return ue(e.target.value)}}),ae&&!D&&o().createElement(l.SelectNative,{className:"open-positions__accumulator-container--mobile__rates-dropdown",list_items:ee,value:ne,should_show_empty_option:!1,onChange:function(e){return re(e.target.value)}}))),(de="open-positions",pe=G?63:5,ae?(de="open-positions-accumulator open-positions",pe=G?68:3):le&&(de="open-positions-multiplier open-positions",pe=G?68:3),o().createElement(q,H({className:de,columns:me,is_empty:0===ce.length,row_size:pe},fe))))}));const X=(0,a.withRouter)(Z);var J=n("react-router"),Q=n("../../node_modules/react-loadable/lib/index.js"),ee=n.n(Q);function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,i=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var re=function(e){var t=e.id,n=e.className,r=e.selected_value,a=e.value,i=e.label,c=e.onChange;return o().createElement("label",{htmlFor:t,className:h()("composite-calendar-modal__radio",n,{"composite-calendar-modal__radio--selected":r===a}),onClick:function(){return c({label:i,value:a})}},o().createElement("input",{className:"composite-calendar-modal__radio-input",id:t,type:"radio",value:a}),o().createElement("span",{className:h()("composite-calendar-modal__radio-circle",{"composite-calendar-modal__radio-circle--selected":r===a})}),o().createElement(l.Text,{as:"p",color:"prominent",size:"xs",line_height:"unset",weight:r===a?"bold":"normal"},i))},oe="custom",ae=o().memo((function(e){var t,n=e.input_date_range,r=e.current_focus,a=e.duration_list,c=e.onChange,s=e.setCurrentFocus,m=e.from,_=e.to,d=n||(null==a?void 0:a.find((function(e){return"all_time"===e.value}))),p=te(o().useState(m?(0,i.toMoment)(m).format("YYYY-MM-DD"):void 0),2),f=p[0],v=p[1],y=te(o().useState(_?(0,i.toMoment)(_).format("YYYY-MM-DD"):void 0),2),g=y[0],E=y[1],h=te(o().useState(!1),2),b=h[0],C=h[1],w=te(o().useState(d),2),x=w[0],N=w[1],k=te(o().useState(d),2),S=k[0],T=k[1],A=(0,i.toMoment)().format("YYYY-MM-DD"),O=function(e,t){var n=e.duration;c({from:t||n?(0,i.toMoment)().startOf("day").subtract(n,"day").add(1,"s"):void 0,to:(0,i.toMoment)().endOf("day"),is_batch:!0},{date_range:e})},D=function(e,t){var n,r;T({value:oe}),"from"===t&&v(null===(n=e.target)||void 0===n?void 0:n.value),"to"===t&&E(null===(r=e.target)||void 0===r?void 0:r.value)},z=function(e){T((null==a?void 0:a.find((function(t){return e&&t.value===e.value})))||e)};return o().createElement(o().Fragment,null,o().createElement("div",{className:"composite-calendar__input-fields composite-calendar__input-fields--fill"},o().createElement(l.InputField,{id:"dt_calendar_input",current_focus:null!=r?r:"",is_read_only:!0,icon:function(){return o().createElement(l.Icon,{icon:"IcCalendarDatefrom",className:"inline-icon"})},onClick:function(){T(x),C(!0)},setCurrentFocus:s,value:null!==(t=null==x?void 0:x.label)&&void 0!==t?t:""})),o().createElement(l.MobileDialog,{portal_element_id:"modal_root",title:(0,u.localize)("Please select duration"),visible:b,has_content_scroll:!0,onClose:function(){return C(!1)},content_height_offset:"94px",footer:o().createElement("div",{className:"composite-calendar-modal__actions"},o().createElement(l.Button,{className:"composite-calendar-modal__actions__cancel",text:(0,u.localize)("Cancel"),onClick:function(){return C(!1)},has_effect:!0,secondary:!0,large:!0}),o().createElement(l.Button,{className:"composite-calendar-modal__actions__ok",text:(0,u.localize)("OK"),onClick:function(){var e,t,n;null!=S&&S.onClick?O(S):(null==S?void 0:S.value)===oe&&(e=f||g||A,t=g||A,n=Object.assign(S,{label:"".concat((0,i.toMoment)(e).format("DD MMM YYYY")," - ").concat((0,i.toMoment)(t).format("DD MMM YYYY"))}),c({from:(0,i.toMoment)(e).startOf("day").add(1,"s"),to:(0,i.toMoment)(t).endOf("day"),is_batch:!0},{date_range:n})),N(S),C(!1)},has_effect:!0,primary:!0,large:!0}))},o().createElement("div",{className:"composite-calendar-modal"},o().createElement("div",{className:"composite-calendar-modal__radio-group"},null==a?void 0:a.map((function(e){return o().createElement(re,{id:"composite-calendar-modal__radio__".concat(e.value),key:e.value,value:e.value,label:e.label,selected_value:null==S?void 0:S.value,onChange:z})}))),o().createElement("div",{className:"composite-calendar-modal__custom"},o().createElement(re,{id:"composite-calendar-modal__custom-radio",className:"composite-calendar-modal__custom-radio",value:oe,label:(0,u.localize)("Custom"),selected_value:null==S?void 0:S.value,onChange:z}),o().createElement("div",{className:"composite-calendar-modal__custom-date-range"},o().createElement(l.DatePicker,{className:"composite-calendar-modal__custom-date-range-start-date",placeholder:(0,u.localize)("Start date"),value:null!=f?f:"",max_date:g||A,onChange:function(e){return D(e,"from")}}),o().createElement(l.DatePicker,{className:"composite-calendar-modal__custom-date-range-end-date",placeholder:(0,u.localize)("End date"),value:null!=g?g:"",max_date:A,min_date:f,onChange:function(e){return D(e,"to")}}))),o().createElement(l.Button,{className:"composite-calendar-modal__actions-today",text:(0,u.localize)("Back to today"),onClick:function(){var e={duration:0,label:(0,u.localize)("Today")};O(e,!0),N(e),T(e),C(!1)},has_effect:!0,tertiary:!0,large:!0}))))}));ae.displayName="CompositeCalendarMobile";const le=ae,ie=function(e){var t=e.onClick,n=e.is_active,r=e.label;return o().createElement("li",{className:h()({"composite-calendar__prepopulated-list--is-active":n}),onClick:t},r)},ce=function(e){var t=e.items,n=e.from,r=e.to;return o().createElement("ul",{className:"composite-calendar__prepopulated-list"},t.map((function(e){var t=e.duration,a=e.label,l=e.onClick,c=function(e,t,n){return 0===n?(0,i.toMoment)().endOf("day").unix()===t&&null===e:Math.ceil(t/86400)-Math.ceil(Number(e)/86400)===n}(n,r,t);return o().createElement(ie,{key:t,is_active:c,label:a,onClick:l})})))},se=function(e){var t=e.onClick;return o().createElement(l.Icon,{onClick:t,icon:"IcCalendarDatefrom",className:"inline-icon",data_testid:"dt_calendar_icon"})};function ue(){return ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ue.apply(null,arguments)}function me(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,l,i=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _e(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var de=ee()({loader:function(){return Promise.all([n.e("vendors-node_modules_moment_moment_js"),n.e("two-month-picker")]).then(n.bind(n,"./src/Components/Form/CompositeCalendar/two-month-picker.tsx"))},loading:function(){return null},render:function(e,t){var n=e.default;return o().createElement(n,t)}}),pe=(0,c.observer)((function(e){var t,n=(0,s.A)().ui,r=n.current_focus,a=n.setCurrentFocus,c=e.onChange,m=e.to,_=e.from,d=g().isDesktop,p=me(o().useState(!1),2),f=p[0],v=p[1],y=me(o().useState(!1),2),E=y[0],h=y[1],b=me(o().useState([{value:"all_time",label:(0,u.localize)("All time"),onClick:function(){return w()},duration:0},{value:"last_7_days",label:(0,u.localize)("Last 7 days"),onClick:function(){return w(7)},duration:7},{value:"last_30_days",label:(0,u.localize)("Last 30 days"),onClick:function(){return w(30)},duration:30},{value:"last_60_days",label:(0,u.localize)("Last 60 days"),onClick:function(){return w(60)},duration:60},{value:"last_quarter",label:(0,u.localize)("Last quarter"),onClick:function(){return w(90)},duration:90}]),1)[0],C=o().useRef(null),w=function(e){x(),c({from:e?(0,i.toMoment)().startOf("day").subtract(e,"day").add(1,"s"):void 0,to:(0,i.toMoment)().endOf("day"),is_batch:!0})},x=function(){h(!1),v(!1)},N=function(e){"from"===e&&h(!0),"to"===e&&v(!0)};return(0,l.useOnClickOutside)(C,(function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),x()}),(function(e){var t;return!(null!==(t=C.current)&&void 0!==t&&t.contains(e.target))})),d?o().createElement(o().Fragment,null,o().createElement("div",{id:"dt_composite_calendar_inputs",className:"composite-calendar__input-fields"},o().createElement(l.InputField,{id:"dt_calendar_input_from",current_focus:r,is_read_only:!0,placeholder:(0,u.localize)("Date from"),icon:se,onClick:function(){return N("from")},setCurrentFocus:a,value:(t=(0,i.toMoment)(_),_?t.format("MMM, DD YYYY"):"")}),o().createElement(l.InputField,{id:"dt_calendar_input_to",current_focus:r,is_read_only:!0,placeholder:(0,u.localize)("Date to"),icon:se,onClick:function(){return N("to")},setCurrentFocus:a,value:function(){var e=(0,i.toMoment)(m);return 0===(0,i.daysFromTodayTo)(e)?(0,u.localize)("Today"):e.format("MMM, DD YYYY")}()})),f&&o().createElement("div",{className:"composite-calendar",ref:C},o().createElement(ce,{from:_,to:m,items:b}),o().createElement(de,{value:m,onChange:function(e){c({to:(0,i.toMoment)(e).endOf("day")})},isPeriodDisabled:function(e){return e.unix()<_||e.unix()>(0,i.toMoment)().endOf("day").unix()}})),E&&o().createElement("div",{className:"composite-calendar",ref:C},o().createElement(ce,{from:_,to:m,items:b}),o().createElement(de,{value:_,onChange:function(e){c({from:(0,i.toMoment)(e)}),x()},isPeriodDisabled:function(e){return e.unix()>m}}))):o().createElement(le,ue({duration_list:b,setCurrentFocus:a,current_focus:r},e))}));pe.displayName="CompositeCalendar";const fe=o().memo(pe);var ve=function(e){var t=e.filter_component,n=e.className,r=e.is_statement;return o().createElement("div",{className:h()("reports__meta",n),"data-testid":"dt_reports_meta_wrapper"},t&&o().createElement("div",{className:h()("reports__meta-filter",{"reports__meta-filter--statement":r})},t))},ye=n("./src/Stores/useReportsStores.tsx"),ge=function(e){var t,n,r,a=null===(t=(0,i.extractInfoFromShortcode)(null==e?void 0:e.shortcode))||void 0===t||null===(n=t.category)||void 0===n?void 0:n.toString().toUpperCase();return(0,i.getUnsupportedContracts)()[a]?{component:o().createElement(u.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null===(r=(0,i.getUnsupportedContracts)()[a])||void 0===r?void 0:r.name}})}:(0,i.getContractPath)(Number(e.contract_id))},Ee=(0,c.observer)((function(e){var t=e.component_icon,n=(0,s.A)().client,r=(0,ye._)().profit_table,a=n.currency,c=n.is_switching,_=r.data,d=r.date_from,p=r.date_to,f=r.error,v=r.is_empty,y=r.is_loading,E=r.handleDateChange,b=r.handleScroll,C=r.has_selected_date,w=r.onMount,S=r.onUnmount,T=r.totals,A=(0,l.usePrevious)(d),O=(0,l.usePrevious)(p),D=g().isDesktop;if(o().useEffect((function(){return w(),m.Analytics.trackEvent("ce_reports_form",{action:"choose_report_type",form_name:"default",subform_name:"trade_table_form",start_date_filter:(0,i.formatDate)(d,"DD/MM/YYYY",!1),end_date_filter:(0,i.formatDate)(p,"DD/MM/YYYY",!1)}),function(){S()}}),[]),o().useEffect((function(){void 0!==A&&void 0!==O&&m.Analytics.trackEvent("ce_reports_form",{action:"filter_dates",form_name:"default",subform_name:"trade_table_form",start_date_filter:(0,i.formatDate)(d,"DD/MM/YYYY",!1),end_date_filter:(0,i.formatDate)(p,"DD/MM/YYYY",!1)})}),[p,d]),f)return o().createElement("p",null,f);var z=o().createElement(fe,{onChange:E,from:d,to:p}),M=function(e,t,n){return[{key:"icon",title:n?(0,u.localize)("Type"):"",col_index:"action_type",renderCellContent:function(e){var n=e.row_obj;return e.is_footer?(0,u.localize)("Profit/loss on the last {{item_count}} contracts",{item_count:t}):o().createElement(x,{key:n.transaction_id,payload:n})}},{title:(0,u.localize)("Ref. ID"),col_index:"transaction_id"},{title:(0,u.localize)("Currency"),col_index:"currency",renderCellContent:function(t){return t.is_footer?"":o().createElement(k,{currency:(0,i.getCurrencyDisplayCode)(e)})}},{title:(0,u.localize)("Buy time"),col_index:"purchase_time",renderCellContent:function(e){var t=e.cell_value;return e.is_footer?"":o().createElement("span",null,t," GMT")}},{title:(0,u.localize)("Stake"),col_index:"buy_price",renderCellContent:function(t){var n=t.cell_value;return t.is_footer?"":o().createElement(l.Money,{amount:n,currency:e})}},{title:(0,u.localize)("Sell time"),col_index:"sell_time",renderHeader:function(e){var t=e.title;return o().createElement("span",null,t)},renderCellContent:function(e){var t=e.cell_value;return e.is_footer?"":o().createElement("span",null,t," GMT")}},{title:(0,u.localize)("Contract value"),col_index:"sell_price",renderCellContent:function(t){var n=t.cell_value;return t.is_footer?"":o().createElement(l.Money,{amount:n,currency:e})}},{title:(0,u.localize)("Total profit/loss"),col_index:"profit_loss",renderCellContent:function(t){var n=t.cell_value;return o().createElement(N,{value:n},o().createElement(l.Money,{has_sign:!0,amount:n.replace(/[,]+/g,""),currency:e}))}}]}(a,_.length,D),L=Object.fromEntries(M.map((function(e){return[e.col_index,e]})));return o().createElement(o().Fragment,null,o().createElement(ve,{filter_component:z,className:"profit-table__filter"}),c?o().createElement(F,{is_loading:!0}):o().createElement(o().Fragment,null,0===_.length||v?o().createElement(F,{is_loading:y,has_selected_date:C,is_empty:v,empty_message_component:Y,component_icon:t,localized_message:(0,u.localize)("You have no trading activity yet."),localized_period_message:(0,u.localize)("You've made no transactions of this type during this period.")}):o().createElement("div",{className:"reports__content"},D?o().createElement(l.DataTable,{className:"profit-table",data_source:_,columns:M,onScroll:b,footer:T,getRowAction:ge,getRowSize:function(){return 63},content_loader:P},o().createElement(F,{is_loading:y})):o().createElement(l.DataList,{className:"profit-table",data_source:_,rowRenderer:function(e){var t=e.row,n=e.is_footer,r=null==t?void 0:t.duration_type,a=r?r[0].toUpperCase()+r.slice(1):"",i=r?"duration-type__".concat(r.toLowerCase()):"";return n?o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.action_type,is_footer:n}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:L.profit_loss,is_footer:n})):o().createElement(o().Fragment,null,o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.action_type}),o().createElement("div",{className:h()("duration-type",i)},o().createElement("div",{className:h()("duration-type__background","".concat(i,"__background"))}),o().createElement("span",{className:"".concat(i,"__label")},a))),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.transaction_id}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:L.currency})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.purchase_time}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:L.buy_price})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.sell_time}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:L.sell_price})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:L.profit_loss})))},getRowAction:ge,onScroll:b,footer:T,row_gap:8},o().createElement(F,{is_loading:y})))))}));const he=(0,J.withRouter)(Ee);var be=(0,c.observer)((function(){var e=(0,ye._)().statement,t=e.action_type,n=e.date_from,r=e.date_to,a=e.handleFilterChange,i=e.handleDateChange,c=[{text:(0,u.localize)("All transactions"),value:"all"},{text:(0,u.localize)("Buy"),value:"buy"},{text:(0,u.localize)("Sell"),value:"sell"},{text:(0,u.localize)("Deposit"),value:"deposit"},{text:(0,u.localize)("Withdrawal"),value:"withdrawal"},{text:(0,u.localize)("Transfer"),value:"transfer"}];return o().createElement(o().Fragment,null,o().createElement(fe,{onChange:i,from:n,to:r}),o().createElement(l.FilterDropdown,{dropdown_display_className:"dc-dropdown__display--has-suffix-icon",filter_list:c,handleFilterChange:a,initial_selected_filter:t}))}));const Ce=be;function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}var xe=function(e){var t=e.message,n=void 0===t?"":t,r=e.action_type,a=void 0===r?"":r,c=/:\s([0-9a-zA-Z]+.{25,28})/gm.exec(n.split(/,\s/)[0]),s=null==c?void 0:c[1],u=/:\s([0-9a-zA-Z]+.{25,34})/gm.exec(n.split(/,\s/)[1]),m=null==u?void 0:u[1],_=[n];if(s||m){var d=n.split(/,\s/);_=d.map((function(e,t){return(0,i.capitalizeFirstLetter)(t!==d.length-1?"".concat(e,", "):e)}))}return o().createElement(l.Text,{as:"div",size:"xs",className:"statement__row--detail-text",align:"center"},_.map((function(e,t){return o().createElement("div",{key:e},e,m&&t===_.length-1&&o().createElement(l.Clipboard,{text_copy:m,popoverAlignment:"top"}),s&&"withdrawal"===a&&t===_.length-1&&o().createElement(l.Clipboard,{text_copy:s,popoverAlignment:"top"}))})))},Ne=function(e){var t,n={},r=e.action_type,a=e.desc,l=e.id,c=e.is_sold,s=e.longcode,m=e.purchase_time,_=e.shortcode,d=e.transaction_time,p=e.withdrawal_details;if(l&&["buy","sell"].includes(r)){var f,v,y=null===(f=(0,i.extractInfoFromShortcode)(_))||void 0===f||null===(v=f.category)||void 0===v?void 0:v.toUpperCase(),g=(0,i.getUnsupportedContracts)()[y],E=(0,i.isForwardStarting)(_,m||d)&&!(0,i.hasForwardContractStarted)(_)&&"sell"!==r&&!c;n=g?{message:"",component:o().createElement(u.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null==g?void 0:g.name}})}:(0,i.getContractPath)(l),E&&(n={message:"",component:o().createElement(u.Localize,{i18n_default_text:"You'll see these details once the contract starts."})})}else"withdrawal"===r?n=p&&s?{message:"".concat(p," ").concat(s)}:{message:a}:a&&["deposit","transfer","adjustment","hold","release"].includes(r)&&(n={message:a});return"object"===we(n)&&null!==(t=n)&&void 0!==t&&t.message&&(n.component=o().createElement(xe,{message:n.message,action_type:r})),n},ke=(0,c.observer)((function(e){var t=e.component_icon,n=(0,s.A)(),r=n.client,a=n.common.current_language,c=(0,ye._)().statement,_=r.currency,d=r.is_switching,p=r.is_virtual,f=c.action_type,v=c.data,y=c.date_from,E=c.date_to,h=c.error,b=c.handleScroll,w=c.has_selected_date,N=c.is_empty,T=c.is_loading,A=c.onMount,O=c.onUnmount,D=(0,l.usePrevious)(f),z=(0,l.usePrevious)(y),M=(0,l.usePrevious)(E),L=g().isDesktop;if(o().useEffect((function(){return A(),m.Analytics.trackEvent("ce_reports_form",{action:"choose_report_type",form_name:"default",subform_name:"statement_form",transaction_type_filter:f,start_date_filter:(0,i.formatDate)(y,"DD/MM/YYYY",!1),end_date_filter:(0,i.formatDate)(E,"DD/MM/YYYY",!1)}),function(){O()}}),[]),o().useEffect((function(){D&&m.Analytics.trackEvent("ce_reports_form",{action:"filter_transaction_type",form_name:"default",subform_name:"statement_form",transaction_type_filter:f})}),[f]),o().useEffect((function(){void 0!==z&&void 0!==M&&m.Analytics.trackEvent("ce_reports_form",{action:"filter_dates",form_name:"default",subform_name:"statement_form",start_date_filter:(0,i.formatDate)(y,"DD/MM/YYYY",!1),end_date_filter:(0,i.formatDate)(E,"DD/MM/YYYY",!1)})}),[E,y]),h)return o().createElement("p",null,h);var I=function(e,t){return[{key:"icon",title:t?(0,u.localize)("Type"):"",col_index:"icon",renderCellContent:function(e){var t=e.passthrough,n=e.row_obj,r=t.isTopUp(n)?"icCashierTopUp":null;return o().createElement(x,{icon:r,key:n.transaction_id,payload:n})}},{title:(0,u.localize)("Ref. ID"),col_index:"refid",renderCellContent:function(e){var t=e.cell_value,n=e.row_obj;return o().createElement(l.Popover,{alignment:"top",message:(0,u.localize)("Transaction performed by (App ID: {{app_id}})",{app_id:n.app_id})},t)}},{title:(0,u.localize)("Currency"),col_index:"currency",renderCellContent:function(){return o().createElement(k,{currency:(0,i.getCurrencyDisplayCode)(e)})}},{title:(0,u.localize)("Transaction time"),col_index:"date",renderCellContent:function(e){var t=e.cell_value;return o().createElement("span",null,t," GMT")}},{key:"mode",title:(0,u.localize)("Transaction"),col_index:"action_type",renderCellContent:function(e){var t,n=e.cell_value,r=e.passthrough,a=e.row_obj;return o().createElement(l.Label,{mode:(t=n,S[t]||S.default)},r.isTopUp(a)&&(0,u.localize)("Top up")||a.action)}},{title:(0,u.localize)("Credit/Debit"),col_index:"amount",renderCellContent:function(t){var n=t.cell_value;return o().createElement("div",{className:"amount--".concat(C(n))},o().createElement(l.Money,{has_sign:!0,amount:n.replace(/[,]+/g,""),currency:e}))}},{title:(0,u.localize)("Balance"),col_index:"balance",renderCellContent:function(t){var n=t.cell_value;return o().createElement(l.Money,{amount:n.replace(/[,]+/g,""),currency:e})}}]}(_,L),j=I.reduce((function(e,t){return e[t.col_index]=t,e}),{});return o().createElement(o().Fragment,null,o().createElement(ve,{className:"reports__meta--statement",filter_component:o().createElement(Ce,null),is_statement:!0,key:a}),d?o().createElement(F,{is_loading:!0}):o().createElement(o().Fragment,null,0===(null==v?void 0:v.length)||N?o().createElement(F,{is_loading:T,has_selected_date:w,is_empty:N,empty_message_component:Y,component_icon:t,localized_message:(0,u.localize)("You have no transactions yet."),localized_period_message:(0,u.localize)("You've made no transactions of this type during this period.")}):o().createElement("div",{className:"reports__content"},L?o().createElement(l.DataTable,{className:"statement",columns:I,content_loader:P,data_source:v,getRowAction:Ne,onScroll:b,passthrough:{isTopUp:function(e){return p&&"Deposit"===e.action}}},o().createElement(F,{is_loading:T})):o().createElement(l.DataList,{className:"statement",data_source:v,getRowAction:Ne,onScroll:b,rowRenderer:function(e){var t=e.row,n=e.passthrough;return o().createElement(o().Fragment,null,o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:j.icon,passthrough:n}),o().createElement(l.DataList.Cell,{row:t,column:j.action_type,passthrough:n})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:j.refid}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:j.currency})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:j.date}),o().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:j.amount})),o().createElement("div",{className:"data-list__row"},o().createElement(l.DataList.Cell,{row:t,column:j.balance})))},row_gap:8,passthrough:{isTopUp:function(e){return p&&"Deposit"===e.action}}},o().createElement(F,{is_loading:T})))))}));const Se={OpenPositions:X,ProfitTable:he,Statement:(0,a.withRouter)(ke),Reports:(0,c.observer)((function(e){var t,n=e.history,r=e.location,a=e.routes,c=(0,s.A)(),_=c.client,d=c.common,p=c.ui,f=_.is_logged_in,v=_.is_logging_in,y=d.is_from_derivgo,E=d.routeBackInApp,h=p.is_reports_visible,b=p.setReportsTabIndex,C=p.reports_route_tab_index,w=p.toggleReports,x=g().isDesktop;o().useEffect((function(){return m.Analytics.trackEvent("ce_reports_form",{action:"open",form_name:"default",subform_name:n.location.pathname.split("/")[2],form_source:"deriv_trader"}),w(!0),function(){w(!1),m.Analytics.trackEvent("ce_reports_form",{action:"close",form_name:"default",subform_name:r.pathname.split("/")[2]})}}),[]);var N=function(){var e=[];return a.forEach((function(t){e.push({default:t.default,icon:t.icon_component,label:t.getTitle(),value:t.component,path:t.path})})),e},k=(0,i.getSelectedRoute)({routes:a,pathname:r.pathname});return!f&&v?o().createElement(l.Loading,{is_fullscreen:!0}):o().createElement(l.FadeWrapper,{is_visible:h,className:"reports-page-wrapper",keyname:"reports-page-wrapper"},o().createElement("div",{className:"reports"},o().createElement(l.PageOverlay,{header:(0,u.localize)("Reports"),onClickClose:function(){sessionStorage.removeItem("open_positions_filter"),E(n)},is_from_app:y},x?o().createElement(l.VerticalTab,{is_floating:!0,current_path:r.pathname,is_routed:!0,is_full_width:!0,setVerticalTabIndex:b,vertical_tab_index:k.default?0:C,list:N()}):o().createElement(l.Div100vhContainer,{className:"reports__mobile-wrapper",height_offset:"80px"},o().createElement(l.SelectNative,{className:"reports__route-selection",list_items:N().map((function(e){var t;return{text:e.label,value:null!==(t=e.path)&&void 0!==t?t:""}})),value:null!==(t=k.path)&&void 0!==t?t:"",should_show_empty_option:!1,onChange:function(e){return n.push(e.target.value)},label:"",hide_top_placeholder:!1}),(null==k?void 0:k.component)&&o().createElement(k.component,{icon_component:k.icon_component})))))}))}},"../../node_modules/classnames/index.js":(e,t)=>{var n;!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=l(e,a(n)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)r.call(e,n)&&e[n]&&(t=l(t,n));return t}function l(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0===(n=function(){return o}.apply(t,[]))||(e.exports=n)}()}}]);