/*! For license information please see trader.trader-app-v2.bae6f5f000fa003d8c4b.js.LICENSE.txt */
"use strict";(self.webpackChunk_deriv_trader=self.webpackChunk_deriv_trader||[]).push([["trader-app-v2"],{"./src/AppV2/index.tsx":(e,t,r)=>{r.r(t),r.d(t,{default:()=>km});var n=r("react"),o=r.n(n),a=r("./src/App/init-store.ts"),i=r("@deriv/shared"),l=r("./src/Stores/Providers/modules-providers.tsx"),c=r("./src/trader-providers.tsx"),s=r("../stores/src/useStore.ts"),u=r("../../node_modules/lodash.debounce/index.js"),d=r.n(u),f=r("mobx");function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(e){var t=(0,i.toMoment)().startOf("day").unix();return e&&t>e?e:(0,i.epochToMoment)(t).add(1,"d").subtract(1,"s").unix()},h=function(e,t,r,n){var o=(0,i.toMoment)().startOf("day").unix();return n&&o>n?r:e&&t?t:r};const b=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return y(y({},function(e,t,r,n){var o=(0,i.toMoment)().startOf("day").unix();return n&&o>n?!!e||t:t?r||e:!!e||!1}(e,n,r,t)&&{date_from:h(n,r,e,t)}),(t||n)&&{date_to:v(t)})};function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){w(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function w(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A(e)}function O(){O=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new P(n||[]);return o(i,"_invoke",{value:C(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(N([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==A(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function C(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=j(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function j(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function N(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(A(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},k(x.prototype),s(x.prototype,l,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:N(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function k(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function x(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){k(a,n,o,i,l,"next",e)}function l(e){k(a,n,o,i,l,"throw",e)}i(void 0)}))}}function C(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return(t=P(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,P(n.key),n)}}function P(e){var t=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=A(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==A(t)?t:t+""}var N=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validation_errors={},this.validation_rules={},this.preSwitchAccountDisposer=null,this.pre_switch_account_listener=null,this.switchAccountDisposer=null,this.switch_account_listener=null,this.logoutDisposer=null,this.logout_listener=null,this.clientInitDisposer=null,this.client_init_listener=null,this.networkStatusChangeDisposer=null,this.network_status_change_listener=null,this.themeChangeDisposer=null,this.theme_change_listener=null,this.realAccountSignupEndedDisposer=null,this.real_account_signup_ended_listener=null,this.partial_fetch_time=0,(0,f.makeObservable)(this,{validation_errors:f.observable,validation_rules:f.observable,partial_fetch_time:f.observable,retrieveFromStorage:f.action,setValidationErrorMessages:f.action,setValidationRules:f.action,addRule:f.action,validateProperty:f.action,validateAllProperties:f.action,onSwitchAccount:f.action.bound,onPreSwitchAccount:f.action.bound,onLogout:f.action.bound,onClientInit:f.action.bound,onNetworkStatusChange:f.action.bound,onThemeChange:f.action.bound,onRealAccountSignupEnd:f.action.bound,disposePreSwitchAccount:f.action.bound,disposeSwitchAccount:f.action.bound,disposeLogout:f.action.bound,disposeClientInit:f.action.bound,disposeNetworkStatusChange:f.action.bound,disposeThemeChange:f.action.bound,disposeRealAccountSignupEnd:f.action.bound,onUnmount:f.action.bound,assertHasValidCache:f.action.bound});var n=r.root_store,o=r.local_storage_properties,a=r.session_storage_properties,i=r.validation_rules,l=r.store_name;if(Object.defineProperty(this,"root_store",{enumerable:!1,writable:!0}),Object.defineProperty(this,"local_storage_properties",{enumerable:!1,writable:!0}),Object.defineProperty(this,"session_storage_properties",{enumerable:!1,writable:!0}),o&&o.length||a&&a.length){if(!l)throw new Error("store_name is required for local/session storage");Object.defineProperty(this,"store_name",{value:l,enumerable:!1,writable:!1})}this.root_store=n,this.local_storage_properties=o||[],this.session_storage_properties=a||[],setTimeout((function(){t.setValidationRules(i),t.setupReactionForLocalStorage(),t.setupReactionForSessionStorage(),t.retrieveFromStorage()}),0)}return t=e,r=[{key:"getSnapshot",value:function(e){var t=(0,f.toJS)(this);return(0,i.isEmptyObject)(this.root_store)||(t.root_store=this.root_store),e&&e.length&&(t=e.reduce((function(e,r){return Object.assign(e,T({},r,t[r]))}),{})),t}},{key:"setupReactionForLocalStorage",value:function(){var t=this;this.local_storage_properties.length&&(0,f.reaction)((function(){return t.local_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.local_storage_properties,e.STORAGES.LOCAL_STORAGE)}))}},{key:"setupReactionForSessionStorage",value:function(){var t=this;this.session_storage_properties.length&&(0,f.reaction)((function(){return t.session_storage_properties.map((function(e){return t[e]}))}),(function(){return t.saveToStorage(t.session_storage_properties,e.STORAGES.SESSION_STORAGE)}))}},{key:"saveToStorage",value:function(t,r){var n=JSON.stringify(this.getSnapshot(t),(function(e,t){if(null!==t)return t}));r===e.STORAGES.LOCAL_STORAGE?localStorage.setItem(this.store_name,n):r===e.STORAGES.SESSION_STORAGE&&sessionStorage.setItem(this.store_name,n)}},{key:"retrieveFromStorage",value:function(){var e=this,t=JSON.parse(localStorage.getItem(this.store_name,{})),r=JSON.parse(sessionStorage.getItem(this.store_name,{})),n=j(j({},t),r);Object.keys(n).forEach((function(t){return e[t]=n[t]}))}},{key:"setValidationErrorMessages",value:function(e,t){var r=this;this.validation_errors[e]&&!r.validation_errors[e].filter((function(e){return!t.includes(e)})).concat(t.filter((function(t){return!r.validation_errors[e].includes(t)}))).length||(this.validation_errors[e]=t)}},{key:"setValidationRules",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(t).forEach((function(r){e.addRule(r,t[r])}))}},{key:"addRule",value:function(e,t){var r=this;this.validation_rules[e]=t,(0,f.intercept)(this,e,(function(t){return r.validateProperty(e,t.newValue),t}))}},{key:"validateProperty",value:function(e,t){var r=this,n=this.validation_rules[e].trigger,o=T({},e,void 0!==t?t:this[e]),a=T({},e,this.validation_rules[e].rules||[]);n&&Object.hasOwnProperty.call(this,n)&&(o[n]=this[n],a[n]=this.validation_rules[n].rules||[]);var l=new i.Validator(o,a,this);l.isPassed(),Object.keys(o).forEach((function(e){r.setValidationErrorMessages(e,l.errors.get(e))}))}},{key:"validateAllProperties",value:function(){var e=this,t=Object.keys(this.validation_rules),r=Object.keys(this.validation_errors);t.forEach((function(t){e.validateProperty(t,e[t])})),r.forEach((function(r){t.includes(r)||delete e.validation_errors[r]}))}},{key:"onSwitchAccount",value:function(e){var t=this;e&&(this.switch_account_listener=e,this.switchAccountDisposer=(0,f.when)((function(){return t.root_store.client.switch_broadcast}),(function(){try{var e=t.switch_account_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Switching account listeners are required to return a promise.");e.then((function(){t.root_store.client.switchEndSignal(),t.onSwitchAccount(t.switch_account_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})))}},{key:"onPreSwitchAccount",value:function(e){var t=this;e&&(this.pre_switch_account_listener=e,this.preSwitchAccountDisposer=(0,f.when)((function(){return t.root_store.client.pre_switch_broadcast}),(function(){try{var e,r=null===(e=t.pre_switch_account_listener)||void 0===e?void 0:e.call(t);if(!r||!r.then||"function"!=typeof r.then)throw new Error("Pre-switch account listeners are required to return a promise.");r.then((function(){t.root_store.client.setPreSwitchAccount(!1),t.onPreSwitchAccount(t.pre_switch_account_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})))}},{key:"onLogout",value:function(e){var t=this;this.logoutDisposer=(0,f.when)((function(){return t.root_store.client.has_logged_out}),x(O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.logout_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){t.root_store.client.setLogout(!1),t.onLogout(t.logout_listener)})),e.next=7;break;case 6:throw new Error("Logout listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.logout_listener=e}},{key:"onClientInit",value:function(e){var t=this;this.clientInitDisposer=(0,f.when)((function(){return t.root_store.client.initialized_broadcast}),x(O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(r=t.client_init_listener())||!r.then||"function"!=typeof r.then){e.next=6;break}r.then((function(){t.root_store.client.setInitialized(!1),t.onClientInit(t.client_init_listener)})),e.next=7;break;case 6:throw new Error("Client init listeners are required to return a promise.");case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),(0,i.isProduction)()||console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))),this.client_init_listener=e}},{key:"onNetworkStatusChange",value:function(e){var t=this;this.networkStatusChangeDisposer=(0,f.reaction)((function(){return t.root_store.common.is_network_online}),(function(e){try{t.network_status_change_listener(e)}catch(e){(0,i.isProduction)()||console.error(e)}})),this.network_status_change_listener=e}},{key:"onThemeChange",value:function(e){var t=this;this.themeChangeDisposer=(0,f.reaction)((function(){return t.root_store.ui.is_dark_mode_on}),(function(e){try{t.theme_change_listener(e)}catch(e){(0,i.isProduction)()||console.error(e)}})),this.theme_change_listener=e}},{key:"onRealAccountSignupEnd",value:function(e){var t=this;this.realAccountSignupEndedDisposer=(0,f.when)((function(){return t.root_store.ui.has_real_account_signup_ended}),(function(){try{var e=t.real_account_signup_ended_listener();if(!e||!e.then||"function"!=typeof e.then)throw new Error("Real account signup listeners are required to return a promise.");e.then((function(){t.root_store.ui.setRealAccountSignupEnd(!1),t.onRealAccountSignupEnd(t.real_account_signup_ended_listener)}))}catch(e){(0,i.isProduction)()||console.error(e)}})),this.real_account_signup_ended_listener=e}},{key:"disposePreSwitchAccount",value:function(){"function"==typeof this.preSwitchAccountDisposer&&this.preSwitchAccountDisposer(),this.pre_switch_account_listener=null}},{key:"disposeSwitchAccount",value:function(){"function"==typeof this.switchAccountDisposer&&this.switchAccountDisposer(),this.switch_account_listener=null}},{key:"disposeLogout",value:function(){"function"==typeof this.logoutDisposer&&this.logoutDisposer(),this.logout_listener=null}},{key:"disposeClientInit",value:function(){"function"==typeof this.clientInitDisposer&&this.clientInitDisposer(),this.client_init_listener=null}},{key:"disposeNetworkStatusChange",value:function(){"function"==typeof this.networkStatusChangeDisposer&&this.networkStatusChangeDisposer(),this.network_status_change_listener=null}},{key:"disposeThemeChange",value:function(){"function"==typeof this.themeChangeDisposer&&this.themeChangeDisposer(),this.theme_change_listener=null}},{key:"disposeRealAccountSignupEnd",value:function(){"function"==typeof this.realAccountSignupEndedDisposer&&this.realAccountSignupEndedDisposer(),this.real_account_signup_ended_listener=null}},{key:"onUnmount",value:function(){this.disposePreSwitchAccount(),this.disposeSwitchAccount(),this.disposeLogout(),this.disposeClientInit(),this.disposeNetworkStatusChange(),this.disposeThemeChange(),this.disposeRealAccountSignupEnd()}},{key:"assertHasValidCache",value:function(e){if(this.root_store.client.loginid!==e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach((function(e){return e()})),this.partial_fetch_time=!1}}}],r&&L(t.prototype,r),n&&L(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function D(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return M(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function z(){z=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==I(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(I(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e,t,r){return(t=H(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function B(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){q(a,n,o,i,l,"next",e)}function l(e){q(a,n,o,i,l,"throw",e)}i(void 0)}))}}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,H(n.key),n)}}function H(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}function G(e,t,r){return t=W(t),function(e,t){if(t&&("object"==I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Y()?Reflect.construct(t,r||[],W(e).constructor):t.apply(e,r))}function Y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Y=function(){return!!e})()}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function $(e,t){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},$(e,t)}N.STORAGES=Object.freeze({LOCAL_STORAGE:Symbol("LOCAL_STORAGE"),SESSION_STORAGE:Symbol("SESSION_STORAGE")});var K=function(e){function t(e){var r,n=e.root_store;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=G(this,t,[{root_store:n}])).data=[],r.date_from=null,r.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),r.error="",r.has_loaded_all=!1,r.is_loading=!0,r.filtered_date_range=void 0,r.client_loginid="",r.fetchOnScroll=d()((function(e,t){e<1500&&r.fetchNextBatch(t)}),150),(0,f.makeObservable)(r,{data:f.observable,date_from:f.observable,date_to:f.observable,error:f.observable,has_loaded_all:f.observable,is_loading:f.observable,filtered_date_range:f.observable,client_loginid:f.observable,is_empty:f.computed,has_selected_date:f.computed,fetchNextBatch:f.action.bound,profitTableResponseHandler:f.action.bound,handleScroll:f.action.bound,networkStatusChangeListener:f.action.bound,onMount:f.action.bound,onUnmount:f.override,totals:f.computed,accountSwitcherListener:f.action.bound,clearTable:f.action.bound,clearDateFilter:f.action.bound,handleDateChange:f.action.bound}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(t,e),r=t,n=[{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"shouldFetchNextBatch",value:function(e){return!!e||!this.has_loaded_all&&!this.is_loading}},{key:"fetchNextBatch",value:(l=B(z().mark((function e(t,r){var n,o,a,l,c;return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shouldFetchNextBatch(r)){e.next=2;break}return e.abrupt("return");case 2:return this.is_loading=!0,a=b(this.date_from,this.date_to,0,!1),l=t?F(F({},b(null===(n=this.root_store.modules.positions)||void 0===n?void 0:n.dateFrom,null===(o=this.root_store.modules.positions)||void 0===o?void 0:o.dateTo,0,!1)),{},{contract_type:this.root_store.modules.positions.filteredContractTypes}):a,e.next=7,i.WS.profitTable(50,this.data.length,l);case 7:c=e.sent,this.profitTableResponseHandler(c);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"profitTableResponseHandler",value:function(e){var t=this;if("error"in e)this.error=e.error.message;else{var r=e.profit_table.transactions.map((function(e){return function(e,t){var r,n,o,a,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c="DD MMM YYYY HH:mm:ss",s=e.purchase_time&&"".concat((0,i.toMoment)(Number(e.purchase_time)).format(c)),u=e.purchase_time,d=e.sell_time&&"".concat((0,i.toMoment)(Number(e.sell_time)).format(c)),f=null!==(r=e.payout)&&void 0!==r?r:NaN,m=null!==(n=e.sell_price)&&void 0!==n?n:NaN,p=null!==(o=e.buy_price)&&void 0!==o?o:NaN,y=(0,i.formatMoney)(t,Number(m-p),!0),_=(0,i.getSymbolDisplayName)(l,(0,i.getMarketInformation)(null!==(a=e.shortcode)&&void 0!==a?a:"").underlying);return S(S({},e),{payout:f,sell_price:m,buy_price:p,profit_loss:y,sell_time:d,purchase_time:s,display_name:_,purchase_time_unix:u})}(e,t.root_store.client.currency,t.root_store.active_symbols.active_symbols)})).filter(i.filterDisabledPositions);this.data=[].concat(D(this.data),D(r)),this.has_loaded_all=r.length<50,this.is_loading=!1}}},{key:"handleScroll",value:function(e,t){var r=e.target,n=r.scrollTop,o=r.scrollHeight-(n+r.clientHeight);this.fetchOnScroll(o,t)}},{key:"networkStatusChangeListener",value:function(e){this.is_loading=this.is_loading||!e}},{key:"onMount",value:(a=B(z().mark((function e(t){return z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,i.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),e.next=6,i.WS.wait("authorize");case 6:this.fetchNextBatch(t,!0);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),i.WS.forgetAll("proposal")}},{key:"totals",get:function(){var e=0;return this.data.forEach((function(t){e+=parseFloat(t.profit_loss.replace(/,/g,""))})),{profit_loss:e.toString()}}},{key:"accountSwitcherListener",value:function(){var e=this;return new Promise((function(t){return e.clearTable(),e.clearDateFilter(),t(e.fetchNextBatch())}))}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix()}},{key:"handleDateChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.date_range,n=t.shouldFilterContractTypes,o=e.from,a=e.to,l=e.is_batch;this.filtered_date_range=r,o?this.date_from=(0,i.toMoment)(o).unix():l&&(this.date_from=null),a&&(this.date_to=(0,i.toMoment)(a).unix()),n&&(this.root_store.modules.positions.setDateFrom(this.date_from),this.root_store.modules.positions.setDateTo(this.date_to)),this.clearTable(),this.fetchNextBatch(n)}}],n&&V(r.prototype,n),o&&V(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a,l}(N),J=r("@deriv/translations");function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=X(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==X(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ee=function(e,t){var r,n,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=e.action_type,c=e.app_id,s=e.contract_id,u=e.longcode,d=e.purchase_time,f=e.withdrawal_details,m=(0,i.toMoment)(e.transaction_time).format("DD MMM YYYY HH:mm:ss"),p=null!==(r=e.payout)&&void 0!==r?r:NaN,y=null!==(n=e.amount)&&void 0!==n?n:NaN,_=null!==(o=e.balance_after)&&void 0!==o?o:NaN,v=!0,h=["buy","sell"].includes(null!=l?l:"")?e.shortcode:null,b=h?(0,i.getSymbolDisplayName)(a,(0,i.getMarketInformation)(h).underlying):"";return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({action:(0,J.localize)((0,i.toTitleCase)(null!=l?l:"")),date:m,display_name:b,refid:e.transaction_id,payout:isNaN(p)?"-":(0,i.formatMoney)(t,p,v),amount:isNaN(y)?"-":(0,i.formatMoney)(t,y,v),balance:isNaN(_)?"-":(0,i.formatMoney)(t,_,v),desc:null==u?void 0:u.replace(/\n/g,"<br />"),id:s,app_id:c,shortcode:h,action_type:l,purchase_time:d,transaction_time:e.transaction_time},f&&{withdrawal_details:f,longcode:u})};function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function re(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function oe(){oe=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==te(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(te(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function ae(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){ae(a,n,o,i,l,"next",e)}function l(e){ae(a,n,o,i,l,"throw",e)}i(void 0)}))}}function le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ce(n.key),n)}}function ce(e){var t=function(e,t){if("object"!=te(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==te(t)?t:t+""}function se(e,t,r){return t=de(t),function(e,t){if(t&&("object"==te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ue()?Reflect.construct(t,r||[],de(e).constructor):t.apply(e,r))}function ue(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ue=function(){return!!e})()}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}function fe(e,t){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fe(e,t)}var me=function(e){function t(e){var r,n=e.root_store;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=se(this,t,[{root_store:n}])).data=[],r.is_loading=!0,r.has_loaded_all=!1,r.date_from=null,r.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),r.error="",r.action_type="all",r.filtered_date_range=void 0,r.client_loginid="",r.account_statistics={},r.fetchOnScroll=d()((function(e){e<1500&&r.fetchNextBatch()}),150),(0,f.makeObservable)(r,{data:f.observable,is_loading:f.observable,has_loaded_all:f.observable,date_from:f.observable,date_to:f.observable,error:f.observable,action_type:f.observable,filtered_date_range:f.observable,client_loginid:f.observable,account_statistics:f.observable,is_empty:f.computed,has_selected_date:f.computed,clearTable:f.action.bound,clearDateFilter:f.action.bound,fetchNextBatch:f.action.bound,statementHandler:f.action.bound,handleDateChange:f.action.bound,handleFilterChange:f.action.bound,handleScroll:f.action.bound,accountSwitcherListener:f.action.bound,networkStatusChangeListener:f.action.bound,onMount:f.action.bound,onUnmount:f.override}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(t,e),r=t,n=[{key:"is_empty",get:function(){return!this.is_loading&&0===this.data.length}},{key:"has_selected_date",get:function(){return!(!this.date_from&&!this.date_to)}},{key:"clearTable",value:function(){this.data=[],this.has_loaded_all=!1,this.is_loading=!1}},{key:"clearDateFilter",value:function(){this.date_from=null,this.date_to=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix(),this.partial_fetch_time=0}},{key:"shouldFetchNextBatch",value:function(e){if(!e&&(this.has_loaded_all||this.is_loading))return!1;var t=(0,i.toMoment)().startOf("day").add(1,"d").subtract(1,"s").unix();return!(this.date_to<t)||!e&&this.partial_fetch_time}},{key:"fetchNextBatch",value:(l=ie(oe().mark((function e(){var t,r,n,o=arguments;return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],this.shouldFetchNextBatch(t)){e.next=3;break}return e.abrupt("return");case 3:return this.is_loading=!0,r=b(this.date_from,this.date_to,this.partial_fetch_time,t),"all"!==this.action_type&&(r.action_type=this.action_type),e.next=8,i.WS.statement(100,t?void 0:this.data.length,r);case 8:n=e.sent,this.statementHandler(n,t);case 10:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"statementHandler",value:function(e,t){var r=this;if("error"in e)this.error=e.error.message;else{var n=e.statement.transactions.map((function(e){return ee(e,r.root_store.client.currency,r.root_store.active_symbols.active_symbols)})).filter(i.filterDisabledPositions);this.data=t?[].concat(re(n),re(this.data)):[].concat(re(this.data),re(n)),this.has_loaded_all=!t&&n.length<100,this.is_loading=!1,n.length>0&&(this.partial_fetch_time=(0,i.toMoment)().unix())}}},{key:"handleDateChange",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).date_range,r=e.from,n=e.to,o=e.is_batch;this.filtered_date_range=t,r?this.date_from=(0,i.toMoment)(r).unix():o&&(this.date_from=null),n&&(this.date_to=(0,i.toMoment)(n).unix()),this.clearTable(),this.fetchNextBatch()}},{key:"handleFilterChange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action_type=e,this.clearTable(),this.fetchNextBatch()}},{key:"handleScroll",value:function(e){var t=e.target,r=t.scrollTop,n=t.scrollHeight-(r+t.clientHeight);this.fetchOnScroll(n)}},{key:"accountSwitcherListener",value:function(){var e=this;return new Promise((function(t){return e.clearTable(),e.clearDateFilter(),t(e.fetchNextBatch())}))}},{key:"networkStatusChangeListener",value:function(e){this.is_loading=this.is_loading||!e}},{key:"onMount",value:(a=ie(oe().mark((function e(){return oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertHasValidCache(this.client_loginid,this.clearDateFilter,this.client_loginid?this.clearTable:function(){return null},i.WS.forgetAll.bind(null,"proposal")),this.client_loginid=this.root_store.client.loginid,this.onSwitchAccount(this.accountSwitcherListener),this.onNetworkStatusChange(this.networkStatusChangeListener),e.next=6,i.WS.wait("authorize");case 6:this.fetchNextBatch(!0);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"onUnmount",value:function(){this.disposeSwitchAccount(),i.WS.forgetAll("proposal")}}],n&&le(r.prototype,n),o&&le(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,a,l}(N),pe=o().createContext(null),ye=function(e){var t=e.children,r=(0,s.A)(),n=o().useMemo((function(){return{profit_table:new K({root_store:r}),statement:new me({root_store:r})}}),[r]);return o().createElement(pe.Provider,{value:n},t)},_e=r("../../node_modules/@deriv-com/quill-ui/dist/providers/notification/notificationsProvider.js"),ve=r("../../node_modules/@deriv-com/quill-ui/dist/providers/snackbar/snackbarProvider.js"),he=r("mobx-react-lite"),be=r("../../node_modules/@deriv-com/quill-ui/dist/hooks/useNotifications/index.js"),ge=r("../../node_modules/@deriv-com/quill-ui/dist/components/Notification/banners/index.js"),Ee=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneFlagCheckeredFillIcon.js"),Se=r("react-router-dom");function we(e){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we(e)}function Ae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=we(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=we(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==we(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ke=(0,he.observer)((function(){var e=(0,be.E)(),t=e.addBanner,r=e.banners,n=e.removeBanner,a=(0,s.A)().portfolio.setAddNotificationBannerCallback,l=(0,Se.useLocation)().pathname;return o().useEffect((function(){r.length>1&&n(r[0].id),l!==i.routes.trade&&r.forEach((function(e){var t=e.type,r=e.id;t||n(r)}))}),[r,l]),o().useEffect((function(){return a((function(e,r){return t(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({icon:o().createElement(Ee.A,{iconSize:"sm",className:"trade-notification--".concat(r),key:"contract-closed"})},e))})),function(){return a()}}),[]),o().createElement(ge.$,{autohideTimeout:4e3,banners:r,className:"trade-notification",isMobile:!0,onClose:n,zIndex:100})}));const xe=ke;var Ce=r("@deriv/components"),je=r("../../node_modules/clsx/dist/clsx.mjs"),Te=r("../utils/src/index.ts");function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ne=function(e,t){var r,n,a=Le(o().useState(null!==(r=null!==(n=(0,Te.Lg)(e))&&void 0!==n?n:t)&&void 0!==r?r:null),2),i=a[0],l=a[1];o().useEffect((function(){localStorage.setItem(e,JSON.stringify(i))}),[e,i]);return[i,l,function(){localStorage.removeItem(e),l(null!=t?t:null)}]};var Ie=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/text/index.js"),De=r("../../node_modules/@deriv-com/quill-ui/dist/snackbar-controller-ChcV5SXl.js"),Me=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronUpSmBoldIcon.js"),ze=r("./src/Stores/useTraderStores.tsx");function Re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ue=function(e){var t,r=e.rows,a=e.animation_class,i=e.is_moving_transaction,l=e.className,c=Re((0,n.useState)(0),2),s=c[0],u=c[1];return(0,n.useEffect)((function(){u((function(e){return e+1}))}),[a]),o().createElement(o().Fragment,null,o().createElement("div",{className:"".concat(l,"__stat")},o().createElement(Ie.E,{size:"sm",bold:!0,className:a,"data-testid":"accumulator-first-stat",color:"quill-typography__color--prominent",key:s},r[0])),null===(t=r.slice(1))||void 0===t?void 0:t.map((function(e,t){return o().createElement("div",{key:t+1,className:(0,je.A)("".concat(l,"__stat"),{"slide-right":i&&0==t})},o().createElement(Ie.E,{size:"sm"},e))})))};var qe=r("./src/Modules/Trading/Helpers/video-config.ts"),Be=r("../../node_modules/@deriv-com/quill-ui/dist/components/Loader/skeleton/index.js"),Ve=r("./src/AppV2/Utils/trade-params-utils.tsx"),He=136,Ge=30,Ye=56,We=56,$e=40,Ke=24,Je=.5625,Xe=function(e){var t,r,n=e.component_key,o=e.contract_type,a=e.has_cancellation,i=e.symbol;return n in(null!==(t=null===(r=(0,Ve.LL)(i,a))||void 0===r?void 0:r[o])&&void 0!==t?t:{})},Ze=function(e){var t=e.contract_type,r=e.has_cancellation,n=e.is_accumulator,o=e.symbol,a=window.innerHeight-$e-Ye-He-Ke,i=function(e){return Xe({component_key:e,symbol:o,has_cancellation:r,contract_type:t})};return n?a-We:i("expiration")||i("mult_info_display")||i("payout_per_point_info")||i("allow_equals")||i("payout")?a-Ge:a},Qe="InsufficientBalance",et="AuthorizationRequired",tt="PleaseAuthenticate",rt="PendingVerification",nt="CompanyWideLimitExceeded",ot=function(e){var t=e.services_error,r=e.is_mf_verification_pending_modal_visible,n=t||{},o=n.code,a=n.type;return o===Qe||o===et&&"buy"===a||o===tt||!!r},at=["autoplay","controls","letterbox_color","loop","muted","preload","src","test_id","title"];function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},it.apply(null,arguments)}function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ct(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ct(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const st=function(e){var t=e.autoplay,r=void 0===t||t,n=e.controls,a=void 0!==n&&n,i=e.letterbox_color,l=void 0===i?"transparent":i,c=e.loop,s=void 0===c||c,u=e.muted,d=void 0===u||u,f=e.preload,m=void 0===f?"auto":f,p=e.src,y=e.test_id,_=e.title,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,at),h=lt(o().useState(!0),2),b=h[0],g=h[1],E=["letterboxColor=".concat(encodeURIComponent(l)),"muted=".concat(d),"preload=".concat(m),"loop=".concat(s),"autoplay=".concat(r),"controls=".concat(a)].join("&");return o().createElement("div",{className:(0,je.A)("stream__wrapper",b&&"stream__wrapper--is-loading")},b&&o().createElement(Be.E.Square,{height:"calc(100vw * ".concat(Je,")")}),o().createElement("iframe",it({allowFullScreen:!1,className:"stream__iframe",width:"100%",height:"100%",src:"https://iframe.cloudflarestream.com/".concat(p,"?").concat(E),"data-testid":y,title:_,onLoad:function(){return g(!1)}},v)))},ut=st;const dt=function(e){var t=e.onActionSheetClose;return o().createElement(De.A.Portal,{showHandlebar:!0,shouldCloseOnDrag:!0,handleBarPosition:"absolute"},o().createElement("div",{className:"stats-description"},o().createElement(ut,{src:qe.Jz.accumulator_stats,title:"accumulator_stats"}),o().createElement("div",{className:"stats-description__content"},o().createElement("div",{className:"stats-description__content__title"},o().createElement(Ie.E,{size:"lg",bold:!0,color:"quill-typography__color--prominent"},o().createElement(J.Localize,{i18n_default_text:"Stats"}))),o().createElement("div",{className:"stats-description__content__description"},o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Stats show the history of consecutive tick counts, i.e. the number of ticks the price remained within range continuously."}))))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Got it"}),onAction:t}}))};const ft=function(e){var t=e.rows,r=e.animation_class,n=e.is_moving_transaction;return o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement("div",{className:"stats-sheet"},o().createElement("div",{className:"stats-sheet__title"},o().createElement(Ie.E,{size:"lg",bold:!0,color:"quill-typography__color--prominent"},o().createElement(J.Localize,{i18n_default_text:"Stats"}))),o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"History of tick counts"}))),o().createElement(De.A.Content,null,o().createElement("div",{className:"stats-sheet__stats"},o().createElement(Ue,{rows:t[0],animation_class:r,is_moving_transaction:n,className:"stats-sheet__stats"})),t.slice(1).map((function(e,t){return o().createElement("div",{key:t,className:"stats-sheet__stats"},e.map((function(e,r){return o().createElement("div",{key:"".concat(t,"-").concat(r),className:"stats-sheet__stats__number"},o().createElement(Ie.E,{size:"sm"},e))})))}))))};function mt(e){return function(e){if(Array.isArray(e))return _t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||yt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||yt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(e,t){if(e){if("string"==typeof e)return _t(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_t(e,t):void 0}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const vt=(0,he.observer)((function(){var e,t=(0,ze.P)().ticks_history_stats,r=void 0===t?{}:t,a=pt((0,n.useState)(!1),2),i=a[0],l=a[1],c=pt((0,n.useState)(!1),2),s=c[0],u=c[1],d=pt((0,n.useState)(""),2),f=d[0],m=d[1],p=pt((0,n.useState)(null),2),y=p[0],_=p[1],v=pt((0,n.useState)(!1),2),h=v[0],b=v[1],g=(0,n.useMemo)((function(){var e;return null!==(e=null==r?void 0:r.ticks_stayed_in)&&void 0!==e?e:[]}),[r]),E=(0,n.useMemo)((function(){return g.reduce((function(e,t,r){return r%5==0&&e.push(g.slice(r,r+5)),e}),[])}),[g]),S=function(){l(!1),u(!1)};return(0,n.useEffect)((function(){var e,t,r;if(E[0]&&E[0].length>0){m(""),clearTimeout(e),clearTimeout(t),clearTimeout(r);var n=y===E[0][1];n?t=setTimeout((function(){return m("animate-error")}),0):e=setTimeout((function(){return m("animate-success")}),0),b(n),n&&(r=setTimeout((function(){return b(!1)}),600)),_(E[0][0])}return function(){clearTimeout(e),clearTimeout(t),clearTimeout(r)}}),[null===(e=E[0])||void 0===e?void 0:e[0],g]),0===E.length?null:o().createElement("div",null,o().createElement("div",{className:"accumulators-stats-v2"},o().createElement("div",{className:"accumulators-stats-v2__container"},o().createElement("button",{className:"accumulators-stats-v2__container__heading",onClick:function(){return u(!0)}},o().createElement(Ie.E,{size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Stats"}))),o().createElement("div",{className:"accumulators-stats-v2__container__divider"}),o().createElement("div",{className:"accumulators-stats-v2__container__stats"},o().createElement(Ue,{rows:[].concat(mt(E[0]),mt(E[1]||[])),animation_class:f,is_moving_transaction:h,className:"accumulators-stats-v2__container__stats"})),o().createElement("button",{className:"accumulators-stats-v2__container__expand",onClick:function(){return l(!0)}},o().createElement(Me.A,{"data-testid":"expand-stats-icon",fill:"var(--semantic-color-monochrome-textIcon-normal-high)"})))),o().createElement(De.A.Root,{isOpen:i||s,onClose:S,position:"left",className:"accumulator-stats-sheet-wrapper",expandable:!1},i&&o().createElement(ft,{rows:E,is_moving_transaction:h,animation_class:f}),s&&o().createElement(dt,{onActionSheetClose:S})))}));var ht=r("../../node_modules/classnames/index.js"),bt=r.n(ht),gt=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneChartAreaRegularIcon.js"),Et=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneChartAreaFillIcon.js"),St=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneClockThreeRegularIcon.js"),wt=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneClockThreeFillIcon.js"),At=r("../../node_modules/@deriv-com/quill-ui/dist/components/Badge/index.js"),Ot=r("../../node_modules/@deriv-com/quill-ui/dist/components/Navigation/index.js"),kt=r("react-router");function xt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ct(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ct(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const jt=(0,he.observer)((function(e){var t=e.children,r=e.className,n=e.onScroll,a=(0,kt.useHistory)(),l=(0,kt.useLocation)(),c=(0,s.A)(),u=c.client,d=c.portfolio.active_positions_count,f=u.is_logged_in,m=[{icon:o().createElement(gt.A,{iconSize:"sm"}),activeIcon:o().createElement(Et.A,{iconSize:"sm"}),label:o().createElement(J.Localize,{i18n_default_text:"Trade"}),path:i.routes.trade},{icon:d>0?o().createElement(At.E,{variant:"notification",position:"top-right",label:d.toString(),color:"danger",size:"sm",contentSize:"sm",className:"bottom-nav-item__position-badge"},o().createElement(St.A,{iconSize:"sm"})):o().createElement(St.A,{iconSize:"sm"}),activeIcon:d>0?o().createElement(At.E,{variant:"notification",position:"top-right",label:d.toString(),color:"danger",size:"sm",contentSize:"sm",className:"bottom-nav-item__position-badge"},o().createElement(wt.A,{iconSize:"sm"})):o().createElement(wt.A,{iconSize:"sm"}),label:o().createElement(o().Fragment,null,o().createElement("span",{className:"user-guide__anchor"}),o().createElement(J.Localize,{i18n_default_text:"Positions"})),path:i.routes.trader_positions}],p=m.findIndex((function(e){return e.path===l.pathname})),y=xt(o().useState(p>-1?p:0),2),_=y[0],v=y[1];return o().createElement("div",{className:bt()("bottom-nav",r)},o().createElement("div",{className:"bottom-nav-selection",onScroll:n},t),f?o().createElement(Ot.V.Bottom,{className:"bottom-nav-container",onChange:function(e,t){return function(e){v(e),a.push(m[e].path)}(t)}},m.map((function(e,t){return o().createElement(Ot.V.BottomAction,{key:t,index:t,activeIcon:o().createElement(o().Fragment,null),icon:t===_?e.activeIcon:e.icon,label:e.label,selected:t===_,showLabel:!0,className:(0,je.A)("bottom-nav-item",t===_&&"bottom-nav-item--active",e.path===i.routes.trader_positions&&"bottom-nav-item--positions")})}))):o().createElement(o().Fragment,null))}));function Tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Pt={},Nt={},It=function(e){return Array.isArray(e)?e.join("-"):e},Dt=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=It(e),a=r.enabled,l=void 0===a||a,c=Tt((0,n.useState)(Pt[o]||null),2),s=c[0],u=c[1],d=Tt((0,n.useState)(null),2),f=d[0],m=d[1],p=Tt((0,n.useState)(!Pt[o]&&l),2),y=p[0],_=p[1],v=(0,n.useRef)(!1),h=JSON.stringify(t),b=r.wait_for_authorize,g=void 0===b||b;(0,n.useEffect)((function(){return v.current=!0,function(){v.current=!1}}),[]);var E=(0,n.useCallback)((function(){var e,t;if(_(!0),Nt[o])t=Nt[o];else{var r=JSON.parse(h);t=g?i.WS.authorized.send(r):i.WS.send(r),Nt[o]=t}null===(e=t)||void 0===e||e.then((function(e){v.current&&(Pt[o]=e,u(e),_(!1))})).catch((function(e){v.current&&(m(e),_(!1))})).finally((function(){delete Nt[o]}))}),[o,h,g]);(0,n.useEffect)((function(){l&&!Pt[o]&&E()}),[o,E,l]),(0,n.useEffect)((function(){l&&s!==Pt[o]&&u(Pt[o])}),[l,o,s]);var S=(0,n.useCallback)((function(){Pt[o]=null,E()}),[E,o]);return{data:s,error:f,is_fetching:y,refetch:S}},Mt=r("./src/AppV2/Utils/trade-types-utils.tsx"),zt=function(e){return[i.isVanillaContract,i.isTurbosContract,i.isRiseFallContract].some((function(t){return e.every((function(e){return t(e)}))}))};function Rt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ut=function(){var e=Rt(o().useState([]),2),t=e[0],r=e[1],a=Rt(o().useState([]),2),l=a[0],c=a[1],u=(0,ze.P)(),d=u.contract_type,f=u.onChange,m=u.setContractTypesListV2,p=u.setDefaultStake,y=u.processContractsForV2,_=u.symbol,v=(0,s.A)().client,h=v.loginid,b=v.is_switching,g=v.landing_company_shortcode,E=o().useRef(g),S=(0,n.useCallback)((function(){return!(function(e){return e&&"null"!==e}(h)&&!g)&&!b}),[h,b,g]),w=Dt(["contracts_for_company",null!=h?h:"",g],{contracts_for_company:1,landing_company:g},{enabled:S()}),A=w.data,O=w.error,k=w.is_fetching,x=(0,i.getContractCategoriesConfig)(),C=(0,i.cloneObject)(x),j=(0,i.getContractTypesConfig)(),T=Rt(o().useState(),2),L=T[0],P=T[1],N=(0,n.useRef)(k),I=(0,n.useCallback)((function(e){return e.some((function(e){return zt([d,e.value])||d===e.value}))}),[d]),D=(0,n.useCallback)((function(e){return Array.isArray(e)&&0===e.length?[]:(0,Mt.ae)(e)}),[]),M=(0,n.useCallback)((function(e){return!I(e)&&e.length>0?e[0].value:d}),[d,I]),z=(0,n.useCallback)((function(e){d!=e&&e&&f({target:{name:"contract_type",value:e}}),(0,i.setTradeURLParams)({contractType:e})}),[d,f]);(0,n.useEffect)((function(){P(void 0),r([]),N.current=!0}),[h]),(0,n.useEffect)((function(){try{var e=(A||{}).contracts_for_company,t={};if(N.current=!1,!O&&null!=e&&e.available.length){e.available.forEach((function(e){var r=Object.keys(j).find((function(t){return-1!==j[t].trade_types.indexOf(e.contract_type)&&("PUT"!==e.contract_type||1===j[t].barrier_count)}));if(r){if(!t[r]){var n,o,a=null!==(n=Object.keys(C).find((function(e){return-1!==C[e].categories.indexOf(r)})))&&void 0!==n?n:"",l=null===(o=C[a])||void 0===o?void 0:o.categories;if(!l)return;l[l.indexOf(r)]={value:r,text:j[r].title,barrier_category:e.barrier_category},t[r]=(0,i.cloneObject)(j[r])}var c=t[r].config||{};c.barrier_category=0===j[r].barrier_count?"euro_atm":e.barrier_category,c.default_stake=e.default_stake,r===d&&p(e.default_stake),t[r].config=c}})),m(C),r(C),P(t);var n=D(C);c(n);var o=M(n);z(o),g!==E.current&&f({target:{name:"symbol",value:_}}).then((function(){y(),E.current=g}))}}catch(e){console.error(e)}}),[A]);return{trade_types:l,contract_types_list:t,available_contract_types:L,is_fetching_ref:N,resetTradeTypes:function(){c([])}}};function qt(e){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qt(e)}function Bt(){Bt=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==qt(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(qt(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function Vt(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Gt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=qt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qt(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Wt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Wt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const $t=function(){var e,t,r,o=(0,s.A)(),a=o.client,l=o.common,c=a.loginid,u=a.is_switching,d=l.showError,f=l.current_language,m=(0,ze.P)(),p=m.active_symbols,y=m.contract_type,_=m.is_vanilla,v=m.is_turbos,h=m.setActiveSymbolsV2,b=Yt((0,n.useState)(p),2),g=b[0],E=b[1],S=Ut(),w=S.available_contract_types,A=S.is_fetching_ref,O=[i.TRADE_TYPES.RISE_FALL,i.TRADE_TYPES.RISE_FALL_EQUAL,i.TRADE_TYPES.HIGH_LOW],k=((null==w||null===(e=w[y])||void 0===e?void 0:e.config)||{}).barrier_category,x=(0,n.useCallback)((function(){return!(!w||A.current||u)}),[w,u,A]),C=Dt(["active_symbols",null!=c?c:"",(0,i.isTurbosContract)(y)?"turbos":(0,i.isVanillaContract)(y)?"vanilla":y,f],function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(r),!0).forEach((function(t){Gt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({active_symbols:"brief",contract_type:v?[i.CONTRACT_TYPES.TURBOS.LONG,i.CONTRACT_TYPES.TURBOS.SHORT]:_?[i.CONTRACT_TYPES.VANILLA.CALL,i.CONTRACT_TYPES.VANILLA.PUT]:null!==(t=null===(r=(0,i.getContractTypesConfig)()[y])||void 0===r?void 0:r.trade_types)&&void 0!==t?t:[]},O.includes(y)&&k?{barrier_category:[k]}:{}),{enabled:x()}),j=C.data;return(0,n.useEffect)((function(){var e=function(){var e,t=(e=Bt().mark((function e(){var t,r;return Bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:t=j.active_symbols,r=void 0===t?[]:t,j.error?d({message:(0,J.localize)("Trading is unavailable at this time.")}):null!=r&&r.length?(E(r),h(r)):E([]);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){Vt(a,n,o,i,l,"next",e)}function l(e){Vt(a,n,o,i,l,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}();e()}),[j]),{activeSymbols:g}};var Kt=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/caption/index.js");const Jt=function(e){var t=e.opening_time,r=e.days_offset,n=e.current_language,a=(0,i.convertTimeFormat)(t),l=(0,i.toMoment)(new Date).locale(n.toLowerCase()).add(r,"days").format("DD MMM YYYY");return o().createElement(Kt.O,{bold:!0,className:"market-opening-time-banner"},o().createElement(J.Localize,{i18n_default_text:"{{formatted_opening_time}} (GMT), {{opening_date}}",values:{formatted_opening_time:a,opening_date:l}}))};var Xt=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedStopwatchMdBoldIcon.js");const Zt=function(e){var t=e.time_left,r="";if(Object.keys(t).length){var n=(24*Number(t.days)+Number(t.hours)).toString().padStart(2,"0"),a=Number(t.minutes).toString().padStart(2,"0"),i=Number(t.seconds).toString().padStart(2,"0");r="".concat(n,":").concat(a,":").concat(i)}return o().createElement("div",{className:"market-countdown-timer"},o().createElement(Xt.A,{fill:"var(--component-textIcon-static-prominentDark)"}),o().createElement(Ie.E,{bold:!0,size:"md",className:"market-countdown-timer-text"},r))};var Qt=function(e){var t=e-Date.now();return t>0?{days:Math.floor(t/864e5),hours:Math.floor(t/36e5%24),minutes:Math.floor(t/1e3/60%60),seconds:Math.floor(t/1e3%60)}:{}},er=function(e,t){for(var r,n=t.markets,o=0;o<n.length;o++){var a=n[o].submarkets;if(a)for(var i=0;i<a.length;i++){var l=a[i].symbols;if(void 0!==(r=null==l?void 0:l.find((function(t){return t.symbol===e}))))return r}}};function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function rr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return nr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function or(){or=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==tr(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(tr(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function ar(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function ir(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){ar(a,n,o,i,l,"next",e)}function l(e){ar(a,n,o,i,l,"throw",e)}i(void 0)}))}}var lr=function(){var e=ir(or().mark((function e(t){var r;return or().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.WS.tradingTimes(t);case 2:if(!(r=e.sent).error){e.next=5;break}return e.abrupt("return",{api_initial_load_error:r.error.message});case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();const cr=(0,he.observer)((function(){var e=(0,s.A)().common.current_language,t=(0,ze.P)(),r=t.symbol,n=t.prepareTradeStore,a=t.is_market_closed,l=$t().activeSymbols,c=(0,i.useIsMounted)(),u=rr(o().useState({}),2),d=u[0],f=u[1],m=rr(o().useState(Qt(null==d?void 0:d.remaining_time_to_open)),2),p=m[0],y=m[1],_=rr(o().useState(!0),2),v=_[0],h=_[1];if(o().useEffect((function(){if(a){h(!0);var e=function(){var t=ir(or().mark((function t(n,o){var a,l,s,u,d,m,p,y,_;return or().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>7)){t.next=2;break}return t.abrupt("return",{});case 2:return l=(0,i.toMoment)(new Date).add(n,"days"),t.next=5,lr(l.format("YYYY-MM-DD"));case 5:if((s=t.sent).api_initial_load_error){t.next=26;break}if(u=er(o,s.trading_times),d=null==u?void 0:u.times.open,m=null==u?void 0:u.times.close,!(1===(null==d?void 0:d.length)&&"--"===d[0]&&"--"===m[0])){t.next=13;break}return t.abrupt("return",e(n+1,o));case 13:p=l.toISOString().substring(0,11),y=function(e){return new Date("".concat(p).concat(e,"Z"))},_=0;case 16:if(!(_<(null==d?void 0:d.length))){t.next=25;break}if(!(+y(d[_])-Date.now()>0)){t.next=22;break}if(a=+y(d[_]),!c()||o!==r){t.next=22;break}return t.abrupt("return",f({days_offset:n,opening_time:d[_],remaining_time_to_open:a}));case 22:_++,t.next=16;break;case 25:e(n+1,o);case 26:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}();e(0,r)}y({}),f({})}),[l,r]),o().useEffect((function(){var e;return null!=d&&d.remaining_time_to_open&&(e=setTimeout((function(){y(Qt(d.remaining_time_to_open)),+new Date(d.remaining_time_to_open)-+new Date<1e3&&(h(!0),n(!1))}),1e3)),function(){e&&clearTimeout(e)}}),[p,d,n]),!d||!Object.keys(p).length||!a)return null;var b=d.opening_time,g=d.days_offset;return v&&h(!1),o().createElement("div",{className:(0,je.A)("closed-market-message--container",{"closed-market-message--loading":v})},o().createElement("div",{className:"closed-market-message--left"},o().createElement(Kt.O,{className:"closed-market-message--left-message"},o().createElement(J.Localize,{i18n_default_text:"This market will reopen at"})),o().createElement(Jt,{opening_time:b,days_offset:g,current_language:e})),o().createElement(Zt,{time_left:p}))}));var sr=r("../../node_modules/@deriv-com/quill-ui/dist/components/Typography/heading/index.js");function ur(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return dr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var fr="increment",mr="decrement",pr="add10",yr=function(e){var t=e.has_tick_count,r=e.spot,n=e.tick,a=Number(null==r?void 0:r.slice(-1)),i=(0,Ce.usePrevious)(r),l=Number(null==i?void 0:i.slice(-1)),c=ur(o().useState(!1),2),s=c[0],u=c[1],d=ur(o().useState(!1),2),f=d[0],m=d[1],p=ur(o().useState(a),2),y=p[0],_=p[1],v=ur(o().useState(a),2),h=v[0],b=v[1],g=o().useRef(l),E=o().useRef(),S=o().useRef(),w=o().useRef(null);return o().useEffect((function(){var e;if(!isNaN(l)&&!isNaN(a)&&r){var t=Math.abs(Number(l)-a),n=t>0?Math.floor(80/t):80,o=Number(l)<=a;null===(e=w.current)||void 0===e||e.style.setProperty("--animation-time","".concat(n,"ms")),o?u(!0):m(!0),S.current=setTimeout((function(){u(!1),m(!1),b(g.current%10)}),80);var i;return g.current=Number(l),function(e,t,r,n){clearInterval(E.current);var o=setInterval((function(){e===fr&&g.current<n?g.current=(g.current+1)%10:e===mr&&g.current>n?g.current=Math.abs(g.current-1)%10:e===pr&&g.current<r+10?g.current+=1:(e===pr?g.current===r+10:g.current===n)&&clearInterval(o),_(g.current%10)}),t);E.current=o}((i=pr,Number(l)<a?i=fr:Number(l)>a&&(i=mr),i),n,Number(l),a),function(){clearTimeout(S.current),clearInterval(E.current)}}}),[r,l,a]),r?o().createElement("div",{className:"current-spot__display"},t&&o().createElement(Ie.E,{size:"xl",color:"quill-typography__color--prominent"},o().createElement(J.Localize,{i18n_default_text:"Tick {{current_tick}}",values:{current_tick:n}})),o().createElement("div",{className:"current-spot"},o().createElement(Ie.E,{size:"xl",bold:!0,color:"quill-typography__color--prominent"},r.slice(0,-1)),o().createElement("div",{className:"current-spot__last-digit-container"},o().createElement("div",{ref:w,className:(0,je.A)("current-spot__last-digit-wrapper",s&&"current-spot__last-digit-wrapper--enter-from-top",f&&"current-spot__last-digit-wrapper--enter-from-bottom")},s&&o().createElement(sr.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},y),o().createElement(sr.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},h),f&&o().createElement(sr.D.H2,{color:"quill-typography__color--prominent",className:"current-spot__last-digit"},y))))):null};const _r=o().memo(yr);function vr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return hr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var br="lost",gr="won",Er=(0,he.observer)((function(){var e,t,r,n,a=o().useRef(),l=(0,s.A)().contract_trade,c=l.last_contract,u=l.prev_contract,d=null!==(e=c.contract_info)&&void 0!==e&&e.entry_tick||!u?c:u,m=d.contract_info,p=void 0===m?{}:m,y=d.digits_info,_=void 0===y?{}:y,v=d.display_status,h=d.is_digit_contract,b=d.is_ended,g=(0,ze.P)(),E=g.tick_data,S=g.symbol,w=p.contract_id,A=p.entry_tick,O=p.date_start,k=p.contract_type,x=p.tick_stream,C=p.underlying,j=(0,Ce.usePrevious)(w),T=null===(t=c.contract_info)||void 0===t||null===(r=t.tick_stream)||void 0===r?void 0:r.length,L=(0,Ce.usePrevious)(T),P=E,N=(0,i.isContractElapsed)(p,P),I=(0,i.isContractElapsed)(null==u?void 0:u.contract_info,P),D=!N&&P?v:null;if(O&&!N&&null!=x&&x.length){var M=(0,f.toJS)(x.slice(-1)[0]),z=M.epoch,R=M.tick,F=M.tick_display_value;P={ask:R,bid:R,epoch:z,pip_size:null==F?void 0:F.split(".")[1].length,quote:R,current_tick:x.length}}var U=P&&"current_tick"in P?P.current_tick:null,q=b&&h,B=q&&D===gr,V=q&&D===br,H=Object.keys(_).sort((function(e,t){return+e-+t})).map((function(e){return _[+e]})),G=o().useMemo((function(){return H.slice(-1)[0]||{}}),[H]),Y=P?+P.pip_size:null,W=null!==(n=P)&&void 0!==n&&n.quote&&Y?P.quote.toFixed(Y):null,$=W?+(W.split("").pop()||""):null,K=o().useMemo((function(){return B||V?G:{digit:$,spot:W}}),[B,V,$,W,G]),J=vr(o().useState(U),2),X=J[0],Z=J[1],Q=vr(o().useState(K.spot),2),ee=Q[0],te=Q[1],re=vr(o().useState(!1),2),ne=re[0],oe=re[1],ae=!N&&P?Number(p.barrier):null,ie=(0,Ve.yk)(k,ae,K.digit),le=h&&D&&K.spot&&!!A,ce=le&&!b,se=C===S||!C,ue=le&&se,de=!(null!=u&&u.contract_info&&(!I||1!==T||L)),fe=o().useCallback((function(){Z(U),te(K.spot)}),[U,K.spot]);return o().useEffect((function(){var e;(null==u?void 0:u.contract_info)&&!I&&(null===(e=c.contract_info)||void 0===e?void 0:e.entry_tick)&&(j&&w&&j!==w)?(oe(!0),a.current=setTimeout((function(){oe(!1),fe()}),240)):ne||fe()}),[w,I,c,u,j,fe,ne]),o().useEffect((function(){return function(){clearTimeout(a.current)}}),[]),o().createElement("div",{className:(0,je.A)("trade__current-spot",ue&&"trade__current-spot--has-contract",ue&&de&&"trade__current-spot--enter-from-left",!ue&&N&&"trade__current-spot--enter-from-right",ce&&ie&&"trade__current-spot--winning",B&&"trade__current-spot--won",ce&&!ie&&"trade__current-spot--losing",V&&"trade__current-spot--lost")},P&&se&&ee?o().createElement("div",{className:(0,je.A)("current-spot__wrapper",ne&&"current-spot__wrapper--enter-from-top")},ne&&o().createElement(_r,{has_tick_count:!!le,spot:K.spot,tick:U}),o().createElement(_r,{has_tick_count:!!le,spot:ee,tick:X})):o().createElement(Ce.Skeleton,{width:128,height:32}))}));const Sr=Er;var wr=r("../../node_modules/@deriv-com/quill-ui/dist/components/Tab/index.js"),Ar=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/search-field/index.js"),Or=r("../../node_modules/@deriv-com/quill-ui/dist/components/Button/base/index.js"),kr=(0,he.observer)((function(e){var t,r=e.isSearching,a=e.setIsSearching,l=e.searchValue,c=e.setSearchValue,u=(0,s.A)().ui.is_dark_mode_on,d=(0,ze.P)().contract_type,f=null===(t=(0,i.getContractTypesConfig)()[d])||void 0===t?void 0:t.title,m=(0,n.useRef)(null);(0,n.useEffect)((function(){var e=m.current;if(e){var t=function(){return a(!0)};return e.addEventListener("focus",t),function(){e.removeEventListener("focus",t)}}}),[]);return o().createElement("div",{className:(0,je.A)("symbols-search-field__container",{"symbols-search-field--is-focused":r})},o().createElement(Ar.L,{inputSize:"sm",placeholder:(0,J.localize)("Search markets on ")+f,variant:"fill",ref:m,value:l,onChange:function(e){c(e.target.value)}}),r&&o().createElement(Or.$n,{variant:"tertiary",label:o().createElement(J.Localize,{i18n_default_text:"Cancel"}),size:"sm",color:u?"white":"black",onClick:function(){c(""),a(!1)}}))}));const xr=kr;const Cr=function(e){var t=["synthetic_index","forex","indices","cryptocurrency","commodities"].reduce((function(e,t,r){return e[t]=r,e}),{});return e.slice().sort((function(r,n){var o=void 0!==t[r.market]?t[r.market]:e.length,a=void 0!==t[n.market]?t[n.market]:e.length;return o!==a?o-a:r.submarket_display_name.localeCompare(n.submarket_display_name)}))};function jr(e){return jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jr(e)}function Tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(r),!0).forEach((function(t){Pr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=jr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==jr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ir(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ir(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Dr=r("../../node_modules/@deriv-com/quill-ui/dist/hooks/useSnackbar.js"),Mr=r("../../node_modules/@deriv-com/quill-ui/dist/components/Tag/index.js"),zr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStarRegularIcon.js"),Rr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStarFillIcon.js"),Fr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudcadIcon.js"),Ur=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudchfIcon.js"),qr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudjpyIcon.js"),Br=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudnzdIcon.js"),Vr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexAudusdIcon.js"),Hr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedAudBasketIcon.js"),Gr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBearIcon.js"),Yr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom1000Icon.js"),Wr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom600Icon.js"),$r=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom900Icon.js"),Kr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom300Icon.js"),Jr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBoom500Icon.js"),Xr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedBullIcon.js"),Zr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash1000Icon.js"),Qr=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash600Icon.js"),en=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash900Icon.js"),tn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash300Icon.js"),rn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedCrash500Icon.js"),nn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommoditySilverusdIcon.js"),on=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityGoldusdIcon.js"),an=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityPalladiumusdIcon.js"),ln=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCommodityPlatinumusdIcon.js"),cn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCryptocurrencyBtcusdIcon.js"),sn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketCryptocurrencyEthusdIcon.js"),un=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedEurBasketIcon.js"),dn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedGbpBasketIcon.js"),fn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedGoldBasketIcon.js"),mn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump10Icon.js"),pn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump100Icon.js"),yn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump25Icon.js"),_n=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump50Icon.js"),vn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedJump75Icon.js"),hn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices100Icon.js"),bn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices200Icon.js"),gn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices300Icon.js"),En=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices400Icon.js"),Sn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedStepIndices500Icon.js"),wn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedRangeBreak100Icon.js"),An=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedRangeBreak200Icon.js"),On=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedUsdBasketIcon.js"),kn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility101sIcon.js"),xn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility1001sIcon.js"),Cn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility1501sIcon.js"),jn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility2501sIcon.js"),Tn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility251sIcon.js"),Ln=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility501sIcon.js"),Pn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility751sIcon.js"),Nn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility151sIcon.js"),In=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility301sIcon.js"),Dn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility901sIcon.js"),Mn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEuraudIcon.js"),zn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurcadIcon.js"),Rn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurchfIcon.js"),Fn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurgbpIcon.js"),Un=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurjpyIcon.js"),qn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurnzdIcon.js"),Bn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexEurusdIcon.js"),Vn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpaudIcon.js"),Hn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpcadIcon.js"),Gn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpchfIcon.js"),Yn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpjpyIcon.js"),Wn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpnokIcon.js"),$n=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpnzdIcon.js"),Kn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexGbpusdIcon.js"),Jn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexNzdjpnIcon.js"),Xn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexNzdusdIcon.js"),Zn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdcadIcon.js"),Qn=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdchfIcon.js"),eo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdjpyIcon.js"),to=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdmxnIcon.js"),ro=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdnokIcon.js"),no=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdplnIcon.js"),oo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketForexUsdsekIcon.js"),ao=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesAustralia200Icon.js"),io=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesEuro50Icon.js"),lo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesFrance40Icon.js"),co=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesGerman40Icon.js"),so=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesHongKong50Icon.js"),uo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesJapan225Icon.js"),fo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesNetherlands25Icon.js"),mo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesSwiss20Icon.js"),po=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUk100Icon.js"),yo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUs500Icon.js"),_o=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesUsTech100Icon.js"),vo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketIndicesWallStreet30Icon.js"),ho=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility10Icon.js"),bo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility100Icon.js"),go=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility25Icon.js"),Eo=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility50Icon.js"),So=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Markets/MarketDerivedVolatility75Icon.js"),wo={frxAUDCAD:Fr.A,frxAUDCHF:Ur.A,frxAUDJPY:qr.A,frxAUDNZD:Br.A,frxAUDUSD:Vr.A,WLDAUD:Hr.A,RDBEAR:Gr.A,BOOM1000:Yr.A,BOOM600:Wr.A,BOOM900:$r.A,BOOM300N:Kr.A,BOOM500:Jr.A,RDBULL:Xr.A,CRASH1000:Zr.A,CRASH600:Qr.A,CRASH900:en.A,CRASH300N:tn.A,CRASH500:rn.A,frxXAGUSD:nn.A,frxXAUUSD:on.A,frxXPDUSD:an.A,frxXPTUSD:ln.A,cryBTCUSD:cn.A,cryETHUSD:sn.A,WLDEUR:un.A,WLDGBP:dn.A,WLDXAU:fn.A,JD10:mn.A,JD100:pn.A,JD25:yn.A,JD50:_n.A,JD75:vn.A,stpRNG:hn.A,stpRNG2:bn.A,stpRNG3:gn.A,stpRNG4:En.A,stpRNG5:Sn.A,RB100:wn.A,RB200:An.A,WLDUSD:On.A,"1HZ10V":kn.A,"1HZ100V":xn.A,"1HZ150V":Cn.A,"1HZ250V":jn.A,"1HZ25V":Tn.A,"1HZ50V":Ln.A,"1HZ75V":Pn.h,"1HZ15V":Nn.A,"1HZ30V":In.A,"1HZ90V":Dn.A,frxEURAUD:Mn.A,frxEURCAD:zn.A,frxEURCHF:Rn.A,frxEURGBP:Fn.A,frxEURJPY:Un.A,frxEURNZD:qn.A,frxEURUSD:Bn.A,frxGBPAUD:Vn.A,frxGBPCAD:Hn.A,frxGBPCHF:Gn.A,frxGBPJPY:Yn.A,frxGBPNOK:Wn.A,frxGBPNZD:$n.A,frxGBPUSD:Kn.A,frxNZDJPY:Jn.A,frxNZDUSD:Xn.A,frxUSDCAD:Zn.A,frxUSDCHF:Qn.A,frxUSDJPY:eo.A,frxUSDMXN:to.A,frxUSDNOK:ro.A,frxUSDPLN:no.A,frxUSDSEK:oo.A,OTC_AS51:ao.A,OTC_SX5E:io.A,OTC_FCHI:lo.A,OTC_GDAXI:co.A,OTC_HSI:so.A,OTC_N225:uo.A,OTC_AEX:fo.A,OTC_SSMI:mo.A,OTC_FTSE:po.A,OTC_SPC:yo.A,OTC_NDX:_o.A,OTC_DJI:vo.A,R_10:ho.A,R_100:bo.A,R_25:go.A,R_50:Eo.A,R_75:So.A};const Ao=function(e){var t=e.symbol,r=wo[t];return r?o().createElement(r,{iconSize:"md"}):null};var Oo=r("./src/Stores/useModulesStores.tsx");function ko(e){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ko(e)}function xo(e){return function(e){if(Array.isArray(e))return Po(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Lo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Co(){Co=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==ko(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(ko(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function jo(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function To(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Lo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lo(e,t){if(e){if("string"==typeof e)return Po(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Po(e,t):void 0}}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var No=(0,n.forwardRef)((function(e,t){var r=e.item,a=e.selectedSymbol,l=e.setSelectedSymbol,c=e.setIsOpen,s=To((0,n.useState)(!1),2),u=s[0],d=s[1],f=(0,ze.P)().onChange,m=(0,Oo.q)().markets,p=m.favoriteSymbols,y=m.setFavoriteSymbols,_=m.removeFavoriteSymbol,v=(0,Dr.d)().addSnackbar;(0,n.useEffect)((function(){d(p.includes(r.symbol))}),[p,r.symbol]);var h=function(){var e,t=(e=Co().mark((function e(t){return Co().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l(t),e.next=3,f({target:{name:"symbol",value:t}});case 3:c(!1);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){jo(a,n,o,i,l,"next",e)}function l(e){jo(a,n,o,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),b=function(e){var t=(null==e?void 0:e.currentTarget).getAttribute("data-symbol")||"";(0,i.clickAndKeyEventHandler)((function(){return h(t)}),e)},g=function(e){var t=(null==e?void 0:e.currentTarget).getAttribute("data-symbol")||"";(0,i.clickAndKeyEventHandler)((function(){return function(e){e&&(-1!==p.indexOf(e)?(_(e),v({icon:o().createElement(zr.A,{fill:"var(--component-snackbar-icon-neutral)",iconSize:"sm"}),message:o().createElement(J.Localize,{i18n_default_text:"Removed from favourites"}),hasCloseButton:!1})):(y([].concat(xo(p),[e])),v({icon:o().createElement(Rr.A,{fill:"var(--core-color-solid-mustard-700)",iconSize:"sm"}),message:o().createElement(J.Localize,{i18n_default_text:"Added to favourites"}),hasCloseButton:!1})),d(p.includes(e)))}(t)}),e)};return o().createElement("div",{className:(0,je.A)("market-category-item",{"market-category-item--selected":a===r.symbol}),ref:t},o().createElement("span",{className:"market-category-item-left","data-symbol":r.symbol,onClick:b,onKeyDown:b},o().createElement(Ao,{symbol:r.symbol}),o().createElement(Ie.E,{size:"sm",className:(0,je.A)("market-category-item-symbol",{"market-category-item-symbol--selected":a===r.symbol})},o().createElement("span",null,r.display_name)),!r.exchange_is_open&&o().createElement(Mr.v,{label:o().createElement(J.Localize,{key:"exchange-closed",i18n_default_text:"CLOSED"}),color:"error",variant:a===r.symbol?"outline":"fill",showIcon:!1})),o().createElement("span",{onClick:g,onKeyDown:g,"data-symbol":r.symbol},u?o().createElement(Rr.A,{fill:"var(--core-color-solid-mustard-700)",iconSize:"sm"}):o().createElement(zr.A,{fill:a===r.symbol?"var(--semantic-color-slate-solid-textIcon-inverse-highest)":"var(--semantic-color-monochrome-textIcon-normal-mid)",iconSize:"sm"})))}));No.displayName="MarketCategoryItem";const Io=(0,he.observer)(No);const Do=function(){return o().createElement("div",{className:"favorite-symbols--no-fav"},o().createElement(Rr.A,{fill:"var(--semantic-color-slate-solid-surface-static-midLowest)",iconSize:"2xl"}),o().createElement(Ie.E,{size:"lg",bold:!0,color:"quill-typography__color--subtle"},o().createElement(J.Localize,{i18n_default_text:"No favourites"})),o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(J.Localize,{i18n_default_text:"Your favourite markets will appear here."})))};const Mo=(0,he.observer)((function(e){var t=e.selectedSymbol,r=e.setSelectedSymbol,a=e.setIsOpen,i=function(){var e=$t().activeSymbols,t=(0,Oo.q)().markets.favoriteSymbols,r=(0,n.useMemo)((function(){return null==t?void 0:t.map((function(t){return e.find((function(e){return e.symbol===t}))})).filter((function(e){return void 0!==e}))}),[e,t]);return(0,n.useMemo)((function(){return Cr(r)}),[r])}();return o().createElement(o().Fragment,null,i.length>0?o().createElement("div",{className:"favorite-symbols__container"},i.map((function(e){return o().createElement(Io,{key:null==e?void 0:e.display_name,item:e,selectedSymbol:t,setSelectedSymbol:r,setIsOpen:a})}))):o().createElement(Do,null))}));function zo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ro(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ro(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Fo=function(e){var t=e.category,r=e.selectedSymbol,a=e.setSelectedSymbol,i=e.setIsOpen,l=e.isOpen,c=(0,n.useRef)({}),s=(0,Ce.usePrevious)(r);return(0,n.useEffect)((function(){var e;l&&"all"===t.market&&r&&c.current[r]&&!s&&(null===(e=c.current[r])||void 0===e||e.scrollIntoView({block:"center"}))}),[l,t.market,r,s]),o().createElement(wr.o.Panel,{key:t.market_display_name},"favorites"!==t.market?Object.entries(t.subgroups).map((function(e){var n=zo(e,2),l=n[0],s=n[1];return o().createElement("div",{key:l,className:"market-category-content__container"},"none"!==l&&o().createElement("div",{className:"market-category-title__container"},o().createElement(Ie.E,{size:"sm",className:"market-category-title"},t.subgroups[l].subgroup_display_name)),Object.entries(s.submarkets).map((function(e){var t=zo(e,2),n=t[0],l=t[1];return o().createElement("div",{className:"market-category-body",key:n},o().createElement(Kt.O,{size:"sm",className:"market-category-subtitle"},l.submarket_display_name),o().createElement("div",{className:"market-category-items"},l.items.map((function(e){return o().createElement(Io,{key:e.display_name,ref:e.symbol===r?function(t){return c.current[e.symbol]=t}:void 0,item:e,selectedSymbol:r,setSelectedSymbol:a,setIsOpen:i})}))))})))})):o().createElement("div",null,o().createElement(Mo,{selectedSymbol:r,setSelectedSymbol:a,setIsOpen:i})))};const Uo=function(e){var t=e.category;return o().createElement(wr.o.Trigger,{key:t.market_display_name},"indices"===t.market?o().createElement(J.Localize,{i18n_default_text:"Stocks & indices"}):t.market_display_name)};const qo=(0,he.observer)((function(e){var t=e.selectedSymbol,r=e.setSelectedSymbol,n=e.setIsOpen,a=e.isOpen,i=e.marketCategoriesRef,l=function(e){if(0===e.length)return{};var t=Cr(e).reduce((function(e,t){var r,n,o,a,i,l=t.market,c=t.market_display_name,s=t.subgroup,u=t.subgroup_display_name,d=t.submarket,f=t.submarket_display_name;return null!==(r=e[l])&&void 0!==r||(e[l]={market:l,market_display_name:c,subgroups:{}}),null!==(o=(n=e[l].subgroups)[s])&&void 0!==o||(n[s]={subgroup_display_name:u,submarkets:{}}),null!==(i=(a=e[l].subgroups[s].submarkets)[d])&&void 0!==i||(a[d]={submarket_display_name:f,items:[]}),e[l].subgroups[s].submarkets[d].items.push(t),e}),{});Object.keys(t).forEach((function(e){Object.keys(t[e].subgroups).forEach((function(r){var n=t[e].subgroups[r].submarkets,o=Object.entries(n).sort((function(e,t){var r=Nr(e,2)[1],n=Nr(t,2)[1];return r.submarket_display_name.localeCompare(n.submarket_display_name)})).reduce((function(e,t){var r=Nr(t,2),n=r[0],o=r[1];return e[n]=o,e}),{});t[e].subgroups[r].submarkets=o}))}));var r=Object.values(t).reduce((function(e,t){return Object.keys(t.subgroups).forEach((function(r){var n="none"===r?t.market:r,o="none"===r?t.market_display_name:t.subgroups[r].subgroup_display_name;e[n]={subgroup_display_name:o,submarkets:t.subgroups[r].submarkets}})),e}),{});return t=Lr({favorites:{market:"favorites",market_display_name:(0,J.localize)("Favourites"),subgroups:{}},all:{market:"all",market_display_name:(0,J.localize)("All"),subgroups:Lr({},r)}},t)}($t().activeSymbols);return o().createElement(o().Fragment,null,o().createElement(wr.o.List,null,Object.values(l).map((function(e){return o().createElement(Uo,{key:e.market,category:e})}))),o().createElement(wr.o.Content,{className:"market-categories__list",ref:i},Object.values(l).map((function(e){return o().createElement(Fo,{key:e.market,category:e,selectedSymbol:t,setSelectedSymbol:r,setIsOpen:n,isOpen:a})}))))}));const Bo=function(e){var t=e.searchTerm;return o().createElement("div",{className:"symbol-not-found__container"},o().createElement("div",{className:"symbol-not-found__content"},o().createElement(Ie.E,{size:"lg",bold:!0,color:"quill-typography__color--subtle"},(0,J.localize)("No results for {{searchTerm}}",{searchTerm:t,interpolation:{escapeValue:!1}})),o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(J.Localize,{i18n_default_text:"Try searching for something else."}))))};const Vo=(0,he.observer)((function(e){var t=e.searchValue,r=e.setIsOpen,a=e.setSelectedSymbol,i=function(e){var t=$t().activeSymbols,r=(0,n.useMemo)((function(){return""===e.trim()?[]:t.filter((function(t){return t.display_name.toLowerCase().includes(e.toLowerCase())}))}),[e,t]);return(0,n.useMemo)((function(){return Cr(r)}),[r])}(t);return o().createElement("div",{className:"symbol-search-results__container"},""===t&&o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle",className:"symbol-search-results--suggestion"},o().createElement(J.Localize,{i18n_default_text:"Try searching for markets or keywords"})),""!==t&&(i.length>0?i.map((function(e){return o().createElement(Io,{key:null==e?void 0:e.display_name,item:e,selectedSymbol:"",setSelectedSymbol:a,setIsOpen:r})})):o().createElement(Bo,{searchTerm:t})))}));var Ho=r("./src/Analytics/index.ts");function Go(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Wo=(0,he.observer)((function(e){var t=e.isOpen,r=e.setIsOpen,a=(0,ze.P)(),i=a.setTickData,l=a.setDigitStats,c=a.symbol,s=a.contract_type,u=Go((0,n.useState)(!1),2),d=u[0],f=u[1],m=Go((0,n.useState)(c),2),p=m[0],y=m[1],_=Go((0,n.useState)(""),2),v=_[0],h=_[1],b=(0,n.useRef)(null);return(0,n.useEffect)((function(){y(c),i(null),l([])}),[l,i,c]),o().createElement(o().Fragment,null,o().createElement(De.A.Root,{isOpen:t,onClose:function(){return r(!1)}},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0,fullHeightOnOpen:!0},o().createElement(xr,{searchValue:v,setSearchValue:h,isSearching:d,setIsSearching:f}),o().createElement(wr.o.Container,{contentStyle:"hug",size:"md",className:"active-symbols-list__content",selectedTabIndex:1,onChangeTab:function(e){var t;1!==e&&(null===(t=b.current)||void 0===t||t.scrollTo({top:0}))}},d?o().createElement(Vo,{searchValue:v,setSearchValue:h,setIsOpen:r,setSelectedSymbol:function(e){(0,Ho.iN)(e,s),y(e)}}):o().createElement(qo,{selectedSymbol:p,setSelectedSymbol:function(e){(0,Ho.iN)(e,s),y(e)},setIsOpen:r,isOpen:t,marketCategoriesRef:b})))))}));const $o=Wo;var Ko=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronDownMdRegularIcon.js");function Jo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Zo=(0,he.observer)((function(){var e,t=Jo((0,n.useState)(!1),2),r=t[0],a=t[1],l=$t().activeSymbols,c=(0,ze.P)(),s=c.symbol,u=c.tick_data,d=c.is_market_closed,f=c.contract_type,m=(0,Dr.d)().addSnackbar,p=Ut().trade_types,y=l.find((function(e){return e.symbol===s})),_=null==p||null===(e=p.find((function(e){return e.value===f})))||void 0===e?void 0:e.text;(0,n.useEffect)((function(){if(!y){var e=(0,i.getMarketNamesMap)()[s]||s,t=_?o().createElement(J.Localize,{i18n_default_text:"".concat(e," is unavailable for ").concat(_,"."),values:{symbol_name:e,contract_name:_}}):o().createElement(J.Localize,{i18n_default_text:"".concat(e," is unavailable."),values:{symbol_name:e}});e&&m({message:t,status:"neutral",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:"0",width:"calc(100% - var(--core-spacing-800)"}})}}),[y,s,_]);var v=null!=u?u:{},h=v.pip_size,b=v.quote,g=null==b?void 0:b.toFixed(h),E=d?o().createElement(Ie.E,null,"-"):o().createElement(Be.E.Square,{height:18,width:64,rounded:!0});return void 0===(null==y?void 0:y.exchange_is_open)?o().createElement(Be.E.Square,{height:42,width:240,rounded:!0}):o().createElement(o().Fragment,null,o().createElement("div",{className:"market-selector__container",onClick:function(){return a(!0)}},o().createElement("div",{className:"market-selector"},o().createElement(Ao,{symbol:s}),o().createElement("div",{className:"market-selector-info"},o().createElement("div",{className:"market-selector-info__label"},o().createElement(Ie.E,{bold:!0},null==y?void 0:y.display_name),!(null!=y&&y.exchange_is_open)&&o().createElement(Mr.v,{label:o().createElement(J.Localize,{key:"closed",i18n_default_text:"CLOSED"}),color:"error",variant:"fill",showIcon:!1,size:"sm"}),o().createElement(Ko.A,{fill:"var(--component-textIcon-normal-default"})),g?o().createElement(Kt.O,{className:"market-selector-info__price"},g):E))),o().createElement($o,{isOpen:r,setIsOpen:a}))}));const Qo=Zo;var ea=r("../../node_modules/react-joyride/dist/index.mjs"),ta=r("../../node_modules/@deriv-com/quill-ui/dist/components/Button/icon-button/index.js"),ra=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronsUpXlBoldIcon.js"),na=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedXmarkSmBoldIcon.js"),oa=r("../../node_modules/react-swipeable/dist/react-swipeable.umd.js");function aa(){return aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aa.apply(null,arguments)}const ia=function(e){var t=e.isLastStep,r=e.primaryProps,n=e.skipProps,a=e.step,i=e.tooltipProps,l=e.setStepIndex,c=(0,oa.useSwipeable)({onSwipedUp:function(){var e;null===(e=document.querySelector(".trade__chart"))||void 0===e||e.scrollIntoView(),l((function(e){return e+1}))},preventDefaultTouchmoveEvent:!0,trackTouch:!0,trackMouse:!0});return"scroll-icon"===a.title?o().createElement("div",aa({},c,{className:"guide-tooltip__wrapper-scroll"}),o().createElement(ra.A,{className:"guide-tooltip--bounce"}),o().createElement(Ie.E,{size:"sm",bold:!0,className:"guide-tooltip__wrapper-scroll-text"},o().createElement(J.Localize,{i18n_default_text:"Swipe up to see the chart"}))):o().createElement("div",aa({},i,{className:"guide-tooltip__wrapper"}),o().createElement("div",null,a.title&&o().createElement("div",{className:"guide-tooltip__header"},o().createElement(Kt.O,{bold:!0,className:"guide-tooltip__header__title"},a.title),o().createElement(ta.K,{onClick:n.onClick,icon:o().createElement(na.A,{fill:"var(--component-textIcon-inverse-prominent)",key:"close-button"}),className:"guide-tooltip__close",size:"sm",color:"white-black",variant:"tertiary"})),a.content&&o().createElement(Kt.O,{className:"guide-tooltip__content"},a.content)),o().createElement(Or.$n,{onClick:function(e){l((function(e){return e+1})),r.onClick(e)},color:"white-black",className:"guide-tooltip__button",variant:"secondary",size:"sm",label:t?o().createElement(J.Localize,{i18n_default_text:"Done"}):o().createElement(J.Localize,{i18n_default_text:"Next"})}))};const la=[{content:o().createElement(J.Localize,{i18n_default_text:"Scroll left or right to explore trade types."}),offset:0,spotlightPadding:2,target:".trade__trade-types",title:o().createElement(J.Localize,{i18n_default_text:"Explore trade types (1/6)"})},{content:o().createElement(J.Localize,{i18n_default_text:"View available markets here."}),offset:4,placement:"bottom-start",spotlightPadding:8,target:".market-selector__container",title:o().createElement(J.Localize,{i18n_default_text:"Choose a market (2/6)"})},{content:o().createElement(J.Localize,{i18n_default_text:"Specify your trade parameters."}),offset:4,spotlightPadding:8,target:".trade-params",title:o().createElement(J.Localize,{i18n_default_text:"Open your trade (3/6)"})},{content:"",disableBeacon:!1,offset:0,spotlightPadding:0,styles:{spotlight:{display:"none"},arrow:{display:"none"}},target:"#react-joyride-portal",title:"scroll-icon"},{content:o().createElement(J.Localize,{i18n_default_text:"Track market trends with our interactive charts."}),spotlightPadding:8,offset:4,target:".trade__chart-tooltip",title:o().createElement(J.Localize,{i18n_default_text:"Analyse with charts (4/6)"}),placement:"bottom"},{content:o().createElement(J.Localize,{i18n_default_text:"Scroll left or right to adjust your trade parameters."}),disableScrolling:!1,offset:-4,target:".trade__parameter",title:o().createElement(J.Localize,{i18n_default_text:"Make quick adjustments (5/6)"})},{content:o().createElement(J.Localize,{i18n_default_text:"View your positions here."}),offset:-4,target:".user-guide__anchor",title:o().createElement(J.Localize,{i18n_default_text:"Check your positions (6/6)"})}];function ca(){return ca=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ca.apply(null,arguments)}function sa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ua(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ua(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ua(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var da=function(e){var t=e.should_run,r=e.onFinishGuide,n=sa(o().useState(0),2),a=n[0],i=n[1];return o().createElement(ea.Ay,{continuous:!0,callback:function(e){var t=e.status,n=e.step;0===e.index&&(n.disableBeacon=!0),[ea.XQ.FINISHED,ea.XQ.SKIPPED].includes(t)&&r()},disableCloseOnEsc:!0,disableOverlayClose:!0,disableScrolling:!0,floaterProps:{styles:{arrow:{length:4,spread:8,display:3===a?"none":"inline-flex"}}},run:t,showSkipButton:!0,steps:la,spotlightPadding:0,scrollToFirstStep:!0,styles:{options:{arrowColor:"var(--component-textIcon-normal-prominent)",overlayColor:"var(--core-color-opacity-black-600)"},spotlight:{borderRadius:"unset"}},stepIndex:a,tooltipComponent:function(e){return o().createElement(ia,ca({},e,{setStepIndex:i}))}})};const fa=o().memo(da);function ma(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pa(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pa(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ya=function(e){var t=e.type,r=ma(o().useState(!0),2),n=r[0],a=r[1],l=o().useCallback((function(e){return(0,i.getUrlBase)("/public/videos/user-onboarding-guide-".concat(t.replaceAll("_","-"),".").concat(e))}),[t]),c=o().useMemo((function(){return l("mp4")}),[l]);return o().createElement("div",{className:(0,je.A)("guide__player__wrapper",n&&"guide__player__wrapper--is-loading")},n&&o().createElement(Be.E.Square,{height:"calc(100vw * ".concat(Je,")")}),o().createElement("video",{autoPlay:!0,className:"guide__player","data-testid":"dt_onboarding_guide_video",muted:!0,loop:!0,onLoadedData:function(){return a(!1)},playsInline:!0,preload:"auto"},o().createElement("source",{src:c,type:"video/mp4"}),o().createElement(J.Localize,{i18n_default_text:"Unfortunately, your browser does not support the video."})))};function _a(e){return _a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_a(e)}function va(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ha(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?va(Object(r),!0).forEach((function(t){ba(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):va(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ba(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=_a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ga(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ea(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ea(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Sa=function(e){var t=e.type,r=void 0===t?"trade_page":t,n=e.is_dark_mode_on,a=e.callback,i=ga(o().useState(!1),2),l=i[0],c=i[1],s=ga(o().useState(!1),2),u=s[0],d=s[1],f=o().useRef(),m=o().useRef(!1),p=ga(Ne("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),2),y=p[0],_=p[1],v="trade_page"===r,h=o().useCallback((function(){d(!1),_(ha(ha({},y),{},ba({},r,!0))),null==a||a()}),[_]),b=function(){m.current||(h(),c(!1))},g=ha({image:o().createElement(ya,{type:n?"".concat(r,"_dark"):r}),title:o().createElement(J.Localize,{i18n_default_text:"View your positions"}),content:o().createElement(J.Localize,{i18n_default_text:"You can view your open and closed positions here. Tap an item for more details."}),button_label:o().createElement(J.Localize,{i18n_default_text:"Got it"}),primaryButtonCallback:b},v?{title:o().createElement(J.Localize,{i18n_default_text:"Welcome to the new Deriv Trader"}),content:o().createElement(J.Localize,{i18n_default_text:"Enjoy a smoother, more intuitive trading experience. Heres a quick tour to get you started."}),button_label:o().createElement(J.Localize,{i18n_default_text:"Let's begin"}),primaryButtonCallback:function(){m.current=!0,d(!0),c(!1)}}:{});return o().useEffect((function(){return null!=y&&y[r]||(f.current=setTimeout((function(){return c(!0)}),800)),function(){return clearTimeout(f.current)}}),[null==y?void 0:y[r]]),o().createElement(o().Fragment,null,o().createElement(De.M,{isOpened:l,isNonExpandable:!0,isMobile:!0,showHandleBar:!0,shouldCloseModalOnSwipeDown:!0,toggleModal:b,primaryButtonLabel:g.button_label,primaryButtonCallback:g.primaryButtonCallback},o().createElement(De.M.Header,{image:g.image,title:g.title}),o().createElement(De.M.Body,null,g.content)),v&&o().createElement(fa,{should_run:u,onFinishGuide:h}))};const wa=o().memo(Sa);var Aa=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js"),Oa=r("../hooks/src/useMFAccountStatus.ts");const ka=function(e){var t=e.currency,r=e.has_open_accu_contract,n=e.has_no_button_content,a=e.info,l=e.is_multiplier,c=e.is_turbos,s=e.is_vanilla,u=e.is_reverse;if(n)return null;var d=(0,i.getLocalizedBasis)(),f=d.payout,m=d.stake,p=l?m:f,y=function(){var e=a.stake,t=a.obj_contract_basis;return l?e:null==t?void 0:t.value}(),_=!p||!y;return o().createElement(Kt.O,{size:"sm",className:(0,je.A)("purchase-button__information__wrapper",u&&"purchase-button__information__wrapper--reverse",_&&"purchase-button__information__wrapper--disabled-placeholder"),"data-testid":"dt_purchase_button_wrapper"},!_&&o().createElement(o().Fragment,null,o().createElement(Kt.O,{as:"span",size:"sm",className:(0,je.A)(!r&&"purchase-button__information__item"),color:"quill-typography__color--prominent"},p),o().createElement(Kt.O,{as:"span",size:"sm",className:(0,je.A)(!r&&"purchase-button__information__item"),color:"quill-typography__color--prominent"},o().createElement(Ce.Money,{amount:y,currency:t,should_format:!c&&!s,show_currency:!0}))))};var xa=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneStopwatchRegularIcon.js"),Ca=r("../../node_modules/react-transition-group/esm/CSSTransition.js");function ja(e){return ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ja(e)}function Ta(){return Ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ta.apply(null,arguments)}function La(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pa(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=ja(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ja(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ja(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Na(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ia(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ia(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Da="stake",Ma=(0,he.observer)((function(){var e=Na(o().useState(null),2),t=e[0],r=e[1],n=Na(o().useState({has_error:!1,message:null}),2),a=n[0],l=n[1],c=(0,Aa.Y)().isMobile,u=(0,be.E)().addBanner,d=(0,Dr.d)().addSnackbar,f=(0,s.A)(),m=f.portfolio,p=m.all_positions,y=m.onClickSell,_=m.open_accu_contract,v=m.active_positions,h=f.client.is_logged_in,b=f.common.services_error,g=f.ui,E=g.is_mf_verification_pending_modal_visible,S=g.setIsMFVericationPendingModal,w=(0,ze.P)(),A=w.basis,O=w.basis_list,k=w.contract_type,x=w.currency,C=w.has_open_accu_contract,j=w.is_accumulator,T=w.is_multiplier,L=w.is_purchase_enabled,P=w.is_touch,N=w.is_trade_enabled_v2,I=w.is_turbos,D=w.is_vanilla_fx,M=w.is_vanilla,z=w.proposal_info,R=w.purchase_info,F=w.onPurchaseV2,U=w.onChange,q=w.symbol,B=w.trade_type_tab,V=w.trade_types,H=Na(o().useState(j&&C),2),G=H[0],Y=H[1],W=Na(o().useState(450),2),$=W[0],K=W[1],J=(0,Ce.usePrevious)(!!_&&!!v.find((function(e){var t=e.contract_info,r=e.type;return(0,i.isAccumulatorContract)(r)&&t.underlying===q}))),X=(0,Oa.A)(),Z=o().useMemo((function(){return O.length?O.map((function(e){return e.value})):[]}),[O]),Q=/^high_low$/.test(k.toLowerCase()),ee={currency:x,has_open_accu_contract:C,is_multiplier:T,is_turbos:I,is_vanilla:M},te=M||D||I||Q||P||j&&!C,re=(0,Mt.H1)(V,k,B),ne=j?p.find((function(e){var t=e.contract_info,r=e.type;return(0,i.isAccumulatorContract)(r)&&t.underlying===q&&!t.is_sold})):void 0,oe=!(null==ne||!ne.contract_info)&&((0,i.hasContractEntered)(ne.contract_info)&&(0,i.isOpen)(ne.contract_info)&&(0,i.isValidToSell)(ne.contract_info)),ae=oe&&ne&&(0,i.getIndicativePrice)(ne.contract_info)||null,ie=(0,i.getCardLabelsV2)(),le=ot({services_error:b,is_mf_verification_pending_modal_visible:E}),ce=!oe||(null==ne?void 0:ne.is_sell_requested),se=function(e,t){var r=(0,Ve.FN)(k).findIndex((function(e){return e.contract_type===t}));return(r<0?e:r)?"sell":"purchase"},ue=function(e,t){return(0,Ho.Dr)(k,q,t),u(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?La(Object(r),!0).forEach((function(t){Pa(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):La(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({icon:o().createElement(xa.A,{iconSize:"sm",className:"trade-notification--purchase",key:"contract-opened"})},e))};return o().useEffect((function(){L&&r(null)}),[L]),o().useEffect((function(){"payout"===A&&Z.length>1&&Z.includes(Da)&&U({target:{value:Da,name:"basis"}})}),[A,Z]),o().useEffect((function(){K(!J&&C||J&&!C&&j?450:0),Y(!!j&&C)}),[j,C]),o().useEffect((function(){if(z&&re.length===Object.keys(z).length){var e="",t=Object.values(z).some((function(t){return!(!t.has_error||!t.message)&&(e=t.message||"",!0)}));l({has_error:t,message:e||""})}}),[z]),o().useEffect((function(){a.has_error&&a.message&&(d({message:a.message,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:h?"48px":"-8px",width:"calc(100% - var(--core-spacing-800)"}}),l({has_error:!1,message:null}))}),[a.has_error]),o().createElement(o().Fragment,null,o().createElement(Ca.A,{in:!G,timeout:$,classNames:"slide",key:"purchase-button",unmountOnExit:!0,mountOnEnter:!0},o().createElement("div",{className:(0,je.A)("purchase-button__wrapper",{"purchase-button__wrapper__un-auth":!h})},re.map((function(e,n){var a=(null==z?void 0:z[e])||{},l=1===re.length,s=t===n,u=!N||a.has_error||!!R.error&&!le;return o().createElement(o().Fragment,{key:e},o().createElement(Or.$n,{color:se(n,e),size:"lg",label:(0,i.getContractTypeDisplay)(e,{isHighLow:Q,showButtonName:!0}),fullWidth:!0,className:(0,je.A)("purchase-button",s&&"purchase-button--loading",l&&"purchase-button--single"),isLoading:s,isOpaque:!0,disabled:u&&!s,onClick:function(){T&&X===i.MT5_ACCOUNT_STATUS.PENDING?S(!0):(r(n),F(e,c,ue))}},!s&&o().createElement(ka,Ta({},ee,{has_no_button_content:te,info:a,is_reverse:!!n}))))})))),o().createElement(Ca.A,{in:G,timeout:$,classNames:"slide",key:"sell-button",unmountOnExit:!0,mountOnEnter:!0},o().createElement("div",{className:"purchase-button__wrapper"},o().createElement(Or.$n,{color:"black-white",size:"lg",label:ce?"".concat(ie.CLOSE):"".concat(ie.CLOSE," ").concat(ae," ").concat(x),fullWidth:!0,isOpaque:!0,isLoading:null==ne?void 0:ne.is_sell_requested,className:"purchase-button purchase-button--single",disabled:!oe,onClick:function(){return y(null==ne?void 0:ne.contract_info.contract_id)}}))))}));const za=Ma;var Ra=r("../hooks/node_modules/js-cookie/src/js.cookie.js"),Fa=r.n(Ra),Ua=r("../api/src/hooks/useRemoteConfig.ts");const qa=function(){var e,t,r=(0,Ua.A)(!0).data,n=null!==(e=null==r?void 0:r.hub_enabled_country_list)&&void 0!==e?e:[],o=(0,s.A)().client,a=o.account_settings,i=o.clients_country,l=(null===(t=JSON.parse(Fa().get("client_information")||"{}"))||void 0===t?void 0:t.residence)||(null==a?void 0:a.country_code);return{isHubRedirectionEnabled:Array.isArray(n)&&l&&n.includes(l),isChangingToHubAppId:Array.isArray(n)&&i&&n.includes(i),isHubRedirectionLoaded:!!n.length}};const Ba=function(e){var t=e.error_type,r=e.services_error_message,n=function(){switch(t){case Qe:return{title:o().createElement(J.Localize,{i18n_default_text:"Insufficient balance"}),text:r||o().createElement(J.Localize,{i18n_default_text:"An error occurred."})};case et:return{title:o().createElement(J.Localize,{i18n_default_text:"Start trading with us"}),text:o().createElement(J.Localize,{i18n_default_text:"Log in or create a free account to place a trade."})};case tt:return{title:o().createElement(J.Localize,{i18n_default_text:"Account verification required"}),text:o().createElement(J.Localize,{i18n_default_text:"Please submit your proof of identity and proof of address to verify your account and continue trading."})};case rt:return{title:o().createElement(J.Localize,{i18n_default_text:"Pending verification"}),text:o().createElement(J.Localize,{i18n_default_text:"You cannot trade as your documents are still under review. We will notify you by email once your verification is approved."})};default:return{}}}()||{},a=n.title,i=n.text;return o().createElement(o().Fragment,null,o().createElement(Ie.E,{size:"lg",bold:!0,className:"service-error-sheet__body__heading"},a),o().createElement(Ie.E,null,i))};function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Va.apply(null,arguments)}function Ha(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ga(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ga(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ga(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ya=(0,he.observer)((function(){var e=Ha((0,n.useState)(!1),2),t=e[0],r=e[1],a=(0,s.A)(),l=a.common,c=a.client,u=a.ui,d=u.is_mf_verification_pending_modal_visible,f=u.setIsMFVericationPendingModal,m=c.has_wallet,p=c.is_virtual,y=l.services_error,_=l.resetServicesError,v=(0,ze.P)(),h=v.clearPurchaseInfo,b=v.requestProposal,g=(0,kt.useHistory)(),E=qa().isHubRedirectionEnabled,S=y||{},w=S.code,A=S.message,O=S.type,k=w===Qe,x=w===et&&"buy"===O,C=w===tt,j=(!(0,i.isEmptyObject)(y)||d)&&ot({services_error:y,is_mf_verification_pending_modal_visible:d}),T=function(){if(r(!1),"buy"===y.type){if(k)return;h(),b()}};return(0,n.useEffect)((function(){r(j)}),[j]),(0,n.useEffect)((function(){!t&&w&&_(),t||f(!1)}),[t]),j?o().createElement(De.A.Root,{className:"service-error-sheet",isOpen:t,onClose:T,expandable:!1,position:"left"},o().createElement(De.A.Portal,{showHandlebar:!0,shouldCloseOnDrag:!0},o().createElement("div",{className:"service-error-sheet__body"},o().createElement(Ba,{error_type:k?Qe:x?et:C?tt:d?rt:null,services_error_message:A})),o().createElement(De.A.Footer,Va({className:"service-error-sheet__footer",alignment:"vertical",primaryButtonColor:"coral"},k?{primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Deposit now"}),onAction:function(){if(_(),p)T();else if(m&&E){var e="https://hub.".concat((0,i.getDomainUrl)(),"/tradershub"),t=("https://staging-hub.".concat((0,i.getDomainUrl)(),"/tradershub"),e),r=window.location.search,n=new URLSearchParams(r),o=window.sessionStorage.getItem("account")||n.get("account");window.location.href="".concat(t,"/redirect?action=redirect_to&redirect_to=wallet").concat(o?"&account=".concat(o):"")}else{var a;null==g||null===(a=g.push)||void 0===a||a.call(g,m?i.routes.wallets_deposit:i.routes.cashier_deposit)}}}}:x?{primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Create free account"}),onAction:function(){_(),(0,i.redirectToSignUp)()}},secondaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Login"}),onAction:function(){_(),(0,i.redirectToLogin)(!1,(0,J.getLanguage)())}}}:C?{primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Submit Proof"}),onAction:function(){_(),g.push(i.routes.proof_of_identity)}}}:d?{primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Got it"}),onAction:function(){_(),f(!1),T()}}}:void 0)))):null}));var Wa=r("../../node_modules/@deriv-com/quill-ui/dist/components/Snackbar/snackbar-controller.js");const $a=function(e){var t,r=e.error_fields,n=(0,ze.P)(),o=n.contract_type,a=n.proposal_info,i=n.validation_errors,l=n.trade_type_tab,c=n.trade_types,s=(0,Mt.H1)(c,o,l),u=null!==(t=null==a?void 0:a[s[0]])&&void 0!==t?t:{},d=u.has_error,f=u.error_field,m=u.message;return r.map((function(e){return function(e){var t,r,n,o=(null==i||null===(t=i[e])||void 0===t?void 0:t.length)>0;return{is_error_matching_field:d&&f===e||o,message:null!==(r=null!=m?m:null==i||null===(n=i[e])||void 0===n?void 0:n[0])&&void 0!==r?r:""}}(e)})).find((function(e){return e.is_error_matching_field}))||{is_error_matching_field:!1,message:""}};const Ka=(0,he.observer)((function(e){var t=e.error_fields,r=e.should_show_snackbar,n=(0,s.A)().client.is_logged_in,a=(0,Dr.d)().addSnackbar,i=$a({error_fields:t}),l=i.is_error_matching_field,c=i.message;return o().useEffect((function(){l&&r&&a({message:c,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:n?"48px":"-8px",width:"calc(100% - var(--core-spacing-800)"}})}),[l,r]),o().createElement(Wa.C,null)}));var Ja=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedPresentationScreenSmRegularIcon.js"),Xa=r("./src/AppV2/Utils/contract-description-utils.tsx");const Za=function(e){var t=e.contract_type,r=e.term,n=e.onClose;return o().createElement(De.A.Root,{isOpen:!!r,onClose:n,position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Content,{className:"definition__wrapper"},o().createElement(sr.D.H4,{className:"definition__title"},r),o().createElement(Ie.E,{as:"div"},(0,Xa.OG)({term:r,contract_type:t}))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Got it"}),onAction:n},className:"definition__button"})))};var Qa=r("../../node_modules/@deriv-com/quill-ui/dist/components/Chip/index.js"),ei=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("accumulators-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/accumulators-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ti=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("multipliers-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/multipliers-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ri=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("vanillas-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/vanillas-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ni=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("turbos-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/turbos-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),oi=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("rise-fall-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/rise-fall-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ai=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("higher-lower-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/higher-lower-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ii=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("touch-no-touch-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/touch-no-touch-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),li=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("matches-differs-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/matches-differs-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),ci=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("even-odd-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/even-odd-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))(),si=(0,i.makeLazyLoader)((function(){return(0,i.moduleLoader)((function(){return r.e("over-under-trade-description").then(r.bind(r,"./src/AppV2/Components/Guide/Description/ContractDescription/over-under-trade-description.tsx"))}))}),(function(){return o().createElement(Ce.Loading,{is_fullscreen:!1})}))();const ui=function(e){var t,r=e.contract_type,n=e.onTermClick;switch(r){case Mt.OA.ACCUMULATORS:t=o().createElement(ei,{onTermClick:n});break;case Mt.OA.RISE_FALL:t=o().createElement(oi,{onTermClick:n});break;case Mt.OA.MULTIPLIERS:t=o().createElement(ti,{onTermClick:n});break;case Mt.OA.VANILLAS:t=o().createElement(ri,{onTermClick:n});break;case Mt.OA.TURBOS:t=o().createElement(ni,{onTermClick:n});break;case Mt.OA.HIGHER_LOWER:t=o().createElement(ai,{onTermClick:n});break;case Mt.OA.TOUCH_NO_TOUCH:t=o().createElement(ii,{onTermClick:n});break;case Mt.OA.MATCHES_DIFFERS:t=o().createElement(li,{onTermClick:n});break;case Mt.OA.EVEN_ODD:t=o().createElement(ci,{onTermClick:n});break;case Mt.OA.OVER_UNDER:t=o().createElement(si,{onTermClick:n});break;default:t=o().createElement(Ie.E,{as:"p"},o().createElement(J.Localize,{i18n_default_text:"Description not found."}))}return o().createElement(o().Fragment,null,t)};var di=r("./src/AppV2/Components/Guide/Description/video-preview.tsx");const fi=function(e){var t=e.contract_list,r=e.onChipSelect,n=e.onTermClick,a=e.selected_contract_type,i=e.show_guide_for_selected_contract,l=e.show_description_in_a_modal,c=void 0===l||l,s=e.toggleVideoPlayer,u=e.video_src;return o().createElement(o().Fragment,null,!i&&o().createElement("div",{className:"guide__menu"},t.map((function(e){var t=e.tradeType,n=e.id;return o().createElement(Qa.v.Selectable,{key:n,onChipSelect:function(){return r(n)},selected:n===a},o().createElement(Ie.E,{size:"sm"},t))}))),o().createElement("div",{className:(0,je.A)("guide__contract-description",{"guide__contract-description--without-btn":!c}),key:a},o().createElement(ui,{contract_type:a,onTermClick:n}),o().createElement(di.A,{contract_type:a,toggleVideoPlayer:s,video_src:u})))};var mi=r("react-dom"),pi=r.n(mi);function yi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var vi=function(e){var t=e.isOpen,r=e.children;return t?pi().createPortal(o().createElement("div",{className:"modal-player","aria-modal":"true"},o().createElement("div",{className:"modal-player__container",onClick:function(e){return e.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()}},r)),document.body):null},hi=function(e){var t=e.contract_list,r=e.is_dark_mode_on,n=e.is_open,a=e.onChipSelect,l=e.onClose,c=e.onTermClick,s=e.selected_contract_type,u=e.show_guide_for_selected_contract,d=e.show_description_in_a_modal,f=void 0===d||d,m=yi(o().useState(!1),2),p=m[0],y=m[1],_=o().useRef(null),v=(0,Xa.gl)(s,r),h=function(e){(0,i.clickAndKeyEventHandler)((function(){return y(!p)}),e)},b={contract_list:t,onChipSelect:a,onTermClick:c,selected_contract_type:s,show_guide_for_selected_contract:u,show_description_in_a_modal:f,toggleVideoPlayer:h,video_src:v};return o().useEffect((function(){_.current&&(p?_.current.showModal():_.current.close())}),[p]),o().createElement(o().Fragment,null,f?o().createElement(De.A.Root,{isOpen:n,onClose:l,position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Content,{className:"guide__wrapper__content"},o().createElement(sr.D.H4,{className:"guide__title"},u?s:o().createElement(J.Localize,{i18n_default_text:"Trade types"})),o().createElement(fi,b)),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Got it"}),onAction:l},className:"guide__button"}))):o().createElement("div",{className:"guide__wrapper__content--separate"},o().createElement(fi,b)),o().createElement(vi,{isOpen:p},o().createElement(Ce.VideoPlayer,{className:"modal-player__wrapper",data_testid:"dt_video_player",is_v2:!0,is_mobile:!0,increased_drag_area:!0,src:v,onModalClose:h,muted:!0,hide_volume_control:!0})))};const bi=o().memo(hi);function gi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Si(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ei(e){return function(e){if(Array.isArray(e))return wi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Si(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Si(e,t){if(e){if("string"==typeof e)return wi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wi(e,t):void 0}}function wi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ai=(0,he.observer)((function(e){var t,r,n=e.has_label,a=e.is_open_by_default,i=e.show_guide_for_selected_contract,l=e.show_trigger_button,c=void 0===l||l,u=e.show_description_in_a_modal,d=void 0===u||u,f=(0,s.A)(),m=f.ui.is_dark_mode_on,p=f.common.current_language,y=(0,ze.P)().contract_type,_=null!==(t=null===(r=Mt.Ou.find((function(e){return e.for.includes(y)})))||void 0===r?void 0:r.id)&&void 0!==t?t:"",v=Ut().trade_types,h=[Mt.OA.RISE_FALL,Mt.OA.ACCUMULATORS,Mt.OA.MULTIPLIERS,Mt.OA.VANILLAS,Mt.OA.TURBOS,Mt.OA.HIGHER_LOWER,Mt.OA.TOUCH_NO_TOUCH,Mt.OA.MATCHES_DIFFERS,Mt.OA.EVEN_ODD,Mt.OA.OVER_UNDER],b=Mt.Ou.filter((function(e){return v.some((function(t){return t.text===e.id}))})),g=Ei(b).sort((function(e,t){return h.findIndex((function(t){return t===e.id}))-h.findIndex((function(e){return e===t.id}))})),E=gi(o().useState(a),2),S=E[0],w=E[1],A=gi(o().useState(_),2),O=A[0],k=A[1],x=gi(o().useState(""),2),C=x[0],j=x[1],T=o().useCallback((function(e){return k(null!=e?e:"")}),[]),L=o().useCallback((function(){return w(!1)}),[]);return o().useEffect((function(){i&&k(_)}),[i,_]),o().useEffect((function(){w(S)}),[a]),o().createElement(o().Fragment,null,c&&o().createElement(Or.$n,{color:m?"white":"black",icon:o().createElement(Ja.A,{key:"guide-button-icon"}),onClick:function(){(0,Ho.YL)(y,"main_trade_page"),w(!0)},variant:n?"secondary":"tertiary",key:p},n&&o().createElement(Ie.E,{size:"sm",bold:!0,color:"quill-typography__color--prominent"},o().createElement(J.Localize,{i18n_default_text:"Guide"}))),o().createElement(bi,{contract_list:g,is_dark_mode_on:m,is_open:S,onChipSelect:function(e){var t,r,n=g.find((function(t){return t.id===e}));(0,Ho.YL)(null!==(t=null==n||null===(r=n.for)||void 0===r?void 0:r[0])&&void 0!==t?t:"","trade_type_page"),T(e)},onClose:L,onTermClick:j,selected_contract_type:O,show_guide_for_selected_contract:i,show_description_in_a_modal:d}),o().createElement(Za,{contract_type:O,term:C,onClose:function(){return j("")}}))}));const Oi=Ai;var ki=function(e){var t=e.children,r=e.is_minimized,n=e.is_minimized_visible,a=r&&n;return o().createElement("section",{className:(0,je.A)("",{"trade-params--minimized":a,"trade-params":!a})},!a&&o().createElement("div",{className:"trade-params__title"},o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Set your trade"})),o().createElement(Oi,{has_label:!0,show_guide_for_selected_contract:!0})),t)};const xi=o().memo(ki);const Ci=(0,he.observer)((function(){var e,t=(0,ze.P)(),r=t.currency,n=t.is_market_closed,a=t.maximum_payout;return(null===(e=t.proposal_info[i.CONTRACT_TYPES.ACCUMULATOR])||void 0===e?void 0:e.has_error)?null:o().createElement("div",{className:"accumulators-info__wrapper"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(n&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"Max. payout"})),a?o().createElement(Ie.E,{size:"sm",bold:!0,className:(0,je.A)(n&&"trade-params__text--disabled")},o().createElement(Ce.Money,{amount:a,show_currency:!0,currency:r})):o().createElement(Ce.Skeleton,{width:100,height:14}))}));var ji=r("../../node_modules/@deriv-com/quill-ui/dist/components/SelectionControl/toggle-switch/index.js"),Ti=r("./src/Stores/Modules/Trading/Helpers/allow-equals.ts");function Li(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ni=(0,he.observer)((function(){var e=(0,ze.P)(),t=e.contract_types_list,r=e.contract_start_type,n=e.duration_unit,a=e.expiry_type,l=e.is_equal,c=e.is_market_closed,s=e.onChange,u=Li(o().useState(!1),2),d=u[0],f=u[1],m=(0,Ti.jZ)(t,n,r),p=(0,Ti.KM)(t),y=function(e){c||(0,i.clickAndKeyEventHandler)((function(){return f(!0)}),e)},_=function(){return f(!1)};return(m||"endtime"===a)&&p?o().createElement(o().Fragment,null,o().createElement("div",{className:"allow-equals__wrapper"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)("allow-equals__title",c&&"allow-equals__title--disabled"),onClick:y,onKeyDown:y},o().createElement(J.Localize,{i18n_default_text:"Allow equals"})),o().createElement(ji.j,{checked:!!l,onChange:function(e){s({target:{name:"is_equal",value:Number(e)}}),f(!1)},disabled:c})),o().createElement(De.A.Root,{isOpen:d,onClose:_,position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Content,{className:"allow-equals__definition__wrapper"},o().createElement(sr.D.H4,{className:"allow-equals__definition__title"},o().createElement(J.Localize,{i18n_default_text:"Allow equals"})),o().createElement(Ie.E,{as:"div"},o().createElement(J.Localize,{i18n_default_text:"Win payout if exit spot is also equal to entry spot."}))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Got it"}),onAction:_},className:"allow-equals__button"})))):null}));var Ii=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/text-field/index.js");function Di(){return Di=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Di.apply(null,arguments)}function Mi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ri=function(e){var t=e.classname,r=e.current_index,n=e.header,a=e.is_swipeable,i=e.is_infinite_loop,l=e.onNextButtonClick,c=e.onPreviousButtonClick,s=e.pages,u=e.previous_icon,d=e.title,f=e.next_icon,m=e.setCurrentIndex,p=Mi(o().useState(0),2),y=p[0],_=p[1],v=n,h=void 0!==r&&void 0!==m,b=h?r:y,g="AR"===(0,J.getLanguage)(),E=function(){if(i||!(b+1>=s.length)){var e=(b+1)%s.length;h?null==m||m(e):_(e),null==l||l()}},S=function(){if(i||!(b-1<0)){var e=(b-1+s.length)%s.length;h?null==m||m(e):_(e),null==c||c()}},w=(0,oa.useSwipeable)({onSwipedLeft:E,onSwipedRight:S});return o().createElement(o().Fragment,null,v&&o().createElement(v,{current_index:b,onNextClick:E,onPrevClick:S,previous_icon:u,next_icon:f,title:d}),o().createElement("ul",Di({className:(0,je.A)("carousel",t),"data-testid":"dt_carousel"},a?w:{}),s.map((function(e){var t=e.component,r=e.id;return o().createElement("li",{className:"carousel__item",style:{transform:"translateX(".concat(100*b*(g?1:-1),"%)")},key:r},t)}))))};const Fi=function(e){var t=e.isDays;return o().createElement(De.A.Content,{className:"barrier-params__description-content"},t?o().createElement("div",{className:"content-section"},o().createElement(Ie.E,{bold:!0},o().createElement(J.Localize,{i18n_default_text:"Fixed barrier:"})),o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Barrier set at specific price."}))):o().createElement(o().Fragment,null,o().createElement("div",{className:"content-section"},o().createElement(Ie.E,{bold:!0},o().createElement(J.Localize,{i18n_default_text:"Above spot:"})),o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Barrier set above spot price."}))),o().createElement("div",{className:"content-section"},o().createElement(Ie.E,{bold:!0},o().createElement(J.Localize,{i18n_default_text:"Below spot:"})),o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Barrier set below spot price."}))),o().createElement("div",{className:"content-section"},o().createElement(Ie.E,{bold:!0},o().createElement(J.Localize,{i18n_default_text:"Fixed barrier:"})),o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Barrier set at specific price."})))))};var Ui=r("../../node_modules/@deriv-com/quill-ui/dist/components/Input/text-field-addon/index.js");function qi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bi(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bi(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Vi=[{name:o().createElement(J.Localize,{i18n_default_text:"Above spot"})},{name:o().createElement(J.Localize,{i18n_default_text:"Below spot"})},{name:o().createElement(J.Localize,{i18n_default_text:"Fixed barrier"})}];const Hi=(0,he.observer)((function(e){var t=e.setInitialBarrierValue,r=e.isDays,n=e.onClose,a=(0,ze.P)(),i=a.barrier_1,l=a.onChange,c=a.validation_errors,s=a.tick_data,u=a.setV2ParamsInitialValues,d=qi(o().useState(0),2),f=d[0],m=d[1],p=qi(o().useState(!1),2),y=p[0],_=p[1],v=qi(o().useState(i),2),h=(v[0],v[1]),b="deriv_spot_barrier_value",g="deriv_fixed_barrier_value",E=function(e){try{return localStorage.getItem(e)||""}catch(e){return""}},S=function(e,t){try{localStorage.setItem(e,t)}catch(e){}},w=qi(o().useState(E(b)||""),2),A=w[0],O=w[1],k=qi(o().useState(E(g)||""),2),x=k[0],C=k[1],j=qi(o().useState(!1),2),T=j[0],L=j[1],P=(null!=s?s:{}).pip_size,N=o().useRef(null),I=(null==c?void 0:c.barrier_1.length)>0&&(i||y);o().useEffect((function(){if(t(i),u({name:"barrier_1",value:i}),i.includes("-")){m(1);var e=i.replace(/^[+-]/,"");O(e),A||S(b,e)}else if(i.includes("+")){m(0);var r=i.replace(/^[+-]/,"");O(r),A||S(b,r)}else m(2),C(i),x||S(g,i);l({target:{name:"barrier_1",value:i}})}),[]),o().useEffect((function(){var e=N.current,t=function(){L(!(!e||!e.contains(document.activeElement)))};return document.addEventListener("focusin",t),document.addEventListener("focusout",t),function(){document.removeEventListener("focusin",t),document.removeEventListener("focusout",t)}})),o().useEffect((function(){T&&_(!1)}),[T]);var D=function(e){var t=e.target.value;if(0===f&&(t="+".concat(t)),1===f&&(t="-".concat(t)),0===f||1===f){var r=t.replace(/^[+-]/,"");O(r),S(b,r)}else 2===f&&(C(t),S(g,t));l({target:{name:"barrier_1",value:t}}),u({name:"barrier_1",value:t}),h(t)};return o().createElement(o().Fragment,null,o().createElement(De.A.Content,null,o().createElement("div",{className:"barrier-params"},!r&&o().createElement("div",{className:"barrier-params__chips"},Vi.map((function(e,t){return o().createElement(Qa.v.Selectable,{key:t,onClick:function(){return function(e){var t=f;m(e);var r="";if(0===t||1===t){var n=i.replace(/^[+-]/,"");O(n),S(b,n)}else 2===t&&(C(i),S(g,i));if(0===e||1===e){var o=A||"";r=0===e?"+".concat(o):"-".concat(o)}else 2===e&&(r=x||"");(r.startsWith("+")||r.startsWith("-"))&&"."===r.charAt(1)?r="".concat(r.charAt(0),"0").concat(r.slice(1)):r.startsWith(".")&&(r="0".concat(r)),h(r),l({target:{name:"barrier_1",value:r}})}(t)},selected:t==f},o().createElement(Ie.E,{size:"sm"},e.name))}))),o().createElement("div",null,2===f||r?o().createElement(Ii.A,{customType:"commaRemoval",name:"barrier_1",noStatusIcon:!0,status:I?"error":"neutral",value:i,allowDecimals:!0,decimals:P,allowSign:!1,inputMode:"decimal",regex:/[^0-9.,]/g,textAlignment:"center",onChange:D,placeholder:(0,J.localize)("Price"),variant:"fill",message:I?null==c?void 0:c.barrier_1[0]:"",ref:N}):o().createElement(Ui.M,{fillAddonBorderColor:"var(--semantic-color-slate-solid-surface-frame-mid)",customType:"commaRemoval",name:"barrier_1",noStatusIcon:!0,addonLabel:0==f?"+":"-",decimals:P,value:i.replace(/[+-]/g,""),allowDecimals:!0,inputMode:"decimal",allowSign:!1,status:I?"error":"neutral",onChange:D,placeholder:(0,J.localize)("Distance to spot"),regex:/[^0-9.,]/g,variant:"fill",message:I?null==c?void 0:c.barrier_1[0]:"",ref:N}),(0==(null==c?void 0:c.barrier_1.length)||!I)&&o().createElement("div",{className:"barrier-params__error-area"})),o().createElement("div",{className:"barrier-params__current-spot-wrapper"},o().createElement(Ie.E,{size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Current spot"})),o().createElement(Ie.E,{size:"sm"},null==s?void 0:s.quote)))),o().createElement(De.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){if(0===c.barrier_1.length){if(0===f||1===f){var e=i.replace(/^[+-]/,"");S(b,e)}else 2===f&&S(g,i);n(!0),D({target:{name:"barrier_1",value:i.replace(/[+-]/g,"")}})}else _(!0)}}}))}));var Gi=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCircleInfoMdRegularIcon.js"),Yi=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedArrowLeftMdRegularIcon.js");const Wi=function(e){var t=e.current_index,r=e.onNextClick,n=e.onPrevClick,a=e.previous_icon,i=e.next_icon,l=e.title,c=null!=i?i:Gi.A,s=null!=a?a:Yi.A;return o().createElement(De.A.Header,{className:"carousel-controls",title:l,icon:t?o().createElement(s,{onClick:n}):o().createElement(c,{onClick:r}),iconPosition:t?"left":"right"})};function $i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ki(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ki(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ki(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ji=(0,he.observer)((function(e){var t,r,n=e.is_minimized,a=(0,ze.P)(),i=a.barrier_1,l=a.onChange,c=a.duration_unit,s=a.is_market_closed,u=a.setV2ParamsInitialValues,d=a.v2_params_initial_values,f=a.validation_errors,m=a.proposal_info,p=a.trade_type_tab,y=$i(o().useState(!1),2),_=y[0],v=y[1],h=$i(o().useState(""),2),b=h[0],g=h[1],E="d"==c,S=f.barrier_1.length>0||(null==m||null===(t=m[p])||void 0===t?void 0:t.has_error)&&"barrier"===(null==m||null===(r=m[p])||void 0===r?void 0:r.error_field),w=(0,Dr.d)().addSnackbar,A=$i(o().useState(!1),2),O=A[0],k=A[1],x=o().useCallback((function(){_&&(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||l({target:{name:"barrier_1",value:b}}),u({value:"",name:"barrier_1"}),v(!1))}),[b,_]);o().useEffect((function(){var e,t,r,o=null==m||null===(e=m[p])||void 0===e?void 0:e.has_error,a=null==m||null===(t=m[p])||void 0===t?void 0:t.error_field,i=null==m||null===(r=m[p])||void 0===r?void 0:r.message;!o||"barrier"!==a||O||_||n||(w({message:i,hasCloseButton:!0,status:"fail",style:{marginBottom:"48px"}}),k(!0))}),[m]),o().useEffect((function(){_&&k(!1)}),[_]);var C=[{id:1,component:o().createElement(Hi,{isDays:E,setInitialBarrierValue:g,onClose:x})},{id:2,component:o().createElement(Fi,{isDays:E})}];return o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:(0,je.A)("trade-params__option",n&&"trade-params__option--minimized"),disabled:s,variant:"fill",readOnly:!0,noStatusIcon:!0,label:o().createElement(J.Localize,{i18n_default_text:"Barrier",key:"barrier".concat(n?"-minimized":"")}),value:d.barrier_1||i,onClick:function(){return v(!0)},status:S&&!_?"error":void 0}),o().createElement(De.A.Root,{isOpen:_,onClose:x,position:"left",expandable:!1,shouldBlurOnClose:_},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{header:Wi,title:o().createElement(J.Localize,{i18n_default_text:"Barrier"}),pages:C}))))}));var Xi=(0,he.observer)((function(){var e,t=(0,ze.P)(),r=t.barrier_1,n=t.contract_type,a=t.is_market_closed;return(null===(e=t.proposal_info[n.toUpperCase()])||void 0===e?void 0:e.has_error)?null:o().createElement("div",{className:"barrier-info__container"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(a&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"Barrier"})),r?o().createElement(Ie.E,{size:"sm",bold:!0,className:(0,je.A)(a&&"trade-params__text--disabled")},r):o().createElement(Ce.Skeleton,{width:50,height:14}))}));const Zi=Xi;const Qi=function(e){var t=e.duration_units_list,r=e.onChangeUnit,n=e.unit,a=t.length>1;return a?o().createElement("div",{className:"duration-container__chips"},t.map((function(e,t){return"d"!==e.value&&o().createElement(Qa.v.Selectable,{key:"".concat(e.text,"-").concat(t),selected:n==e.value,className:"duration-container__chips__chip",onClick:function(){return n!==e.value&&r(e.value)}},o().createElement(Ie.E,{size:"sm"},e.text))})),a&&o().createElement(Qa.v.Selectable,{key:"end-time",selected:"d"===n,className:"duration-container__chips__chip",onClick:function(){return r("d")}},o().createElement(Ie.E,{size:"sm"},o().createElement(J.Localize,{i18n_default_text:"End Time"})))):o().createElement(o().Fragment,null)};var el=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/wheel-picker/index.js");function tl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const nl=function(e){var t,r,a=e.setWheelPickerValue,i=e.selected_hour,l=e.selected_time,c=e.duration_min_max,s=tl((0,n.useState)([]),2),u=s[0],d=s[1],f=tl((0,n.useState)([]),2),m=f[0],p=f[1];(0,n.useEffect)((function(){var e=Math.max(c.intraday.min,3600),t=c.intraday.max,r=Math.max(1,Math.ceil(e/3600)),n=Math.floor(t/3600),o=Array.from({length:n-r+1},(function(e,t){return{label:"".concat(t+r," ").concat((0,J.localize)("h")),value:t+r}}));d(o),y(i[0]||r,e,t)}),[c,i]);var y=function(e,t,r){var n=0,o=59;e===Math.ceil(t/3600)&&(n=Math.ceil(t%3600/60)),e===Math.floor(r/3600)&&(o=Math.floor(r%3600/60)),n>0&&3600*e>=t&&(n=0);var a=Array.from({length:o-n+1},(function(e,t){return{label:"".concat(t+n," ").concat((0,J.localize)("min")),value:t+n}}));p(a)},_=function(e,t){var r,n=e.find((function(e){return e.value===t}));return n?n.label:(null===(r=e[0])||void 0===r?void 0:r.label)||"1 ".concat((0,J.localize)("h"))};return o().createElement(el.N,{data:[u,m],defaultValue:[_(u,i[0]),_(m,l[1])],containerHeight:"268px",inputValues:[i[0]||(null===(t=u[0])||void 0===t?void 0:t.value),l[1]||(null===(r=m[0])||void 0===r?void 0:r.value)],setInputValues:function(e,t){a(e,t),0===e&&y(Number(t),c.intraday.min,c.intraday.max)}})};const ol=(0,he.observer)((function(e){var t=e.unit,r=e.setWheelPickerValue,n=e.selected_hour,a=e.selected_time,i=(0,ze.P)(),l=i.duration_min_max,c=i.duration_units_list,s=o().useMemo((function(){return(0,Ve.nw)(t,l)}),[t,l]);return o().createElement("div",{className:(0,je.A)("duration-container__wheel-picker-container",{"duration-container__wheel-picker-container__single":1==c.length&&t!==Ve.mM.DAYS})},t!==Ve.mM.HOURS?o().createElement(el.N,{data:s,defaultValue:[String(a)],containerHeight:t===Ve.mM.DAYS?"228px":1===c.length?"230px":"268px",inputValues:a,setInputValues:r}):o().createElement(nl,{setWheelPickerValue:r,selected_hour:n,selected_time:a,duration_min_max:l}))}));var al=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCalendarSmRegularIcon.js"),il=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedClockThreeSmRegularIcon.js"),ll=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/Calendar/index.js"),cl=r("./src/Stores/Modules/Trading/Helpers/contract-type.ts");function sl(e){return sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sl(e)}function ul(){ul=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==sl(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(sl(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function dl(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function fl(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){dl(a,n,o,i,l,"next",e)}function l(e){dl(a,n,o,i,l,"throw",e)}i(void 0)}))}}function ml(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const yl=function(e){var t=e.start_date,r=e.end_date,a=e.setEndDate,l=ml(o().useState([]),2),c=l[0],s=l[1],u=(0,ze.P)().symbol,d=(0,i.useIsMounted)(),f=o().useCallback(fl(ul().mark((function e(){var t,r,n,o,a,l,c,f=arguments;return ul().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>0&&void 0!==f[0]?f[0]:(0,i.toMoment)().format("YYYY-MM-DD"),r=[],n=[],e.next=5,Promise.all([cl.h.getTradingEvents(t,u),cl.h.getTradingDays(t,u)]);case 5:o=e.sent,a=ml(o,2),l=a[0],(c=a[1])&&(n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((function(e,t){return c.includes(e)?-1:t})).filter((function(e){return-1!==e}))),null==l||l.forEach((function(e){var t=e.dates.split(", ");r.push({dates:t,descrip:e.descrip})})),d()&&s(n);case 12:case"end":return e.stop()}}),e)}))),[d,u]);(0,n.useEffect)((function(){f()}),[]);return o().createElement("div",{className:"duration-datepicker duration-container__date-picker"},o().createElement(ll.l,{className:"date-picker",hasFixedWidth:!1,minDate:new Date(t),maxDate:new Date((new Date).setFullYear((new Date).getFullYear()+1)),view:"month",value:r,tileDisabled:function(e){var t=e.date.getDay();return c.includes(t)},onChange:function(e){e&&e instanceof Date&&a(e)},wrapperClassName:"duration-container__date-picker__sheet"}))};var _l=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/time-wheel-picker/index.js");const vl=function(e){var t=e.end_time,r=e.setEndTime,n=e.current_gmt_time,a=e.adjusted_start_time;return o().createElement("div",{className:"duration-container__time-picker"},o().createElement(_l.I,{is12Hour:!1,startTimeIn24Format:a,minutesInterval:5,selectedTime:t,setSelectedValue:function(e){return r(e)},containerHeight:"256px",hoursInterval:1}),o().createElement("div",{className:"duration-container__endtime"},o().createElement(Kt.O,{color:"quill-typography__color--subtle"},o().createElement(J.Localize,{i18n_default_text:"Current time"})),o().createElement(Ie.E,{size:"sm"},"".concat(n," GMT"))))};var hl=r("./src/Stores/Modules/Trading/Helpers/end-time.ts");function bl(e){return bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bl(e)}function gl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function El(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gl(Object(r),!0).forEach((function(t){Sl(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Sl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=bl(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bl(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bl(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Al(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Al(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Al(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ol=function(e){var t=wl(e.split(":").map(Number),2);return 60*t[0]+t[1]};const kl=function(e){var t,r,a,l,c=e.end_time,u=e.expiry_time_input,d=e.saved_expiry_date_v2,f=e.setEndTime,m=e.setExpiryTimeInput,p=e.setUnsavedExpiryDateV2,y=e.unsaved_expiry_date_v2,_=wl(o().useState(""),2),v=_[0],h=_[1],b=wl(o().useState(!1),2),g=b[0],E=b[1],S=wl(o().useState(!1),2),w=S[0],A=S[1],O=wl((0,n.useState)(!1),2),k=O[0],x=O[1],C=wl((0,n.useState)(!1),2),j=C[0],T=C[1],L=wl((0,n.useState)(new Date(d||y)),2),P=L[0],N=L[1],I=wl((0,n.useState)(),2),D=I[0],M=I[1],z=wl((0,n.useState)(),2),R=z[0],F=z[1],U=(0,s.A)().common,q=wl((0,n.useState)(null),2),B=q[0],V=q[1],H=U.server_time,G=(0,ze.P)(),Y=G.barrier_1,W=G.contract_type,$=G.duration_min_max,K=G.duration_units_list,X=G.duration,Z=G.expiry_date,Q=G.is_turbos,ee=G.market_close_times,te=G.market_open_times,re=G.start_date,ne=G.start_time,oe=G.symbol,ae=G.tick_data,ie=G.trade_types,le=(0,ze.P)(),ce=(0,Dr.d)().addSnackbar,se=El(El({duration_unit:"d",duration:B||X,expiry_type:"duration",contract_type:W,basis:"stake",amount:"5",symbol:oe},D&&{payout_per_point:D}),R&&{barrier:R}),ue=(0,Ve.hi)({new_values:se,trade_store:le,trade_type:Object.keys(ie)[0]}),de=Dt(["proposal",JSON.stringify(B),JSON.stringify(D),JSON.stringify(R)],El(El({},ue),{},{symbol:oe},!Y||Q||R?{}:{barrier:Math.round(null==ae?void 0:ae.quote)}),{enabled:k}).data;(0,n.useEffect)((function(){if(de){var e,t,r,n,a,i,l;if("ContractBuyValidationError"===(null==de||null===(e=de.error)||void 0===e?void 0:e.code)){var c=de.error.details;if("payout_per_point"===(null==c?void 0:c.field)&&null!=c&&c.payout_per_point_choices){var s=null==c?void 0:c.payout_per_point_choices[0];return M(s),void x(!0)}if("barrier"===(null==c?void 0:c.field)&&null!=c&&c.barrier_choices){var u=null==c?void 0:c.barrier_choices[0];return F(u),void x(!0)}}if(null!=de&&null!==(t=de.error)&&void 0!==t&&t.message&&"duration"===(null==de||null===(r=de.error)||void 0===r||null===(n=r.details)||void 0===n?void 0:n.field))ce({message:o().createElement(J.Localize,{i18n_default_text:null==de||null===(i=de.error)||void 0===i?void 0:i.message}),status:"fail",hasCloseButton:!0,style:{marginBottom:"48px"}}),T(!0);else T(!1);if(null!=de&&null!==(a=de.proposal)&&void 0!==a&&a.date_expiry)m(new Date(1e3*(null==de||null===(l=de.proposal)||void 0===l?void 0:l.date_expiry)).toISOString().split("T")[1].substring(0,8));d=["proposal",JSON.stringify(B),JSON.stringify(D),JSON.stringify(R)],f=It(d),Pt[f]=null,x(!1)}var d,f}),[de,m,p]);var fe=(0,i.toMoment)(Z),me=te.map((function(e){return(0,i.setTime)(fe.clone(),e)})),pe=ee.map((function(e){return(0,i.setTime)(fe.clone(),e)})),ye=(0,i.toMoment)(H),_e=(null===(t=(0,hl.h)(ye.clone(),me,pe).start[0])||void 0===t?void 0:t.clone().add(5,"minutes").format("HH:mm"))||(0,Ve.nz)(5),ve=new Date(y).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),he=(new Date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",timeZone:"GMT"});o().useEffect((function(){var e=function(){var e=(new Date).toLocaleTimeString("en-GB",{timeZone:"GMT",hour12:!1});h(e)};e();var t=setInterval(e,1e3);return""!==c&&Ol(c)<Ol(_e)&&5===Math.abs(Ol(_e)-Ol(c))&&!w&&f(_e),function(){return clearInterval(t)}}),[c,_e]),(0,n.useEffect)((function(){ve!==he||c||f(_e)}),[y]);var be,ge,Ee,Se,we,Ae,Oe,ke,xe=(0,i.hasIntradayDurationUnit)(K),Ce=(ge=wl(ve.split(" "),3),Ee=ge[0],Se=ge[1],we=ge[2],Ae=Number(we),Oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(Se.slice(0,3)),ke=Number(Ee),Ae===H.year()&&Oe===H.month()&&ke===H.date());be=(!!re||Ce)&&xe;return o().createElement("div",{className:"duration-container__days-input"},o().createElement(Ii.A,{variant:"fill",readOnly:!0,name:"date","data-testid":"dt_date_input",textAlignment:"center",value:ve,disabled:0===K.filter((function(e){return"d"===e.value})).length,onClick:function(){E(!0)},leftIcon:o().createElement(al.A,{width:24,height:24})}),o().createElement(Ii.A,{variant:"fill",readOnly:!0,textAlignment:"center",name:"time",value:"".concat((be?c:Ce&&u)||"23:59:59"," GMT"),disabled:!be,onClick:function(){A(!0)},leftIcon:o().createElement(il.A,{width:24,height:24})}),o().createElement("div",{className:"duration-container__days-input__expiry"},o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(J.Localize,{i18n_default_text:"Expiry"})),o().createElement(Ie.E,{size:"sm"},"\n                ".concat(ve," ").concat((ve===he?c:u)||"23:59:59"," GMT"))),o().createElement(De.A.Root,{isOpen:g||w,onClose:function(){E(!1),A(!1),T(!1)},position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:g?o().createElement(J.Localize,{i18n_default_text:"Pick an end date"}):o().createElement(J.Localize,{i18n_default_text:"Pick an end time"})}),g&&o().createElement(yl,{start_date:new Date(null===(r=(0,Ve.bg)(K,H,ne,$))||void 0===r||null===(a=r.toISOString())||void 0===a||null===(l=a.split("T"))||void 0===l?void 0:l[0]),end_date:P,setEndDate:function(e){var t=e.getTime()-(new Date).getTime(),r=Math.ceil(t/864e5);if(V(Number(r<=0?1:r)),N(e),r<=0){f(_e);var n=new Date(e),o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),l="".concat(o,"-").concat(a,"-").concat(i);p(l)}else f(""),p("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")));x(!0)}}),w&&o().createElement(vl,{setEndTime:f,end_time:c,current_gmt_time:v,adjusted_start_time:_e}),o().createElement(De.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,isPrimaryButtonDisabled:j,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Done"}),onAction:function(){j||(E(!1),A(!1),new Date(y).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})!==he&&f(""),Ol(_e)>Ol(c)&&f(_e))}}}))))};function xl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var jl=(0,he.observer)((function(e){var t=e.end_time,r=e.expiry_time_string,a=e.saved_expiry_date_v2,i=e.selected_hour,l=e.setEndTime,c=e.setExpiryTimeString,s=e.setSavedExpiryDateV2,u=e.setSelectedHour,d=e.setUnit,f=e.setUnsavedExpiryDateV2,m=e.unit,p=e.unsaved_expiry_date_v2,y=(0,ze.P)(),_=y.duration,v=y.duration_units_list,h=y.onChangeMultiple,b=xl((0,n.useState)([_]),2),g=b[0],E=b[1],S=xl(o().useState(r),2),w=S[0],A=S[1];o().useEffect((function(){f(a||p)}),[]);var O=o().useCallback((function(e){d(e),E([]),e!==Ve.mM.HOURS&&u([])}),[d,u]);return o().createElement("div",{className:"duration-container"},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Duration"})}),o().createElement(Qi,{duration_units_list:v,onChangeUnit:O,unit:m}),m!==Ve.mM.DAYS&&o().createElement(ol,{unit:m,setWheelPickerValue:function(e,t){var r=Number(t);if(m===Ve.mM.HOURS){var n=i;n[e]=r,u(n)}else E([r])},selected_hour:i,selected_time:g}),m===Ve.mM.DAYS&&o().createElement(kl,{end_time:t,expiry_time_input:w,saved_expiry_date_v2:a,setEndTime:l,setExpiryTimeInput:A,setUnsavedExpiryDateV2:f,unsaved_expiry_date_v2:p||a}),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){if(c(w),s(p),m===Ve.mM.HOURS){var e=60*i[0]+i[1],r=Math.floor(_/60);u([r,_%60]),l(""),h({duration_unit:Ve.mM.MINUTES,duration:Number(e),expiry_time:null,expiry_type:"duration"})}else if(m===Ve.mM.DAYS){var n=new Date(p).getTime()-(new Date).getTime(),o=Math.ceil(n/864e5);u([]),t?h({expiry_time:t,expiry_type:"endtime"}):(l(""),h({duration_unit:Ve.mM.DAYS,duration:Number(o),expiry_time:null,expiry_type:"duration"}))}else l(""),u([]),h({duration_unit:m,duration:Number(g),expiry_time:null,expiry_type:"duration"})}}}))}));const Tl=jl;function Ll(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pl(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Nl=(0,he.observer)((function(e){var t,r,a,l,c,u,d=e.is_minimized,f=(0,ze.P)(),m=f.contract_type,p=f.symbol,y=f.duration_min_max,_=f.duration_unit,v=f.duration_units_list,h=f.duration,b=f.expiry_epoch,g=f.expiry_time,E=f.expiry_type,S=f.is_market_closed,w=f.onChangeMultiple,A=f.proposal_info,O=f.saved_expiry_date_v2,k=f.setSavedExpiryDateV2,x=f.setUnsavedExpiryDateV2,C=f.start_time,j=f.trade_type_tab,T=f.trade_types,L=f.unsaved_expiry_date_v2,P=f.validation_errors,N=(0,Dr.d)().addSnackbar,I=null!==(t=(0,i.getUnitMap)()[_])&&void 0!==t?t:{},D=I.name_plural,M=I.name,z=I.name_singular,R=null!==(r=1===h?z:D)&&void 0!==r?r:M,F=Ll((0,n.useState)([]),2),U=F[0],q=F[1],B=Ll((0,n.useState)(!1),2),V=B[0],H=B[1],G=Ll((0,n.useState)(""),2),Y=G[0],W=G[1],$=Ll((0,n.useState)(""),2),K=($[0],$[1]),X=Ll((0,n.useState)(new Date),2),Z=(X[0],X[1]),Q=Ll((0,n.useState)(""),2),ee=Q[0],te=Q[1],re=Ll((0,n.useState)(g?"d":_),2),ne=re[0],oe=re[1],ae=(0,Mt.H1)(T,m,j),ie=(null===(a=A[ae[0]])||void 0===a?void 0:a.has_error)&&"duration"===(null===(l=A[ae[0]])||void 0===l?void 0:l.error_field)||(null!==(c=null==P||null===(u=P.duration)||void 0===u?void 0:u.length)&&void 0!==c?c:0)>0,le=(0,n.useRef)(!0),ce=(0,s.A)(),se=ce.common,ue=ce.client.is_logged_in,de=se.server_time;(0,n.useEffect)((function(){if(b&&"d"!==_&&!O){W("23:59:59");var e=(0,i.getTomorrowDate)(de);K(e),k(e)}if(b&&"d"===_&&!Y){W(new Date(1e3*b).toISOString().split("T")[1].substring(0,8)||"");var t=new Date(1e3*b).toISOString().split("T")[0];K(new Date(1e3*b).toISOString().split("T")[0]),k(t)}}),[b]),(0,n.useEffect)((function(){if("d"==_){var e=new Date;e.setDate(e.getDate()+h),Z(e)}}),[_]),(0,n.useEffect)((function(){if(le.current){var e=setTimeout((function(){le.current=!1}),500);return function(){return clearTimeout(e)}}"d"===_&&Z(new Date);var t=(0,Ve.bg)(v,de,C,y);Z(new Date(t))}),[p,y,v,h,_]),(0,n.useEffect)((function(){if("d"===_){var e=(0,Ve.yv)(y,v);"d"==(null==e?void 0:e.unit)&&Z(new Date);var t=setTimeout((function(){w({duration_unit:null==e?void 0:e.unit,duration:null==e?void 0:e.value,expiry_time:null,expiry_type:"duration"})}),10),r=(0,Ve.bg)(v,de,C,y);return Z(new Date(r)),function(){return clearTimeout(t)}}}),[v,y,p,m]);var fe=o().useCallback((function(){return H(!1)}),[]);(0,n.useEffect)((function(){if(ie&&!d){var e,t=A[ae[0]]||(null==P||null===(e=P.duration)||void 0===e?void 0:e[0]);"duration"===(null==t?void 0:t.error_field)&&N({message:t.message,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,style:{marginBottom:ue?"48px":"-8px",width:"calc(100% - var(--core-spacing-800)"}})}}),[ie,ae[0]]);var me=o().useCallback((function(){if(g)oe("d"),te(g);else if("m"===_&&h>59){var e=Math.floor(h/60),t=h%60;oe("h"),q([e,t])}else q([]),oe(_)}),[h,_,g]);return(0,n.useEffect)((function(){V&&me()}),[V]),o().createElement(o().Fragment,null,o().createElement(Ii.A,{variant:"fill",key:"".concat(h,"-$").concat(_),readOnly:!0,label:o().createElement(J.Localize,{i18n_default_text:"Duration",key:"duration".concat(d?"-minimized":"")}),value:function(){var e=O?new Date(O).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"";if("duration"==E){if("m"===_&&h>59){var t=Math.floor(h/60),r=h%60;return"".concat(t," ").concat(t>1?(0,J.localize)("hours"):(0,J.localize)("hour")," ").concat(r?"".concat(r," ").concat(r>1?(0,J.localize)("minutes"):(0,J.localize)("minute")):""," ")}return"d"===_?e?"".concat((0,J.localize)("Ends on")," ").concat(e,", ").concat(Y||"23:59:59"," GMT"):"":"".concat(h," ").concat(R)}if(g)return"".concat((0,J.localize)("Ends on")," ").concat(e," ").concat(g," GMT")}(),noStatusIcon:!0,disabled:S,className:(0,je.A)("trade-params__option",d&&"trade-params__option--minimized"),onClick:function(){return H(!0)},status:ie?"error":"neutral"}),o().createElement(De.A.Root,{isOpen:V,onClose:fe,position:"left",expandable:!1,shouldBlurOnClose:V},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Tl,{selected_hour:U,setSelectedHour:q,unit:ne,setUnit:oe,expiry_time_string:Y,setExpiryTimeString:W,end_time:ee,setEndTime:te,saved_expiry_date_v2:O,setSavedExpiryDateV2:k,unsaved_expiry_date_v2:L,setUnsavedExpiryDateV2:x}))))}));const Il=Nl;const Dl=function(e){var t=e.classname,r=e.description,n=e.is_custom_description;return r?o().createElement(De.A.Content,{className:(0,je.A)("trade-param-definition",t)},n?r:o().createElement(Ie.E,null,r)):null};var Ml=r("../../node_modules/@deriv-com/quill-ui/dist/components/Atom/WheelPicker/base/index.js"),zl=d()((function(e,t){e(t)}),200);const Rl=function(e){var t=e.accumulator_range_list,r=void 0===t?[]:t,n=e.growth_rate,a=e.maximum_ticks,l=e.setGrowthRate,c=e.setV2ParamsInitialValues,s=e.should_show_details,u=e.tick_size_barrier_percentage,d=o().useRef(),f=o().useRef(n),m=r.map((function(e){return{value:"".concat((0,i.getGrowthRatePercentage)(e),"%")}})),p=[{label:o().createElement(J.Localize,{i18n_default_text:"Barrier"}),value:"".concat(u)},{label:o().createElement(J.Localize,{i18n_default_text:"Max duration"}),value:"".concat(a||0," ").concat(1===a?(0,J.localize)("tick"):(0,J.localize)("ticks"))}];o().useEffect((function(){return!d.current&&n&&(d.current=n,c({value:n,name:"growth_rate"})),function(){d.current&&d.current!==f.current&&l(d.current),zl.cancel()}}),[]);return o().createElement(o().Fragment,null,o().createElement(De.A.Content,{className:"growth-rate__picker"},o().createElement("div",{className:"growth-rate__wheel-picker"},r.length?o().createElement(Ml.I,{data:m,selectedValue:"".concat((0,i.getGrowthRatePercentage)(f.current),"%"),setSelectedValue:function(e){var t=Number(e.slice(0,-1))/100;t!==f.current&&(zl(l,t),f.current=t)}}):o().createElement(Ce.Skeleton,null)),o().createElement("div",{className:"growth-rate__details"},p.map((function(e){var t=e.label,r=e.value;return o().createElement("span",{key:r,className:"growth-rate__details-item"},o().createElement(Ie.E,{color:"quill-typography__color--subtle",size:"sm"},t),o().createElement("div",{className:"growth-rate__details-item-value"},s?o().createElement(Ie.E,{size:"sm"},r):o().createElement(Ce.Skeleton,{height:14,width:75})))})))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){d.current=f.current,c({value:f.current,name:"growth_rate"})}}}))};function Fl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ul(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ul(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ul(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ql=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.accumulator_range_list,a=r.growth_rate,l=r.is_purchase_enabled,c=r.is_trade_enabled,s=r.is_market_closed,u=r.has_open_accu_contract,d=r.maximum_ticks,f=r.onChange,m=r.proposal_info,p=r.setV2ParamsInitialValues,y=r.tick_size_barrier_percentage,_=r.v2_params_initial_values,v=Fl(o().useState(!1),2),h=v[0],b=v[1],g=(0,Ve.Qv)(),E=(null==m?void 0:m[i.CONTRACT_TYPES.ACCUMULATOR])||{},S=c&&!(0,i.isEmptyObject)(m)&&!!E.id&&l,w=(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),A=function(e){f({target:{name:"growth_rate",value:e}})},O=o().useCallback((function(){return b(!1)}),[]),k=[{id:1,component:o().createElement(Rl,{accumulator_range_list:n,maximum_ticks:d,growth_rate:a,setGrowthRate:A,setV2ParamsInitialValues:p,should_show_details:S,tick_size_barrier_percentage:y})},{id:2,component:o().createElement(Dl,{description:o().createElement(J.Localize,{i18n_default_text:"Your stake will grow at {{growth_rate}}% per tick as long as the current spot price remains within {{tick_size_barrier_percentage}} from the previous spot price.",values:{growth_rate:(0,i.getGrowthRatePercentage)(a),tick_size_barrier_percentage:y}})})}];return o().useEffect((function(){var e=null==_?void 0:_.growth_rate;e&&a!==e&&A(e)}),[]),a?o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:w,disabled:u||s,label:o().createElement(J.Localize,{i18n_default_text:"Growth rate",key:"growth-rate".concat(t?"-minimized":"")}),onClick:function(){return b(!0)},readOnly:!0,value:"".concat((0,i.getGrowthRatePercentage)(a),"%"),variant:"fill"}),o().createElement(De.A.Root,{isOpen:h,onClose:O,position:"left",expandable:!1,shouldBlurOnClose:h},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{classname:(0,je.A)("growth-rate__carousel",g&&"growth-rate__carousel--small"),header:Wi,pages:k,title:o().createElement(J.Localize,{i18n_default_text:"Growth rate"})})))):o().createElement("div",{className:w},o().createElement(Ce.Skeleton,null))}));const Bl=ql;const Vl=function(e){var t=e.digit,r=e.digit_stats,n=void 0===r?[]:r,a=e.is_active,i=e.is_disabled,l=e.is_max,c=e.is_min,s=e.onClick,u=n.length?n[t]:null,d=u?100*u/1e3:null,f=d&&!isNaN(d)?parseFloat(d.toFixed(1)):null;return!t&&isNaN(t)?null:o().createElement("div",{key:t,className:"digit"},o().createElement("button",{className:(0,je.A)(a&&"active"),disabled:i,onClick:function(){return null==s?void 0:s(t)},name:"last_digit"},o().createElement(Ie.E,{size:"xl",color:i?"quill-typography__color--disabled":""},t)),f?o().createElement(Kt.O,{size:"sm",className:(0,je.A)("percentage",l&&"percentage--max",c&&"percentage--min"),"data-testid":"dt_digit_stats_percentage"},f,"%"):o().createElement(Be.E.Square,{width:36,height:12,rounded:!0}))};function Hl(e){return function(e){if(Array.isArray(e))return Gl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Gl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gl(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Yl=function(e){var t=e.digits,r=void 0===t?[]:t,n=e.digit_stats,a=e.is_disabled,i=e.onDigitSelect,l=e.selected_digit;return o().createElement("div",{className:"last-digit-prediction__selector"},Hl(Array(2).keys()).map((function(e){return o().createElement("div",{key:e,className:"last-digit-prediction__selector-row"},r.slice(5*e,5*(e+1)).map((function(e){return o().createElement(Vl,{key:e,digit:e,digit_stats:n,is_active:l===e,is_disabled:a,is_max:n[e]===Math.max.apply(Math,Hl(n)),is_min:n[e]===Math.min.apply(Math,Hl(n)),onClick:i})})))})))};function Wl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||$l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $l(e,t){if(e){if("string"==typeof e)return Kl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kl(e,t):void 0}}function Kl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Jl,Xl=function(e){if(Array.isArray(e))return Kl(e)}(Jl=Array(10).keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(Jl)||$l(Jl)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();const Zl=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.digit_stats,a=void 0===n?[]:n,i=r.is_market_closed,l=r.last_digit,c=r.onChange,s=Wl(o().useState(!1),2),u=s[0],d=s[1],f=Wl(o().useState(l),2),m=f[0],p=f[1];o().useEffect((function(){p(l)}),[l]);var y=function(e){c({target:{name:"last_digit",value:e}})},_=o().useCallback((function(){d(!1),p(l)}),[l]);return t?o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:(0,je.A)("trade-params__option","trade-params__option--minimized"),disabled:i,variant:"fill",readOnly:!0,label:o().createElement(J.Localize,{i18n_default_text:"Last digit prediction",key:"last-digit-prediction".concat(t?"-minimized":"")}),value:l,onClick:function(){return d(!0)}}),o().createElement(De.A.Root,{isOpen:u,onClose:_,position:"left",expandable:!1,shouldBlurOnClose:u},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Last digit prediction"})}),o().createElement(De.A.Content,null,o().createElement(Yl,{digits:Xl,digit_stats:a,onDigitSelect:p,selected_digit:m})),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){l!==m&&y(m)}}})))):o().createElement("div",{className:(0,je.A)("last-digit-prediction",i&&"last-digit-prediction--disabled")},o().createElement(Kt.O,{size:"sm",className:"last-digit-prediction__title"},o().createElement(J.Localize,{i18n_default_text:"Last digit prediction"})),o().createElement(Yl,{digits:Xl,digit_stats:a,onDigitSelect:y,selected_digit:l,is_disabled:i}))}));var Ql=d()((function(e,t){e(t)}),200);const ec=function(e){var t=e.multiplier,r=e.multiplier_range_list,a=void 0===r?[]:r,l=e.currency,c=e.commission,s=e.setMultiplier,u=a.map((function(e){return{value:e.text}})),d=o().useRef(t),f=o().useRef(t);(0,n.useEffect)((function(){return function(){d.current&&d.current!==f.current&&s(d.current),Ql.cancel()}}),[]);return o().createElement(o().Fragment,null,o().createElement(De.A.Content,{className:"multiplier__picker"},o().createElement("div",{className:"multiplier__wheel-picker"},u.length?o().createElement(Ml.I,{data:u,selectedValue:"x".concat(f.current),setSelectedValue:function(e){var t=Number(e.slice(1));t!==f.current&&(Ql(s,t),f.current=Number(t))}}):o().createElement(Be.E.Square,null)),o().createElement("div",{className:"multiplier__commission"},o().createElement(Ie.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Commission"})),o().createElement(Ie.E,{size:"sm",as:"div",className:"multiplier__commission-value"},c?o().createElement(o().Fragment,null,(0,i.formatMoney)(l,c,!0)," ",l):o().createElement(Be.E.Square,{width:60,height:14})))),o().createElement(De.A.Footer,{isPrimaryButtonDisabled:!1,shouldCloseOnPrimaryButtonClick:!0,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){d.current=f.current}}}))};function tc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return rc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var nc=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),a=r.multiplier,i=r.multiplier_range_list,l=r.commission,c=r.is_market_closed,s=r.onChange,u=r.currency,d=tc((0,n.useState)(!1),2),f=d[0],m=d[1],p=(0,Ve.Qv)(),y=(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),_=o().useCallback((function(){return m(!1)}),[]),v=[{id:1,component:o().createElement(ec,{multiplier:a,multiplier_range_list:i,currency:u,commission:l,setMultiplier:function(e){s({target:{name:"multiplier",value:e}})}})},{id:2,component:o().createElement(Dl,{description:o().createElement(J.Localize,{i18n_default_text:"Multipliers amplify your potential profit if the market moves in your favour, with losses limited to your initial capital."})})}];return a?o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:y,disabled:c,variant:"fill",readOnly:!0,label:o().createElement(J.Localize,{i18n_default_text:"Multiplier",key:"multiplier".concat(t?"-minimized":"")}),value:"x".concat(a),onClick:function(){return m(!0)}}),o().createElement(De.A.Root,{expandable:!1,isOpen:f,position:"left",onClose:_,shouldBlurOnClose:f},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{classname:(0,je.A)("multiplier__carousel",p&&"multiplier__carousel--small"),header:Wi,pages:v,title:o().createElement(J.Localize,{i18n_default_text:"Multiplier"})})))):o().createElement("div",{className:y},o().createElement(Be.E.Square,null))}));const oc=nc;const ac=(0,he.observer)((function(e){var t,r,n,a,l,c,s=e.is_minimized,u=(0,ze.P)(),d=u.currency,f=u.is_market_closed,m=u.proposal_info,p=null==m||null===(t=m[i.CONTRACT_TYPES.MULTIPLIER.UP])||void 0===t||null===(r=t.cancellation)||void 0===r?void 0:r.ask_price,y=null==m||null===(n=m[i.CONTRACT_TYPES.MULTIPLIER.DOWN])||void 0===n||null===(a=n.cancellation)||void 0===a?void 0:a.ask_price;if((null==m||null===(l=m[i.CONTRACT_TYPES.MULTIPLIER.UP])||void 0===l?void 0:l.has_error)||(null==m||null===(c=m[i.CONTRACT_TYPES.MULTIPLIER.DOWN])||void 0===c?void 0:c.has_error))return null;var _=function(e){return e?o().createElement(Ce.Money,{amount:e,show_currency:!0,currency:d}):o().createElement(Ce.Skeleton,{width:65,height:18})};return s?o().createElement("div",{className:"multipliers-info__container multipliers-info__container--horizontal"},o().createElement("div",{className:"multipliers-info__fee-row"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(f&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"DC Fee"})),o().createElement(Ie.E,{size:"sm",bold:!0,as:"div",className:(0,je.A)(f&&"trade-params__text--disabled")},_(p))),o().createElement("div",{className:"multipliers-info__fee-row"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(f&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"DC Fee"})),o().createElement(Ie.E,{size:"sm",bold:!0,as:"div",className:(0,je.A)(f&&"trade-params__text--disabled")},_(y)))):o().createElement("div",{className:"multipliers-info__container multipliers-info__container--stacked"},o().createElement("div",{className:"multipliers-info__row"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(f&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"DC fee (Up)"})),o().createElement(Ie.E,{size:"sm",bold:!0,as:"div",className:(0,je.A)(f&&"trade-params__text--disabled")},_(p))),o().createElement("div",{className:"multipliers-info__row"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(f&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"DC fee (Down)"})),o().createElement(Ie.E,{size:"sm",bold:!0,as:"div",className:(0,je.A)(f&&"trade-params__text--disabled")},_(y))))}));const ic=(0,he.observer)((function(){var e=(0,ze.P)(),t=e.expiration,r=e.is_market_closed,n=(0,s.A)().common.server_time,a=(0,i.formatDuration)((0,i.getDiffDuration)(Number(null==n?void 0:n.unix()),Number(t)),"HH:mm"),l=a.days,c=a.timestamp,u=(0,i.getDateFromNow)(l,"day","DD MMM YYYY");return o().createElement("div",{className:"multipliers-expiration-info__container"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(r&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"Expires on"})),o().createElement(Ie.E,{size:"sm",bold:!0,className:(0,je.A)(r&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"{{date}} at {{timestamp}}",values:{date:u,timestamp:c}})))}));const lc=(0,he.observer)((function(){var e,t,r=(0,ze.P)(),n=r.currency,a=r.is_market_closed,i=r.proposal_info,l=r.trade_type_tab,c=((null===(e=i[l])||void 0===e?void 0:e.obj_contract_basis)||{}).value,s=null===(t=i[l])||void 0===t?void 0:t.has_error;return o().createElement("div",{className:"payout-info__container"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(a&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"Payout"})),c?o().createElement(Ie.E,{size:"sm",bold:!0,className:(0,je.A)(a&&"trade-params__text--disabled")},o().createElement(Ce.Money,{amount:c,show_currency:!0,currency:n})):s?o().createElement(Ie.E,{size:"sm",bold:!0},"- ",n):o().createElement(Ce.Skeleton,{width:60,height:14}))}));function cc(e){return function(e){if(Array.isArray(e))return dc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||uc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||uc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uc(e,t){if(e){if("string"==typeof e)return dc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dc(e,t):void 0}}function dc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var fc=(0,he.observer)((function(e){var t=e.barrier,r=e.current_payout_per_point,n=e.is_open,a=e.onPayoutPerPointSelect,i=e.onClose,l=e.payout_per_point_list,c=(0,ze.P)(),s=c.trade_types,u=sc(o().useState(r),2),d=u[0],f=u[1],m=sc(o().useState(t),2),p=m[0],y=m[1],_=o().useRef(!1),v={payout_per_point:String(d)},h=(0,Ve.hi)({new_values:v,trade_store:c,trade_type:Object.keys(s)[0]}),b=Dt(["proposal"].concat(cc(Object.entries(v).flat().join("-")),["".concat(t),Object.keys(s)[0],JSON.stringify(h)]),h,{enabled:n}).data;return o().useEffect((function(){b&&function(e){var t=e.error,r=e.proposal,n=(null!=r?r:{}).barrier_spot_distance;n&&!t&&y(n),_.current=!0}(b)}),[b]),o().createElement(o().Fragment,null,o().createElement(De.A.Content,{className:"payout-per-point__wrapper","data-testid":"dt_payout-per-point_wrapper"},o().createElement("div",{className:"payout-per-point__wheel-picker"},o().createElement(Ml.I,{data:l,selectedValue:d,setSelectedValue:function(e){var t=d===e;_.current=t,t||f(e)}})),o().createElement("div",{className:"payout-per-point__barrier"},o().createElement(Ie.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Barrier"})),o().createElement(Ie.E,{size:"sm",as:"div",className:"payout-per-point__barrier__content"},null!=p?p:o().createElement(Ce.Skeleton,{width:90,height:14})))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){_.current&&(a(d),i())}},shouldCloseOnPrimaryButtonClick:!1}))}));const mc=fc;function pc(e){return function(e){if(Array.isArray(e))return vc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||_c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _c(e,t){if(e){if("string"==typeof e)return vc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vc(e,t):void 0}}function vc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var hc=(0,he.observer)((function(e){var t=e.is_minimized,r=yc(o().useState(!1),2),n=r[0],a=r[1],l=(0,ze.P)(),c=l.barrier_1,s=l.currency,u=l.is_market_closed,d=l.payout_choices,f=l.payout_per_point,m=l.setPayoutPerPoint,p=(0,Ve.Qv)(),y=(0,i.getCurrencyDisplayCode)(s),_=pc(d).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return{value:e,label:"".concat(e," ").concat(y)}})),v=o().useCallback((function(){return a(!1)}),[]),h=[{id:1,component:o().createElement(mc,{barrier:c,current_payout_per_point:f,is_open:n,onPayoutPerPointSelect:m,onClose:v,payout_per_point_list:_})},{id:2,component:o().createElement(Dl,{description:o().createElement(J.Localize,{i18n_default_text:"The amount you choose to receive at expiry for every point of change between the final price and the barrier."})})}],b=(0,je.A)("trade-params__option",t&&"trade-params__option--minimized");return f?o().createElement(o().Fragment,null,o().createElement(Ii.A,{disabled:u,className:b,label:o().createElement(J.Localize,{i18n_default_text:"Payout per point",key:"payout-per-point".concat(t?"-minimized":"")}),onClick:function(){return a(!0)},readOnly:!0,variant:"fill",value:"".concat(f," ").concat(y)}),o().createElement(De.A.Root,{isOpen:n,onClose:v,position:"left",expandable:!1,shouldBlurOnClose:n},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{classname:(0,je.A)("payout-per-point__carousel",p&&"payout-per-point__carousel--small"),header:Wi,pages:h,title:o().createElement(J.Localize,{i18n_default_text:"Payout per point"})})))):o().createElement("div",{className:b},o().createElement(Ce.Skeleton,null))}));const bc=hc;var gc=(0,he.observer)((function(){var e,t,r=(0,ze.P)(),n=r.contract_type,a=r.currency,i=r.is_market_closed,l=r.proposal_info,c=n.toUpperCase(),s=((null===(e=l[c])||void 0===e?void 0:e.obj_contract_basis)||{}).value;return(null===(t=l[c])||void 0===t?void 0:t.has_error)?null:o().createElement("div",{className:"payout-per-point-info__container"},o().createElement(Ie.E,{size:"sm",className:(0,je.A)(i&&"trade-params__text--disabled")},o().createElement(J.Localize,{i18n_default_text:"Payout per point"})),s?o().createElement(Ie.E,{size:"sm",bold:!0,className:(0,je.A)(i&&"trade-params__text--disabled")},s," ",a):o().createElement(Ce.Skeleton,{width:100,height:14}))}));const Ec=gc;var Sc=r("../../node_modules/@deriv-com/quill-ui/dist/components/SegmentedControl/single-choice/index.js");function wc(e){return wc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wc(e)}function Ac(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ac(Object(r),!0).forEach((function(t){kc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ac(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function kc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=wc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=wc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wc(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const jc=(0,he.observer)((function(e){var t=e.closeActionSheet,r=(0,ze.P)(),n=r.has_cancellation,a=r.has_take_profit,i=r.has_stop_loss,l=r.cancellation_range_list,c=r.cancellation_duration,s=r.onChangeMultiple,u=(0,Dr.d)().addSnackbar,d=xc(o().useState(n),2),f=d[0],m=d[1],p=xc(o().useState(c),2),y=p[0],_=p[1],v=l.map((function(e){var t=e.text,r=e.value;return{label:(0,Ve._V)({value:t}),value:r}}));return o().createElement(o().Fragment,null,o().createElement("div",{className:"deal-cancellation__container"},o().createElement("div",{className:"deal-cancellation__toggle"},o().createElement(Ie.E,null,o().createElement(J.Localize,{i18n_default_text:"Deal cancellation"})),o().createElement(ji.j,{checked:f,onChange:m})),o().createElement("div",{className:"deal-cancellation__wheel-picker"},l.length?o().createElement(Ml.I,{data:v,disabled:!f,selectedValue:y,setSelectedValue:_}):o().createElement(Be.E.Square,null))),o().createElement(Or.$n,{color:"black-white",size:"lg",label:o().createElement(J.Localize,{i18n_default_text:"Save"}),fullWidth:!0,className:"risk-management__save-button",onClick:function(){n!==f||y!==c?(f&&(a||i)&&u({message:(0,Ve.B1)({has_cancellation:f,has_stop_loss:i,has_take_profit:a,switching_cancellation:!0}),hasCloseButton:!0}),s(Oc(Oc({has_cancellation:f},f?{has_take_profit:!1,has_stop_loss:!1}:{}),{},{cancellation_duration:y})),t()):t()}}))}));function Tc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Lc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Pc=function(e){var t=Tc(o().useState(!1),2),r=t[0],n=t[1],a=Tc(o().useState(!1),2),i=a[0],l=a[1];return o().useEffect((function(){var t,r=function(t){var r=t.target,o="focusin"===t.type;r&&r.id===e&&n(o)},o=function(e){var t=e.target;if(t&&null!=t&&t.height&&null!=t&&t.scale){var r=t.height*t.scale/window.screen.height<.75;l(r)}};return document.addEventListener("focusin",r),document.addEventListener("focusout",r),null===(t=window.visualViewport)||void 0===t||t.addEventListener("resize",o),function(){var e;document.removeEventListener("focusin",r),document.removeEventListener("focusout",r),null===(e=window.visualViewport)||void 0===e||e.removeEventListener("resize",o)}}),[]),{is_key_board_visible:r&&i}};function Nc(e){return Nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nc(e)}function Ic(e){return function(e){if(Array.isArray(e))return Uc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dc(Object(r),!0).forEach((function(t){zc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Nc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Nc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Nc(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Fc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fc(e,t){if(e){if("string"==typeof e)return Uc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Uc(e,t):void 0}}function Uc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const qc=(0,he.observer)((function(e){var t,r,n,a,l,c,s,u=e.classname,d=e.has_save_button,f=void 0===d||d,m=e.has_actionsheet_wrapper,p=void 0===m||m,y=e.initial_error_text,_=e.onActionSheetClose,v=e.parent_ref,h=e.parent_is_api_response_received_ref,b=e.type,g=void 0===b?"take_profit":b,E=(0,ze.P)(),S=E.contract_type,w=E.currency,A=E.has_take_profit,O=E.has_stop_loss,k=E.is_accumulator,x=E.take_profit,C=E.stop_loss,j=E.trade_types,T=E.trade_type_tab,L=E.onChangeMultiple,P=E.validation_params,N="take_profit"===g,I=(0,Mt.H1)(j,S,T),D=$a({error_fields:[g]}).message,M=o().useRef(!1),z=h||M,R=Rc(o().useState(N?A:O),2),F=R[0],U=R[1],q=Rc(o().useState(N?x:C),2),B=q[0],V=q[1],H=Rc(o().useState(""),2),G=H[0],Y=H[1],W=Rc(o().useState(null!==(t=null!=y?y:D)&&void 0!==t?t:""),2),$=W[0],K=W[1],X=Rc(o().useState(10),2),Z=X[0],Q=X[1],ee=o().useRef(null),te=o().useRef(null),re=o().useRef(),ne=(0,i.getDecimalPlaces)(w),oe=(0,i.getCurrencyDisplayCode)(w),ae=p?De.A.Content:"div",ie=null===(r=P[I[0]])||void 0===r||null===(n=r[g])||void 0===n?void 0:n.min,le=null===(a=P[I[0]])||void 0===a||null===(l=a[g])||void 0===l?void 0:l.max,ce=Rc(o().useState({min_value:ie,max_value:le}),2),se=ce[0],ue=ce[1],de=Mc(Mc({},N?{has_take_profit:F}:{has_stop_loss:F}),{},{has_cancellation:!1},N?{take_profit:F?B:""}:{stop_loss:F?B:""}),fe=(0,Ve.hi)({new_values:de,trade_store:E,trade_type:Object.keys(j)[0]});N&&null!==(c=fe.limit_order)&&void 0!==c&&c.stop_loss&&delete fe.limit_order.stop_loss,!N&&null!==(s=fe.limit_order)&&void 0!==s&&s.take_profit&&delete fe.limit_order.take_profit;var me=Dt(["proposal"].concat(Ic(Object.entries(de).flat().join("-")),[Object.keys(j)[0],JSON.stringify(fe)]),fe,{enabled:F}).data,pe=se.min_value&&se.max_value?o().createElement(J.Localize,{i18n_default_text:"Acceptable range: {{min_value}} to {{max_value}} {{currency}}",values:{currency:oe,min_value:se.min_value,max_value:se.max_value}}):"",ye=function(e){var t=e.field_name,r=e.new_value;null!=v&&v.current&&t&&(v.current=Mc(Mc({},v.current),{},zc({},t,r)))},_e=function(e){var t;(z.current=!1,U(e),ye({field_name:N?"has_take_profit":"has_stop_loss",new_value:e}),e)?(clearTimeout(re.current),re.current=(0,Ve.rx)(te.current,ee.current)):(K(""),Y(""),ye({field_name:N?"tp_error_text":"sl_error_text",new_value:""}),null===(t=ee.current)||void 0===t||t.blur())};o().useEffect((function(){me&&function(e){var t,r,n,o=e.error,a=e.proposal,i=null!==(t=null==o?void 0:o.message)&&void 0!==t?t:"",l=(null==o||null===(r=o.details)||void 0===r?void 0:r.field)===g||!(null!=o&&null!==(n=o.details)&&void 0!==n&&n.field);if(Y(l?i:""),ye({field_name:N?"tp_error_text":"sl_error_text",new_value:l?i:""}),!se.min_value||!se.max_value){var c,s,u=null!==(c=null==a||null===(s=a.validation_params)||void 0===s?void 0:s[g])&&void 0!==c?c:{},d=u.min,f=u.max;ue((function(e){return e.min_value!==d&&d||e.max_value!==f&&f?{min_value:d,max_value:f}:e}))}z.current=!0}(me)}),[F,me]);var ve=Pc(g).is_key_board_visible;return o().useEffect((function(){var e;ve&&(null===(e=window)||void 0===e||e.scrollTo({top:225,behavior:"smooth"}))}),[ve]),o().useEffect((function(){K(null!=y?y:"")}),[y]),o().useEffect((function(){ue((function(e){return e.min_value!==ie&&ie||e.max_value!==le&&le?{min_value:ie,max_value:le}:e}))}),[ie,le]),o().useEffect((function(){return function(){return clearTimeout(re.current)}}),[]),o().createElement(o().Fragment,null,o().createElement(ae,{className:(0,je.A)("take-profit__wrapper",u)},o().createElement("div",{className:"take-profit__content"},o().createElement(Ie.E,null,N?o().createElement(J.Localize,{i18n_default_text:"Take profit"}):o().createElement(J.Localize,{i18n_default_text:"Stop loss"})),o().createElement(ji.j,{checked:F,onChange:_e})),o().createElement(De.T,{allowDecimals:!0,customType:"commaRemoval",className:"text-field--custom",disabled:!F,decimals:ne,"data-testid":N?"dt_tp_input":"dt_sl_input",inputMode:"decimal",id:g,message:F&&($||G||pe),minusDisabled:Number(B)-1<=0,name:g,noStatusIcon:!0,onChange:function(e){var t=String(e.target.value);t.length>1&&(t=/^[0-]+$/.test(t)?"0":t.replace(/^0*/,"").replace(/^\./,"0."));var r=t===B;z.current=r,r||(K(""),V(t),ye({field_name:g,new_value:t}))},placeholder:(0,J.localize)("Amount"),ref:ee,regex:/[^0-9.,]/g,status:$||G?"error":"neutral",textAlignment:"center",unitLeft:oe,variant:"fill",value:null!=B?B:"",onBeforeInput:function(e){var t,r,n;[".",","].includes(null!==(t=null===(r=e.nativeEvent)||void 0===r?void 0:r.data)&&void 0!==t?t:"")&&(null!==(n=null==B?void 0:B.length)&&void 0!==n?n:0)<=10?Q(ne?11+ne:10):null!=B&&B.includes(".")||Q(10)},maxLength:Z}),!F&&o().createElement("button",{className:"take-profit__overlay","data-testid":"dt_take_profit_overlay",onClick:function(){return _e(!0)}}),o().createElement("input",{ref:te,style:{height:0,opacity:0,display:"none"},inputMode:"decimal"}),k&&o().createElement(Kt.O,{color:"quill-typography__color--subtle",className:"take-profit__accu-information"},o().createElement(J.Localize,{i18n_default_text:"Note: Cannot be adjusted for ongoing accumulator contracts."}))),f&&o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){if((z.current||!F)&&(!G||!F))if(B||!F){var e=!G&&F;L(Mc(Mc(Mc({},N?{has_take_profit:e}:{has_stop_loss:e}),N?{take_profit:G||"0"===B?"":B}:{stop_loss:G||"0"===B?"":B}),e?{has_cancellation:!1}:{})),_()}else K(N?(0,J.localize)("Please enter a take profit amount."):(0,J.localize)("Please enter a stop loss amount."))}},shouldCloseOnPrimaryButtonClick:!1}))}));function Bc(e){return Bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bc(e)}function Vc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Hc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Bc(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Bc(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Bc(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Wc=(0,he.observer)((function(e){var t,r,n,a,i,l,c=e.closeActionSheet,s=(0,ze.P)(),u=s.has_take_profit,d=s.has_cancellation,f=s.has_stop_loss,m=s.take_profit,p=s.onChangeMultiple,y=s.stop_loss,_=s.validation_errors,v=(0,Dr.d)().addSnackbar,h=Gc(o().useState(null!==(t=null==_||null===(r=_.take_profit)||void 0===r?void 0:r[0])&&void 0!==t?t:""),2),b=h[0],g=h[1],E=o().useRef({has_take_profit:u,take_profit:m,tp_error_text:null==_||null===(n=_.take_profit)||void 0===n?void 0:n[0]}),S=o().useRef(!1),w=Gc(o().useState(null!==(a=null==_||null===(i=_.stop_loss)||void 0===i?void 0:i[0])&&void 0!==a?a:""),2),A=w[0],O=w[1],k=o().useRef({has_stop_loss:f,stop_loss:y,sl_error_text:null==_||null===(l=_.stop_loss)||void 0===l?void 0:l[0]}),x=o().useRef(!1);return o().createElement("div",{className:"risk-management__tp-sl__wrapper"},o().createElement(qc,{classname:"risk-management__tp-sl",has_save_button:!1,has_actionsheet_wrapper:!1,initial_error_text:b,onActionSheetClose:c,parent_ref:E,parent_is_api_response_received_ref:S}),o().createElement(qc,{classname:"risk-management__tp-sl",has_save_button:!1,has_actionsheet_wrapper:!1,initial_error_text:A,onActionSheetClose:c,parent_ref:k,parent_is_api_response_received_ref:x,type:"stop_loss"}),o().createElement(Or.$n,{color:"black-white",size:"lg",label:o().createElement(J.Localize,{i18n_default_text:"Save"}),fullWidth:!0,className:"risk-management__save-button",onClick:function(){if((S.current||!E.current.has_take_profit)&&(x.current||!k.current.has_stop_loss)){var e=E.current,t=e.has_take_profit,r=e.take_profit,n=e.tp_error_text,a=k.current,i=a.has_stop_loss,l=a.stop_loss,s=a.sl_error_text,u=!r&&t,f=!l&&i;if(u&&g(o().createElement(J.Localize,{i18n_default_text:"Please enter a take profit amount."})),f&&O(o().createElement(J.Localize,{i18n_default_text:"Please enter a stop loss amount."})),!(n&&t||s&&i||f||u)){var m=!n&&t,y=!s&&i;(m||y)&&d&&v({message:(0,Ve.B1)({has_cancellation:d,has_stop_loss:y,has_take_profit:m,switching_tp_sl:!0}),hasCloseButton:!0}),p(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vc(Object(r),!0).forEach((function(t){Hc(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vc(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({has_take_profit:t,take_profit:n||"0"===r?"":r,has_stop_loss:i,stop_loss:s||"0"===l?"":l},m||y?{has_cancellation:!1}:{})),c()}}}}))}));const $c=Wc;function Kc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Jc(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jc(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Xc=function(e){var t=e.closeActionSheet,r=e.initial_tab_index,n=void 0===r?0:r,a=e.should_show_deal_cancellation,i=Kc(o().useState(n),2),l=i[0],c=i[1];return o().createElement(De.A.Content,{className:"risk-management__picker"},a&&o().createElement(Sc.v,{hasContainerWidth:!0,onChange:c,options:[{label:o().createElement(J.Localize,{i18n_default_text:"TP & SL"})},{label:o().createElement(J.Localize,{i18n_default_text:"Deal cancellation"})}],size:"sm",selectedItemIndex:l}),l?o().createElement(jc,{closeActionSheet:t}):o().createElement($c,{closeActionSheet:t}))};var Zc=r("../../node_modules/@deriv-com/quill-ui/dist/components/SectionMessage/index.js");const Qc=function(e){var t=e.should_show_deal_cancellation,r=[{definition:o().createElement(J.Localize,{i18n_default_text:"When your profit reaches or exceeds this amount, your trade will be closed automatically."}),is_displayed:!0,label:o().createElement(J.Localize,{i18n_default_text:"Take Profit"})},{definition:o().createElement(J.Localize,{i18n_default_text:"When your loss reaches or exceeds this amount, your trade will be closed automatically."}),is_displayed:!0,label:o().createElement(J.Localize,{i18n_default_text:"Stop loss"})},{definition:o().createElement(J.Localize,{i18n_default_text:"When this is active, you can cancel your trade within the chosen time frame. Your stake will be returned without loss."}),is_displayed:t,label:o().createElement(J.Localize,{i18n_default_text:"Deal cancellation"})}];return o().createElement(o().Fragment,null,r.map((function(e){var t=e.definition,r=e.is_displayed,n=e.label;return r&&o().createElement(o().Fragment,{key:t.props.i18n_default_text},o().createElement(Ie.E,{bold:!0},n),o().createElement(Ie.E,{className:"risk-management__description__definition"},t))})),t&&o().createElement(Zc.H,{message:o().createElement(J.Localize,{i18n_default_text:"Take profit and/or stop loss are not available while deal cancellation is active."}),size:"sm",status:"info"}))};function es(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ts(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ts(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var rs=(0,he.observer)((function(e){var t=e.is_minimized,r=es(o().useState(!1),2),n=r[0],a=r[1],l=(0,ze.P)(),c=l.cancellation_range_list,s=l.cancellation_duration,u=l.currency,d=l.has_cancellation,f=l.has_take_profit,m=l.has_stop_loss,p=l.is_market_closed,y=l.take_profit,_=l.stop_loss,v=$a({error_fields:["stop_loss","take_profit"]}).is_error_matching_field,h=o().useCallback((function(){return a(!1)}),[]),b=(0,Ve.Qv)(),g=(null==c?void 0:c.length)>0,E=(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),S=[{id:1,component:o().createElement(Xc,{closeActionSheet:h,initial_tab_index:Number(d),should_show_deal_cancellation:g})},{id:2,component:o().createElement(Dl,{classname:"risk-management__description",description:o().createElement(Qc,{should_show_deal_cancellation:g}),is_custom_description:!0})}];return o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:E,disabled:p,label:o().createElement(J.Localize,{i18n_default_text:"Risk management",key:"risk-management".concat(t?"-minimized":"")}),onClick:function(){return a(!0)},readOnly:!0,value:d?"DC: ".concat((0,Ve._V)({value:s,unit:(0,J.localize)("minutes")})):f&&m?"TP: ".concat(y," ").concat((0,i.getCurrencyDisplayCode)(u)," / SL: ").concat(_," ").concat((0,i.getCurrencyDisplayCode)(u)):f?"TP: ".concat(y," ").concat((0,i.getCurrencyDisplayCode)(u)):m?"SL: ".concat(_," ").concat((0,i.getCurrencyDisplayCode)(u)):"-",variant:"fill",status:v?"error":"neutral"}),o().createElement(De.A.Root,{isOpen:n,onClose:h,position:"left",expandable:!1,shouldBlurOnClose:n},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{classname:(0,je.A)("risk-management__carousel",b&&"risk-management__carousel--small"),header:Wi,pages:S,title:o().createElement(J.Localize,{i18n_default_text:"Risk management"})}))))}));const ns=rs;function os(e){return function(e){if(Array.isArray(e))return as(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return as(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?as(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function as(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var is=function(e){var t,r=e.trade_store,n=e.proposal_request_values,o=e.contract_type,a=e.contract_types,i=e.is_enabled,l=(0,Ve.hi)({new_values:n,trade_store:r,trade_type:o}),c=n?Object.entries(n):[],s=["proposal"].concat(os(c.flat().join("-")),["".concat(null!==(t=null==n?void 0:n.amount)&&void 0!==t?t:""),JSON.stringify(l),a.join("-")]);return Dt(s,l,{enabled:i})},ls=r("./src/Stores/Modules/Trading/Helpers/proposal.ts");function cs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ss(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ss(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ss(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const us=function(e){var t=e.contract_type,r=e.contract_types,n=e.currency,a=e.details,l=e.has_stop_loss,c=e.is_loading_proposal,s=e.is_multiplier,u=e.is_empty,d=e.should_show_payout_details,f=cs(o().useState({is_first_payout_exceeded:!1,is_second_payout_exceeded:!1,commission:"",first_contract_payout:"",max_payout:"",second_contract_payout:"",stop_out:""}),2),m=f[0],p=f[1];o().useEffect((function(){var e=function(e,t){return"-"===t&&c||!e||u?"-":(0,i.formatMoney)(n,Number(e),!0)},t=m.commission,r=m.first_contract_payout,o=m.is_first_payout_exceeded,l=m.is_second_payout_exceeded,s=m.second_contract_payout,d=m.stop_out,f=m.max_payout,y=e(Math.abs(Number(a.commission)),t),_=e(a.first_contract_payout,r),v=e(a.second_contract_payout,s),h=e(Math.abs(Number(a.stop_out)),d),b=e(a.max_payout,f);t===y&&r===_&&m.is_first_payout_exceeded===o&&m.is_second_payout_exceeded===l&&s===v&&d===h&&f===b||p({commission:y,first_contract_payout:_,is_first_payout_exceeded:o,is_second_payout_exceeded:l,second_contract_payout:v,stop_out:h,max_payout:b})}),[n,a,m,c,u]);var y=o().createElement(J.Localize,{i18n_default_text:"Payout"}),_=[{is_displayed:!l&&s&&!d,label:o().createElement(J.Localize,{i18n_default_text:"Stop out"}),value:m.stop_out},{is_displayed:s&&!d,label:o().createElement(J.Localize,{i18n_default_text:"Commission"}),value:m.commission},{is_displayed:!!a.max_payout&&d,label:o().createElement(J.Localize,{i18n_default_text:"Max payout"}),value:(0,i.formatMoney)(n,+a.max_payout,!0)},{contract_type:(0,i.getTradeTypeName)(r[0],{isHighLow:t===i.TRADE_TYPES.HIGH_LOW}),is_displayed:!!r.length&&d,label:y,has_error:a.is_first_payout_exceeded,value:m.first_contract_payout},{contract_type:(0,i.getTradeTypeName)(r[1],{isHighLow:t===i.TRADE_TYPES.HIGH_LOW}),is_displayed:r.length>1&&d,label:y,has_error:a.is_second_payout_exceeded,value:m.second_contract_payout}];return o().createElement("div",{className:"stake-content__details"},_.map((function(e,t){var r=e.contract_type,a=e.is_displayed,l=e.label,c=e.has_error,s=e.value;return a&&o().createElement("div",{key:"".concat(t,"_").concat(s),className:(0,je.A)("stake-content__details-row",c&&"error")},o().createElement(Ie.E,{size:"sm"},l,r&&" (".concat(r,")")),o().createElement(Ie.E,{size:"sm"},s," ",(0,i.getCurrencyDisplayCode)(n)))})))};function ds(e){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ds(e)}function fs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ms(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ms(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ms(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ps(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ps(Object(r),!0).forEach((function(t){_s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ps(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=ds(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ds(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ds(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var vs=function(e,t){switch(t.type){case"SET_PROPOSAL_VALUES":return ys(ys({},e),{},{proposal_request_values:ys(ys({},e.proposal_request_values),t.payload)});case"SET_STAKE_ERROR":return ys(ys({},e),{},{stake_error:t.payload});case"SET_FE_STAKE_ERROR":return ys(ys({},e),{},{fe_stake_error:t.payload});case"UPDATE_DETAILS":return ys(ys({},e),{},{details:ys(ys({},e.details),t.payload)});case"SET_MAX_LENGTH":return ys(ys({},e),{},{max_length:t.payload});case"RESET_ERRORS":return ys(ys({},e),{},{stake_error:"",fe_stake_error:""});default:return e}},hs=function(e,t){var r,n=e.amount,o=e.commission,a=e.contract_type,i=e.trade_type_tab,l=e.trade_types,c=e.proposal_info,s=e.validation_params,u=e.stop_out,d=(0,Mt.H1)(l,a,i),f=(0,Ve.Nw)(c[d[0]]),m=f.contract_payout,p=f.max_payout,y=f.error,_=(0,Ve.Nw)(c[d[1]]),v=_.contract_payout,h=_.error,b=(null!==(r=s[d[0]]||s[d[1]])&&void 0!==r?r:{}).stake,g=null!=b?b:{},E=g.max,S=void 0===E?0:E,w=g.min,A=void 0===w?0:w;return{proposal_request_values:{amount:n},stake_error:"",fe_stake_error:"",max_length:bs(n,t),details:{commission:o,error_1:y,error_2:h,first_contract_payout:m,second_contract_payout:v,is_first_payout_exceeded:!!y&&m>p,is_second_payout_exceeded:!!h&&v>p,max_payout:p,max_stake:S,min_stake:A,stop_out:u}}},bs=function(e,t){return String(e).includes(".")||String(e).includes(",")?11+t:10},gs=(0,he.observer)((function(e){var t=e.onClose,r=e.is_open,n=(0,ze.P)(),a=n.contract_type,l=n.currency,c=n.barrier_1,s=n.has_stop_loss,u=n.is_accumulator,d=n.is_multiplier,f=n.is_turbos,m=n.is_vanilla,p=n.onChange,y=n.trade_type_tab,_=n.trade_types,v=(0,i.getDecimalPlaces)(l),h=fs(o().useReducer(vs,null,(function(){return hs(n,v)})),2),b=h[0],g=h[1],E=b.proposal_request_values,S=b.stake_error,w=b.fe_stake_error,A=b.details,O=o().useMemo((function(){return(0,Mt.H1)(_,a,y)}),[_,a,y]),k=!(u||d||f||m),x="stake_input",C=Pc(x).is_key_board_visible;o().useEffect((function(){var e;C&&(null===(e=window)||void 0===e||e.scrollTo({top:225,behavior:"smooth"}))}),[C]),o().useEffect((function(){var e=hs(n,v);g({type:"SET_PROPOSAL_VALUES",payload:e.proposal_request_values}),g({type:"UPDATE_DETAILS",payload:e.details})}),[]);var j=O.length>1&&!d,T=!!A.error_1&&!!A.error_2,L=!j||j&&T,P=is({trade_store:n,proposal_request_values:E,contract_type:O[0],contract_types:O,is_enabled:r}),N=P.data,I=P.is_fetching,D=is({trade_store:n,proposal_request_values:E,contract_type:O[1],contract_types:O,is_enabled:r&&j}),M=D.data,z=D.is_fetching,R=I||j&&z,F=function(e,t){var r,o,a,i,l,s,u,p=e.error,y=e.proposal;if(""!==E.amount){if(m&&null!=p&&null!==(r=p.details)&&void 0!==r&&r.barrier_choices){var _=p.details.barrier_choices;if(null==_||!_.includes(c)){var v=Math.floor(_.length/2);return void g({type:"SET_PROPOSAL_VALUES",payload:{barrier_1:_[v]}})}}if(f&&null!=p&&null!==(o=p.details)&&void 0!==o&&o.payout_per_point_choices&&"payout_per_point"===(null==p||null===(a=p.details)||void 0===a?void 0:a.field)){var h=p.details.payout_per_point_choices,b=Math.floor(h.length/2);g({type:"SET_PROPOSAL_VALUES",payload:{payout_per_point:h[b]}})}else{var S=null!==(i=null==p?void 0:p.message)&&void 0!==i?i:"",w=["amount","stake"].includes(null!==(l=null==p||null===(s=p.details)||void 0===s?void 0:s.field)&&void 0!==l?l:"")||!(null!=p&&null!==(u=p.details)&&void 0!==u&&u.field);if(g({type:"SET_STAKE_ERROR",payload:w?S:""}),k){var O=(0,ls.vL)(n,e),x=(0,Ve.Nw)(O),C=x.contract_payout,j=x.max_payout,T=x.error;g({type:"UPDATE_DETAILS",payload:ys(ys({},j?{max_payout:j}:{}),{},_s(_s(_s({},"".concat(t,"_contract_payout"),C||0),"is_".concat(t,"_payout_exceeded"),!!T&&C>j),"error_".concat("first"===t?1:2),T))})}else{if((!A.min_stake||!A.max_stake)&&null!=p&&p.details){var L=p.details,P=L.max_stake,N=L.min_stake;P&&N&&g({type:"UPDATE_DETAILS",payload:{max_stake:P,min_stake:N}})}if(y){var I,D,M=y,z=M.commission,R=M.limit_order,F=M.validation_params,U=null!==(I=null==F?void 0:F.stake)&&void 0!==I?I:{},q=U.max,B=U.min,V=(null!==(D=null==R?void 0:R.stop_out)&&void 0!==D?D:{}).order_amount;g({type:"UPDATE_DETAILS",payload:ys(ys({},d&&z&&V?{commission:z,stop_out:V}:{}),A.max_stake||A.min_stake?{}:{max_stake:q,min_stake:B})})}else!y&&d&&g({type:"UPDATE_DETAILS",payload:{commission:0,stop_out:0}})}}}else g({type:"SET_STAKE_ERROR",payload:""})};o().useEffect((function(){N&&F(N,"first")}),[N]),o().useEffect((function(){M&&F(M,"second")}),[M]);return o().createElement(o().Fragment,null,o().createElement(De.A.Content,{className:"stake-content"},o().createElement(De.T,{allowDecimals:!0,allowSign:!1,className:"text-field--custom",customType:"commaRemoval","data-testid":"dt_input_with_steppers",decimals:v,inputMode:"decimal",id:x,maxLength:b.max_length,message:w||L&&S||!!A.min_stake&&!!A.max_stake&&o().createElement(J.Localize,{i18n_default_text:"Acceptable range: {{min_stake}} to {{max_stake}} {{currency}}",values:{currency:(0,i.getCurrencyDisplayCode)(l),min_stake:(0,i.formatMoney)(l,+A.min_stake,!0),max_stake:(0,i.formatMoney)(l,+A.max_stake,!0)}}),minusDisabled:Number(E.amount)-1<=0,name:"amount",noStatusIcon:!0,onChange:function(e){var t=String(e.target.value);(g({type:"SET_MAX_LENGTH",payload:bs(t,v)}),t.endsWith(".")||t.endsWith(","))?g({type:"SET_FE_STAKE_ERROR",payload:(0,J.localize)("Should be a valid number.")}):t===String(E.amount)||(g({type:"RESET_ERRORS"}),g({type:"SET_PROPOSAL_VALUES",payload:{amount:t}}))},onBeforeInput:function(e){var t,r,n,o;[".",","].includes(null!==(t=null===(r=e.nativeEvent)||void 0===r?void 0:r.data)&&void 0!==t?t:"")&&(null!==(n=null===(o=String(E.amount))||void 0===o?void 0:o.length)&&void 0!==n?n:0)<=10&&g({type:"SET_MAX_LENGTH",payload:v?11+v:10})},placeholder:(0,J.localize)("Amount"),regex:/[^0-9.,]/g,status:w||L&&S?"error":"neutral",textAlignment:"center",unitLeft:(0,i.getCurrencyDisplayCode)(l),value:E.amount,variant:"fill"}),o().createElement(us,{contract_type:a,contract_types:O,currency:l,details:A,has_stop_loss:s,is_loading_proposal:R,is_multiplier:d,is_empty:!E.amount,should_show_payout_details:k})),o().createElement(De.A.Footer,{alignment:"vertical",shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){I||j&&z||L&&S||w||(""!==E.amount?(p({target:{name:"amount",value:E.amount}}),t()):g({type:"SET_FE_STAKE_ERROR",payload:(0,J.localize)("Amount is a required field.")}))}}}))}));const Es=gs;function Ss(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ws(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ws(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ws(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var As=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.amount,a=r.currency,l=r.contract_type,c=r.has_open_accu_contract,s=r.is_market_closed,u=r.is_multiplier,d=r.trade_types,f=r.trade_type_tab,m=r.proposal_info,p=$a({error_fields:["stake","amount"]}).is_error_matching_field,y=Ss(o().useState(!1),2),_=y[0],v=y[1],h=(0,Mt.H1)(d,l,f),b=h.every((function(e){var t;return null==m||null===(t=m[e])||void 0===t?void 0:t.has_error})),g=1===h.length||u||b,E=o().useCallback((function(){return v(!1)}),[]);return o().createElement(o().Fragment,null,o().createElement(Ii.A,{disabled:c||s,variant:"fill",readOnly:!0,label:o().createElement(J.Localize,{i18n_default_text:"Stake",key:"stake".concat(t?"-minimized":"")}),noStatusIcon:!0,onClick:function(){return v(!0)},value:"".concat(n," ").concat((0,i.getCurrencyDisplayCode)(a)),className:(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),status:p&&g?"error":"neutral"}),o().createElement(De.A.Root,{isOpen:_,onClose:E,position:"left",expandable:!1,shouldBlurOnClose:_},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Stake"})}),o().createElement(Es,{onClose:E,is_open:_}))))}));const Os=As;var ks=d()((function(e,t){return t(e)}),200);const xs=function(e){var t=e.current_strike,r=e.currency,n=e.onStrikePriceSelect,a=e.payout_per_point,i=e.strike_price_list,l=e.setV2ParamsInitialValues,c=o().useRef(),s=o().useRef(t);return o().useEffect((function(){return!c.current&&t&&(c.current=t,l({value:t,name:"strike"})),function(){c.current&&c.current!==s.current&&n(c.current),ks.cancel()}}),[]),o().createElement(o().Fragment,null,o().createElement(De.A.Content,{className:"strike__wrapper","data-testid":"dt_strike_wrapper"},o().createElement("div",{className:"strike__wheel-picker"},o().createElement(Ml.I,{data:i,selectedValue:s.current,setSelectedValue:function(e){e!==s.current&&(s.current=e,ks(e,n))}})),o().createElement("div",{className:"strike__payout"},o().createElement(Ie.E,{color:"quill-typography__color--subtle",size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Payout per point:"})),o().createElement(Ie.E,{size:"sm",as:"div",className:"strike__payout__content"},a?o().createElement(o().Fragment,null,a," ",r):o().createElement(Ce.Skeleton,{width:90,height:14})))),o().createElement(De.A.Footer,{alignment:"vertical",primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){c.current=s.current,l({value:s.current,name:"strike"})}}}))};function Cs(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return js(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?js(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function js(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Ts=(0,he.observer)((function(e){var t,r,n=e.is_minimized,a=Cs(o().useState(!1),2),l=a[0],c=a[1],s=(0,ze.P)(),u=s.barrier_1,d=s.barrier_choices,f=s.contract_type,m=s.currency,p=s.is_market_closed,y=s.onChange,_=s.proposal_info,v=s.setV2ParamsInitialValues,h=s.v2_params_initial_values,b=(0,Ve.Qv)(),g=d.map((function(e){return{value:e}})),E=(0,i.isEmptyObject)(_)?"":null===(t=_[f.toUpperCase()])||void 0===t||null===(r=t.obj_contract_basis)||void 0===r?void 0:r.value,S=function(e){return y({target:{name:"barrier_1",value:e}})},w=o().useCallback((function(){return c(!1)}),[]),A=[{id:1,component:o().createElement(xs,{current_strike:u,currency:(0,i.getCurrencyDisplayCode)(m),onStrikePriceSelect:S,payout_per_point:E,strike_price_list:g,setV2ParamsInitialValues:v})},{id:2,component:o().createElement(Dl,{description:o().createElement(o().Fragment,null,o().createElement("p",null,o().createElement(J.Localize,{i18n_default_text:"It is the price where you can start receiving a payout from an option."})),o().createElement("br",null),o().createElement("p",null,o().createElement(J.Localize,{i18n_default_text:"For a Call option, you receive a payout if the final price is higher than the strike price."})),o().createElement("br",null),o().createElement("p",null,o().createElement(J.Localize,{i18n_default_text:"For a Put option, you receive a payout if the final price is lower than the strike price."})))})}],O=(0,je.A)("trade-params__option",n&&"trade-params__option--minimized");return o().useEffect((function(){var e=null==h?void 0:h.strike;e&&u!==e&&S(e)}),[]),u?o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:O,disabled:p,label:o().createElement(J.Localize,{i18n_default_text:"Strike price",key:"strike".concat(n?"-minimized":"")}),onClick:function(){return c(!0)},readOnly:!0,variant:"fill",value:u}),o().createElement(De.A.Root,{isOpen:l,onClose:w,position:"left",expandable:!1,shouldBlurOnClose:l},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{classname:(0,je.A)("strike__carousel",b&&"strike__carousel--small"),header:Wi,pages:A,title:o().createElement(J.Localize,{i18n_default_text:"Strike price"})})))):o().createElement("div",{className:O},o().createElement(Ce.Skeleton,null))}));const Ls=Ts;function Ps(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ns(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ns(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Is=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.currency,a=r.has_open_accu_contract,l=r.has_take_profit,c=r.is_market_closed,s=r.take_profit,u=$a({error_fields:["take_profit"]}).is_error_matching_field,d=Ps(o().useState(!1),2),f=d[0],m=d[1],p=o().useCallback((function(){return m(!1)}),[]),y=[{id:1,component:o().createElement(qc,{onActionSheetClose:p})},{id:2,component:o().createElement(Dl,{description:o().createElement(J.Localize,{i18n_default_text:"When your profit reaches or exceeds the set amount, your trade will be closed automatically."})})}];return o().createElement(o().Fragment,null,o().createElement(Ii.A,{className:(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),disabled:a||c,label:o().createElement(J.Localize,{i18n_default_text:"Take profit",key:"take-profit".concat(t?"-minimized":"")}),onClick:function(){return m(!0)},readOnly:!0,variant:"fill",value:l&&s?"".concat(s," ").concat((0,i.getCurrencyDisplayCode)(n)):"-",status:u?"error":"neutral"}),o().createElement(De.A.Root,{isOpen:f,onClose:p,position:"left",expandable:!1,shouldBlurOnClose:f},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(Ri,{header:Wi,pages:y,title:o().createElement(J.Localize,{i18n_default_text:"Take profit"})}))))}));const Ds=Is;function Ms(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return zs(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Rs=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.contract_type,a=r.is_market_closed,i=r.onChange,l=r.trade_type_tab,c=r.setTradeTypeTab,s=(0,Ve.FN)(n),u=0;"VANILLALONGPUT"===l&&"vanillalongcall"===n||"TURBOSSHORT"===l&&"turboslong"===n||(u=s.findIndex((function(e){return l?e.contract_type===l:e.value===n})));var d=u<0?0:u,f=Ms(o().useState(d),2),m=f[0],p=f[1];return o().useEffect((function(){var e;p(d),c(null===(e=s[d])||void 0===e?void 0:e.contract_type)}),[s,d]),s.length?o().createElement(Sc.v,{className:(0,je.A)("trade-params__option",t&&"trade-params__option--minimized"),hasContainerWidth:!0,onChange:function(e){var t,r=null!==(t=s[e])&&void 0!==t?t:{},o=r.contract_type,a=r.value;p(e),c(o),a!==n&&i({target:{name:"contract_type",value:a}})},options:s.map((function(e){var t=e.label;return{disabled:a,label:t}})),selectedItemIndex:m,key:"".concat(m).concat(a)}):null}));const Fs=Rs;var Us=(0,he.observer)((function(e){var t=e.is_minimized,r=(0,ze.P)(),n=r.contract_type,a=r.has_cancellation,i=r.symbol,l=function(e){return Xe({component_key:e,contract_type:n,has_cancellation:a,symbol:i})};return o().createElement("div",{className:(0,je.A)("trade-params__options__wrapper",t&&"trade-params__options__wrapper--minimized")},t&&o().createElement(o().Fragment,null,l("expiration")&&o().createElement(ic,null),l("payout_per_point_info")&&o().createElement(Ec,null),l("allow_equals")&&o().createElement(Ni,null),l("payout")&&o().createElement(lc,null)),o().createElement("div",{className:(0,je.A)("trade-params__options__wrapper",t&&"trade-params__options__wrapper--horizontal")},l("trade_type_tabs")&&o().createElement(Fs,{is_minimized:t}),l("last_digit")&&o().createElement(Zl,{is_minimized:t}),l("duration")&&o().createElement(Il,{is_minimized:t}),l("strike")&&o().createElement(Ls,{is_minimized:t}),l("barrier")&&o().createElement(Ji,{is_minimized:t}),l("growth_rate")&&o().createElement(Bl,{is_minimized:t}),l("multiplier")&&o().createElement(oc,{is_minimized:t}),l("stake")&&o().createElement(Os,{is_minimized:t}),l("payout_per_point")&&o().createElement(bc,{is_minimized:t}),l("allow_equals")&&!t&&o().createElement(Ni,null),l("take_profit")&&o().createElement(Ds,{is_minimized:t}),l("risk_management")&&o().createElement(ns,{is_minimized:t}),l("expiration")&&!t&&o().createElement(ic,null),l("accu_info_display")&&!t&&o().createElement(Ci,null),l("barrier_info")&&!t&&o().createElement(Zi,null),l("payout_per_point_info")&&!t&&o().createElement(Ec,null),l("payout")&&!t&&o().createElement(lc,null)),l("mult_info_display")&&o().createElement(ac,{is_minimized:t}))}));const qs=Us;var Bs=r("./src/Modules/Trading/Helpers/digits.ts"),Vs=r("./src/Modules/SmartChart/index.js"),Hs=r("./src/Modules/SmartChart/Components/Markers/accumulators-chart-elements.tsx"),Gs=r("./src/Modules/SmartChart/Components/toolbar-widgets.tsx");function Ys(e){return Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ys(e)}function Ws(){Ws=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),l=new T(n||[]);return o(i,"_invoke",{value:k(e,r,l)}),i}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",m="suspendedYield",p="executing",y="completed",_={};function v(){}function h(){}function b(){}var g={};s(g,i,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(L([])));S&&S!==r&&n.call(S,i)&&(g=S);var w=b.prototype=v.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function O(e,t){function r(o,a,i,l){var c=d(e[o],e,a);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==Ys(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}var a;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return a=a?a.then(o,o):o()}})}function k(t,r,n){var o=f;return function(a,i){if(o===p)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:e,done:!0}}for(n.method=a,n.arg=i;;){var l=n.delegate;if(l){var c=x(l,n);if(c){if(c===_)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=p;var s=d(t,r,n);if("normal"===s.type){if(o=n.done?y:m,s.arg===_)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=y,n.method="throw",n.arg=s.arg)}}}function x(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,x(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),_;var a=d(o,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,_;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,_):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function j(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function L(t){if(t||""===t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}throw new TypeError(Ys(t)+" is not iterable")}return h.prototype=b,o(w,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:h,configurable:!0}),h.displayName=s(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,c,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},A(O.prototype),s(O.prototype,l,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new O(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},A(w),s(w,c,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=L,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(j),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return l.type="throw",l.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],l=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,_):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),j(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;j(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:L(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),_}},t}function $s(e,t,r,n,o,a,i){try{var l=e[a](i),c=l.value}catch(e){return void r(e)}l.done?t(c):Promise.resolve(c).then(n,o)}function Ks(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){$s(a,n,o,i,l,"next",e)}function l(e){$s(a,n,o,i,l,"throw",e)}i(void 0)}))}}function Js(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xs(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Zs=function(){var e=(0,ze.P)(),t=e.processContractsForV2,r=e.onChange,o=e.symbol,a=$t().activeSymbols,l=(0,n.useRef)(!1),c=Js((0,n.useState)(""),2),s=c[0],u=c[1],d=(0,n.useCallback)((function(e){var t=l.current;return e.some((function(e){var r=!!t||1===e.exchange_is_open;return e.symbol===o&&r}))}),[o]),f=(0,n.useCallback)(function(){var e=Ks(Ws().mark((function e(n){var a,c,s;return Ws().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.current,c=!a&&n,s=o!=n&&n,u(n),!c&&!s){e.next=8;break}return e.next=7,r({target:{name:"symbol",value:n}});case 7:t();case 8:(0,i.setTradeURLParams)({symbol:n});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[r,t,o]);return(0,n.useEffect)((function(){var e=function(){var e=Ks(Ws().mark((function e(){var t;return Ws().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d(a)){e.next=4;break}e.t0=o,e.next=10;break;case 4:return e.next=6,(0,i.pickDefaultSymbol)(a);case 6:if(e.t1=e.sent,e.t1){e.next=9;break}e.t1="1HZ100V";case 9:e.t0=e.t1;case 10:t=e.t0,f(t),l.current=!0;case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[a,d,f,o]),{symbol:s}};function Qs(e){return Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qs(e)}function eu(e){return function(e){if(Array.isArray(e))return tu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return tu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tu(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ru(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ru(Object(r),!0).forEach((function(t){ou(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ru(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ou(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Qs(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qs(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var au=(0,he.observer)((function(e){var t=e.digits,r=e.tick,n=(0,ze.P)(),a=n.setDigitStats,i=n.setTickData;return o().useEffect((function(){i(r)}),[r]),o().useEffect((function(){a(t)}),[t.join("-")]),null})),iu=(0,he.observer)((function(){var e=(0,s.A)(),t=e.ui,r=e.common,n=e.contract_trade,a=e.portfolio,l=(0,Aa.Y)().isMobile,c=n.accumulator_barriers_data,u=n.accumulator_contract_barriers_data,d=n.chart_type,f=n.granularity,m=n.has_crossed_accu_barriers,p=n.markers_array,y=n.updateChartType,_=n.updateGranularity,v=o().useRef(null),h=a.all_positions,b=t.is_chart_countdown_visible,g=t.is_chart_layout_default,E=t.is_dark_mode_on,S=t.is_positions_drawer_on,w=r.current_language,A=r.is_socket_opened,O=$t().activeSymbols,k=Zs().symbol,x=(0,ze.P)(),C=x.barriers_flattened,j=x.chartStateChange,T=x.chart_layout,L=x.contract_type,P=x.exportLayout,N=x.has_alternative_source,I=x.has_barrier,D=x.main_barrier_flattened,M=x.setChartStatus,z=x.show_digits_stats,R=x.onChange,F=x.prev_contract_type,U=x.wsForget,q=x.wsForgetStream,B=x.wsSendRequest,V=x.wsSubscribe,H=(0,i.isAccumulatorContract)(L),G=nu(nu({countdown:b,isHighestLowestMarkerEnabled:!1,language:w.toLowerCase(),position:g?"bottom":"left",theme:E?"dark":"light"},H?{whitespace:190,minimumLeftBars:l?3:void 0}:{}),I?{whitespace:110}:{}),Y=c||{},W=Y.current_spot,$=Y.current_spot_time;o().useEffect((function(){var e;if((H||z)&&null!==(e=v.current)&&void 0!==e&&e.hasPredictionIndicators()){var t;null===(t=v.current)||void 0===t||t.triggerPopup((function(){return R({target:{name:"contract_type",value:F}})}))}}),[H,R,F,z]);var K=D?[D].concat(eu(C)):C,J=0===f?8:24;return k&&O.length?o().createElement(Vs.GR,{ref:v,barriers:K,contracts_array:p,bottomWidgets:au,crosshair:l?0:void 0,crosshairTooltipLeftAllow:560,showLastDigitStats:!0,chartControlsWidgets:null,chartStatusListener:function(e){return M(!e,!0)},chartType:d,initialData:{activeSymbols:JSON.parse(JSON.stringify(O))},chartData:{activeSymbols:JSON.parse(JSON.stringify(O))},feedCall:{activeSymbols:!1},enabledNavigationWidget:!l,enabledChartFooter:!1,id:"trade",isMobile:l,isVerticalScrollEnabled:!1,maxTick:l?J:void 0,granularity:z||H?0:f,requestAPI:B,requestForget:U,requestForgetStream:q,requestSubscribe:V,settings:G,allowTickChartTypeOnly:z||H,stateChangeListener:j,symbol:k,topWidgets:function(){return o().createElement("div",null)},isConnectionOpened:A,clearChart:!1,toolbarWidget:function(){return o().createElement(Gs.A,{updateChartType:y,updateGranularity:_})},importedLayout:T,onExportLayout:P,shouldFetchTradingTimes:!1,hasAlternativeSource:N,getMarketsOrder:function(e){var t="synthetic_index",r=e.some((function(e){return e.market===t}));return e.slice().sort((function(e,t){return e.display_name<t.display_name?-1:1})).map((function(e){return e.market})).reduce((function(e,t){return-1===e.indexOf(t)&&e.push(t),e}),r?[t]:[])},should_zoom_out_on_yaxis:H,yAxisMargin:{top:l?76:106},isLive:!0,leftMargin:!l&&S?328:80},H&&o().createElement(Hs.A,{all_positions:h,current_spot:W,current_spot_time:$,has_crossed_accu_barriers:m,should_show_profit_text:!!u.accumulators_high_barrier,symbol:k,is_mobile:l})):null}));const lu=iu;function cu(e){return cu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cu(e)}function su(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function uu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?su(Object(r),!0).forEach((function(t){du(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):su(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function du(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=cu(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=cu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cu(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var pu=function(e){var t=e.is_dark_mode_on,r=fu(o().useState(!1),2),n=r[0],a=r[1],i=o().useRef(),l=fu(Ne("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),2),c=l[0],s=l[1],u=(c||{}).trade_types_selection,d=t?qe.fm.trade_type_selection.dark:qe.fm.trade_type_selection.light,f=function(){a(!1),s(uu(uu({},c),{},{trade_types_selection:!0}))};return o().useEffect((function(){return u||(i.current=setTimeout((function(){return a(!0)}),800)),function(){return clearTimeout(i.current)}}),[u]),u?null:o().createElement(De.M,{isOpened:n,isNonExpandable:!0,isMobile:!0,showHandleBar:!0,shouldCloseModalOnSwipeDown:!0,toggleModal:f,primaryButtonLabel:o().createElement(J.Localize,{i18n_default_text:"Got it"}),primaryButtonCallback:f},o().createElement(De.M.Header,{image:o().createElement(ut,{src:d,title:"trade_types_selection"}),title:o().createElement(J.Localize,{i18n_default_text:"Manage your trade types"})}),o().createElement(De.M.Body,null,o().createElement(J.Localize,{i18n_default_text:"Pin, rearrange, or remove your favorite trade types for easy access."})))};const yu=o().memo(pu);var _u=r("../../node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js"),vu=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneGripDotsVerticalBoldIcon.js"),hu=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneCircleMinusFillIcon.js");function bu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Eu=function(e){var t=e.active,r=e.disabled,a=e.leftIcon,l=e.onLeftIconClick,c=e.onRightIconClick,s=e.rightIcon,u=e.title,d=o().createElement(vu.A,{iconSize:"sm",fill:"var(--component-textIcon-normal-default)"}),f=o().createElement(hu.A,{fill:"var(--core-color-solid-red-700)",iconSize:"sm"}),m=bu((0,n.useState)(!1),2),p=m[0],y=m[1];return o().createElement("div",{className:(0,je.A)("draggable-list-item",{"draggable-list-item--active":t})},o().createElement("div",{className:"draggable-list-item__left"},o().createElement("button",{className:"draggable-list-item__left-icon","data-testid":"dt_draggable_list_item_left_icon",onClick:l,disabled:r},a||d),o().createElement("div",{className:"draggable-list-item__title"},u)),o().createElement("button",{className:(0,je.A)("draggable-list-item__icon",{"draggable-list-item__icon--disabled":r}),"data-testid":"dt_draggable_list_item_icon",onClick:function(){!(0,i.isTouchDevice)()&&c&&c()},onTouchMove:function(){p||y(!0)},onTouchEnd:function(){p||!c||r||c(),y(!1)},disabled:r},s||f))};function Su(e){return Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Su(e)}function wu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Au(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wu(Object(r),!0).forEach((function(t){Ou(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ou(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Su(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Su(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Su(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(null,arguments)}function xu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ju=function(e){var t=e.category,r=e.draggedItemId,n=e.onRightIconClick,a=e.show_editing_divider;return o().createElement("div",{className:a?"draggable-list-category":""},o().createElement(_u.gL,{droppableId:t.id},(function(e){return o().createElement("div",ku({},e.droppableProps,{ref:e.innerRef,className:"draggable-list-category__droppable-area"}),o().createElement(Tu,{items:t.items,draggedItemId:r,onRightIconClick:n}),e.placeholder)})))},Tu=function(e){var t=e.items,r=e.draggedItemId,n=e.onRightIconClick;return o().createElement(o().Fragment,null,t.map((function(e,a){return e.id&&o().createElement(_u.sx,{key:e.id,draggableId:e.id,index:a},(function(a){return o().createElement("div",ku({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{className:"draggable-list-category__item"}),o().createElement(Eu,{title:e.title,onRightIconClick:function(){return n(e)},active:r===e.id,disabled:1===t.length}))}))})))},Lu=function(e,t){var r=t.source,n=t.destination;if(!n)return e;var o=e.findIndex((function(e){return e.id===r.droppableId})),a=e.findIndex((function(e){return e.id===n.droppableId}));if(-1===o||-1===a)return e;var i=e[o],l=e[a],c=Array.from(i.items),s=xu(c.splice(r.index,1),1)[0];if(o===a)c.splice(n.index,0,s);else{var u=Array.from(l.items);u.splice(n.index,0,s),e[a]=Au(Au({},l),{},{items:u})}return e[o]=Au(Au({},i),{},{items:c}),Array.from(e)};const Pu=function(e){var t=e.categories,r=e.onRightIconClick,n=e.onDrag,a=e.show_editing_divider,i=xu(o().useState(t),2),l=i[0],c=i[1],s=xu(o().useState(null),2),u=s[0],d=s[1];return o().useEffect((function(){return c(t)}),[t]),o().createElement(_u.JY,{onDragEnd:function(e){if(d(null),e.destination){var t=Lu(l,e);c(t),null==n||n(t)}},onDragStart:function(e){return d(e.draggableId)}},l.map((function(e){return o().createElement(ju,{key:e.id,category:e,draggedItemId:u,onRightIconClick:r,show_editing_divider:a})})))};var Nu=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneCirclePlusFillIcon.js");const Iu=function(e){var t=e.title,r=e.selected,n=e.leftIcon,a=e.rightIcon,i=e.onLeftIconClick,l=e.onRightIconClick,c=e.onTradeTypeClick,s=o().createElement(Nu.A,{fill:"var(--core-color-solid-green-700)",iconSize:"sm"});return o().createElement("div",{className:(0,je.A)("trade-type-list-item",{"trade-type-list-item--selected":r}),onClick:c,onKeyDown:c},n&&o().createElement("button",{className:"trade-type-list-item__left-icon","data-testid":"dt_trade_type_list_item_left_icon",onClick:i},n),o().createElement("div",{className:"trade-type-list-item__title"},t),l&&o().createElement("button",{className:"trade-type-list-item__icon","data-testid":"dt_trade_type_list_item_right_icon",onClick:l},a||s))};function Du(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Mu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Mu(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const zu=function(e){var t,r=e.categories,n=e.isSelected,a=e.selectable,i=e.show_divider,l=e.onRightIconClick,c=e.onTradeTypeClick,s=Du(o().useState(r),2),u=s[0],d=s[1];return o().useEffect((function(){d(r)}),[r]),null!=r&&null!==(t=r[0])&&void 0!==t&&t.items.length?o().createElement(o().Fragment,null,null==u?void 0:u.map((function(e){var t;return o().createElement("div",{key:e.id,className:(0,je.A)("trade-type-list-category",{"trade-type-list-category__border":e.items&&e.items.length>0&&i})},o().createElement("div",{className:"trade-type-list-category__items"},null===(t=e.items)||void 0===t?void 0:t.map((function(e){return o().createElement("div",{key:e.id},o().createElement(Iu,{title:e.title,selected:!!a&&n(e.id),onRightIconClick:l&&function(){return l(e)},onTradeTypeClick:c}))}))))}))):null};const Ru=function(e){var t=e.handleCustomizeTradeTypes,r=e.handleRemovePinnedClick,n=e.handleOnDrag,a=e.handleOnTradeTypeSelect,i=e.handleAddPinnedClick,l=e.is_editing,c=e.is_dark_mode_on,s=e.isTradeTypeSelected,u=e.savePinnedToLocalStorage,d=e.show_trade_type_list_divider,f=e.show_editing_divider,m=e.other_trade_types,p=e.pinned_trade_types;return o().createElement(o().Fragment,null,o().createElement("div",null,o().createElement("div",{className:"draggable-list-category-header"},o().createElement(Ie.E,{size:"sm",bold:!0,className:"draggable-list-category-header-title"},l&&o().createElement(J.Localize,{i18n_default_text:"Pinned"})),o().createElement(Or.$n,{color:c?"white":"black",variant:"secondary",className:"draggable-list-category-header-button",onClick:l?u:t},l?o().createElement(J.Localize,{i18n_default_text:"Done"}):o().createElement(J.Localize,{i18n_default_text:"Customise"})))),o().createElement(De.A.Content,{className:"trade-types-dialog__content"},l?o().createElement(Pu,{categories:p,onRightIconClick:r,onDrag:n,show_editing_divider:f}):o().createElement(zu,{categories:p,onTradeTypeClick:a,isSelected:s,selectable:!0,show_divider:d}),o().createElement(zu,{categories:m,onRightIconClick:l?i:void 0,onTradeTypeClick:l?void 0:a,isSelected:s,selectable:!l})))};function Fu(e){return Fu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fu(e)}function Uu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Uu(Object(r),!0).forEach((function(t){Bu(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Bu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Fu(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fu(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vu(e){return function(e){if(Array.isArray(e))return Yu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Gu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||Gu(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gu(e,t){if(e){if("string"==typeof e)return Yu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yu(e,t):void 0}}function Yu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Wu=function(e){var t,r,a,i,l,c=e.contract_type,s=e.onTradeTypeSelect,u=e.trade_types,d=e.is_dark_mode_on,f=Hu(o().useState(!1),2),m=f[0],p=f[1],y=Hu(o().useState(!1),2),_=y[0],v=y[1],h=o().useRef(null),b=null!==(t=localStorage.getItem("pinned_trade_types"))&&void 0!==t?t:"[]",g=(0,n.useMemo)((function(){var e;return null!==(e=(0,Te.xL)(b))&&void 0!==e?e:[]}),[b]),E=Hu((0,n.useState)([]),2),S=E[0],w=E[1],A=Hu((0,n.useState)(g),2),O=A[0],k=A[1],x=(0,n.useMemo)((function(){return e=[],u.forEach((function(t){var r;e.push({id:t.value,title:null!==(r=t.text)&&void 0!==r?r:""})})),e;var e}),[u]),C=(0,n.useCallback)((function(){var e=R(z(g),x);return 0===e.length&&e.push.apply(e,Vu(x.slice(0,x.length))),e}),[g,x]),j=(0,n.useCallback)((function(){var e=C(),t=[{id:"pinned",title:(0,J.localize)("Pinned"),items:e}],r=[{id:"other",items:x.filter((function(t){return!e.some((function(e){return e.id===t.id}))}))}];k(t),w(r)}),[C,x]);(0,n.useEffect)((function(){j()}),[j]),(0,n.useEffect)((function(){D()}),[]);var T,L,P=function(e,t,r){return e.map((function(e){return"pinned"===e.id?qu(qu({},e),{},{items:"add"===r?[].concat(Vu(e.items),[t]):e.items.filter((function(e){return e.id!==t.id}))}):e}))},N=function(e,t){return e.map((function(e){return qu(qu({},e),{},{items:e.items.filter((function(e){return e.id!==t.id}))})}))},I=function(e,t){return e.map((function(e){return"other"===e.id?qu(qu({},e),{},{items:(0,Mt.c1)(u,[].concat(Vu(e.items),[t]))}):e}))},D=function(){setTimeout((function(){var e=0;if(h.current){var t=h.current.querySelector('button[data-state="selected"]');t&&(e=t.getBoundingClientRect().x-(window.innerWidth-t.getBoundingClientRect().width)/2||0),h.current.scrollBy({left:e,top:0})}}),0)},M=function(e){return zt([c,e])||c===e},z=function(e){return e.flatMap((function(e){return e.items}))},R=function(e,t){var r=t.map((function(e){return e.id}));return e.filter((function(e){return r.includes(e.id)}))},F=(T=C(),L=T.some((function(e){return e.id===c}))?null:z(S).find((function(e){return e&&(e.id===c||zt([e.id,c]))})),[].concat(Vu(T),[L]).filter(Boolean)),U=F.length>=2||z(S).length>0,q=!(null===(r=S[0])||void 0===r||null===(a=r.items)||void 0===a||!a.length),B=x.length!==(null===(i=O[0])||void 0===i||null===(l=i.items)||void 0===l?void 0:l.length),V={handleCustomizeTradeTypes:function(){v(!0)},handleRemovePinnedClick:function(e){k((function(t){return N(t,e)})),w((function(t){return I(t,e)}))},handleOnDrag:function(e){k(e)},handleOnTradeTypeSelect:function(e){s(e,"trade_type_page",C().length),D(),p(!1)},handleAddPinnedClick:function(e){w((function(t){return N(t,e)})),k((function(t){return P(t,e,"add")}))},is_editing:_,is_dark_mode_on:d,isTradeTypeSelected:M,savePinnedToLocalStorage:function(){localStorage.setItem("pinned_trade_types",JSON.stringify(O)),v(!1)},show_trade_type_list_divider:q,show_editing_divider:B,other_trade_types:S,pinned_trade_types:O},H=[{id:1,component:o().createElement(Ru,V)},{id:2,component:o().createElement(Oi,{show_trigger_button:!1,is_open_by_default:!0,show_description_in_a_modal:!1})}];return o().createElement("div",{className:"trade__trade-types",ref:h},F.map((function(e){var t=e.title,r=e.id;return o().createElement(Qa.v.Selectable,{key:r,onChipSelect:function(e){return s(e,"main_trade_page",C().length)},selected:M(r)},o().createElement(Ie.E,{size:"sm"},t))})),U&&o().createElement(Or.$n,{key:"trade-types-all",onClick:function(){j(),p(!0)},variant:"tertiary",className:"trade__trade-types-header",color:d?"white":"black"},o().createElement(Ie.E,{size:"sm",bold:!0,underlined:!0,color:"var(--component-button-label-color-blackWhite-tertiary)"},o().createElement(J.Localize,{i18n_default_text:"View all"}))),o().createElement(De.A.Root,{className:(0,je.A)("trade-types-dialog",{"trade-types-dialog--is_editing":_}),isOpen:m,expandable:!1,onClose:function(){p(!1),v(!1)}},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},_?o().createElement(o().Fragment,null,o().createElement(De.A.Header,{title:o().createElement("div",{className:"trade-types-dialog__title"},o().createElement(J.Localize,{i18n_default_text:"Trade types"}))}),o().createElement(Ru,V)):o().createElement(Ri,{header:Wi,pages:H,title:o().createElement(J.Localize,{i18n_default_text:"Trade types"}),next_icon:Ja.A,onNextButtonClick:function(){return(0,Ho.YL)(c,"trade_type_page")}}))),m&&o().createElement(yu,{is_dark_mode_on:d}))};const $u=o().memo(Wu);function Ku(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ju(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ju(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ju(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Xu=(0,he.observer)((function(){var e=Ku(o().useState(!1),2),t=e[0],r=e[1],a=o().useRef(null),i=(0,s.A)(),l=i.client,c=l.is_logged_in,u=l.is_switching,d=i.common,f=d.current_language,m=d.network_status,p=i.ui.is_dark_mode_on,y=(0,ze.P)(),_=y.active_symbols,v=y.contract_type,h=y.has_cancellation,b=y.is_accumulator,g=y.is_multiplier,E=y.is_market_closed,S=y.onChange,w=y.onMount,A=y.onUnmount,O=y.symbol,k=y.proposal_info,x=y.trade_types,C=y.trade_type_tab,j=Ut(),T=j.trade_types,L=j.resetTradeTypes,P=Ku(Ne("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),1)[0],N=(0,Mt.H1)(x,v,C),I=N.every((function(e){var t;return null==k||null===(t=k[e])||void 0===t?void 0:t.has_error})),D=1===N.length||g||I,M=o().useMemo((function(){return _.map((function(e){return{text:e.display_name,value:e.symbol}}))}),[_]),z=o().useCallback((function(e,t,r){var n,o=null===(n=T.find((function(t){return t.text===e.target.textContent})))||void 0===n?void 0:n.value;S({target:{name:"contract_type",value:o}}),(0,Ho.bC)(o||"",t,O,r)}),[T,S,O]),R=o().useCallback((function(){var e=null==a?void 0:a.current;if(e){var t=e.getBoundingClientRect().bottom,n=window.innerHeight-Ye;r(t<=n)}}),[]);return o().useEffect((function(){return w(),A}),[f,m.class]),(0,n.useEffect)((function(){u&&L()}),[u]),o().createElement(jt,{onScroll:R},M.length&&T.length&&!u?o().createElement(o().Fragment,null,o().createElement("div",{className:"trade"},o().createElement($u,{contract_type:v,onTradeTypeSelect:z,trade_types:T,is_dark_mode_on:p}),o().createElement(Qo,null),(0,Bs.E)(v)&&o().createElement(Sr,null),o().createElement(xi,null,o().createElement(qs,null)),o().createElement("div",{className:"trade__chart-tooltip"},o().createElement("section",{className:(0,je.A)("trade__chart",{"trade__chart--with-borderRadius":!b}),style:{height:Ze({is_accumulator:b,symbol:O,has_cancellation:h,contract_type:v})},ref:a},o().createElement(lu,null))),b&&o().createElement(vt,null)),o().createElement("div",{className:(0,je.A)("trade__parameter",{"trade__parameter--with-button":!E})},o().createElement(xi,{is_minimized_visible:t,is_minimized:!0},o().createElement(qs,{is_minimized:!0})),!E&&o().createElement(za,null)),!(null!=P&&P.trade_page)&&c&&o().createElement(wa,{type:"trade_page",is_dark_mode_on:p})):o().createElement(Ce.Loading.DTraderV2,null),o().createElement(Ya,null),o().createElement(cr,null),o().createElement(Ka,{error_fields:["stop_loss","take_profit","date_start","stake"],should_show_snackbar:D}))}));const Zu=Xu;var Qu=r("./src/AppV2/Utils/positions-utils.ts"),ed=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneSearchFillIcon.js"),td=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneBriefcaseFillIcon.js");const rd=function(e){var t=e.isClosedTab,r=e.noMatchesFound,n=r?ed.A:td.A;return o().createElement("div",{className:"empty-positions__".concat(t?Qu.Eu.CLOSED.toLowerCase():Qu.Eu.OPEN.toLowerCase())},o().createElement("div",{className:"icon","data-testid":"dt_empty_state_icon"},o().createElement(n,{iconSize:"2xl"})),o().createElement("div",{className:"message"},o().createElement(Ie.E,{bold:!0,size:"lg",color:"quill-typography__color--subtle"},r&&o().createElement(J.Localize,{i18n_default_text:"No matches found"}),!r&&(t?o().createElement(J.Localize,{i18n_default_text:"No closed positions"}):o().createElement(J.Localize,{i18n_default_text:"No open positions"}))),o().createElement(Ie.E,{size:"sm",centered:!0,color:"quill-typography__color--subtle"},r&&o().createElement(J.Localize,{i18n_default_text:"Try changing or removing filters to view available positions."}),!r&&(t?o().createElement(J.Localize,{i18n_default_text:"Your closed positions will be shown here."}):o().createElement(J.Localize,{i18n_default_text:"Your open positions will appear here."})))))};var nd=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedStopwatchCaptionRegularIcon.js"),od=function(e){var t=e.currentTick,r=e.date_expiry,n=e.isSold,a=e.serverTime,l=t?"".concat(null!=t?t:0," ").concat((0,i.getCardLabels)().TICKS.toLowerCase()):r&&a?o().createElement(Ce.RemainingTime,{as:"span",end_time:r,getCardLabels:i.getCardLabels,start_time:a,key:"remaining-time"}):null;return!r||(null==a?void 0:a.unix())>+r||n?o().createElement(Mr.v,{className:"status",label:(0,i.getCardLabels)().CLOSED,variant:"custom",color:"custom",size:"sm"}):l?o().createElement(Mr.v,{className:"timer",icon:o().createElement(nd.A,{key:"open-contract-card",fill:"var(--component-tag-label-color-default)"}),label:l,variant:"custom",size:"sm"}):null};const ad=function(e){var t=e.formatted_date,r=e.formatted_time;return t&&r?o().createElement(Mr.v,{color:"info",className:"forward-starting","data-testid":"dt_forward-starting",label:o().createElement(J.Localize,{i18n_default_text:"Starts on {{formatted_date}}, {{formatted_time}}",values:{formatted_date:t,formatted_time:r}}),showIcon:!1,size:"sm",variant:"fill"}):null};function id(e){return id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},id(e)}function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ld.apply(null,arguments)}function cd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=id(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=id(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==id(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ud(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return dd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var fd="left",md="right",pd={trackMouse:!0,preventScrollOnSwipe:!0};const yd=function(e){var t,r,n,a=e.className,l=void 0===a?"contract-card":a,c=e.contractInfo,s=e.currency,u=e.hasActionButtons,d=e.isSellRequested,f=e.onCancel,m=e.onClick,p=e.onClose,y=e.redirectTo,_=e.serverTime,v=ud(o().useState(!1),2),h=v[0],b=v[1],g=ud(o().useState(!1),2),E=g[0],S=g[1],w=ud(o().useState(!1),2),A=w[0],O=w[1],k=ud(o().useState(!1),2),x=k[0],C=k[1],j=c,T=j.buy_price,L=j.contract_type,P=j.display_name,N=j.purchase_time,I=j.sell_time,D=j.shortcode,M=j.limit_order,z=null!=M?M:{take_profit:{},stop_loss:{}},R=z.take_profit,F=z.stop_loss,U=(0,i.isHighLow)({shortcode:D}),q=(0,i.getTradeTypeName)(null!=L?L:"",{isHighLow:U,showMainTitle:!0}),B="cancellation"in c?null===(t=c.cancellation)||void 0===t?void 0:t.date_expiry:null,V="tick_count"in c&&c.tick_count?(0,i.getCurrentTick)(c):null,H="".concat(q," ").concat((0,i.getTradeTypeName)(null!=L?L:"",{isHighLow:U})).trim(),G="underlying_symbol"in c?(0,i.getMarketName)(null!==(r=c.underlying_symbol)&&void 0!==r?r:""):P,Y=(0,i.isCryptoContract)(c.underlying),W=(0,i.isMultiplierContract)(L),$=!!I||(0,i.isEnded)(c),K=(0,Qu.Dd)(c),J=(0,i.isValidToCancel)(c),X=(0,i.isValidToSell)(c)&&!d,Z=d&&A,Q=d&&E,ee=W&&!Y,te=(0,i.isForwardStarting)(null!=D?D:"",N),re=(0,i.getStartTime)(null!=D?D:""),ne=(0,i.hasForwardContractStarted)(null!=D?D:""),oe=te&&!!re&&!ne&&!$,ae=(!ee||ee&&$)&&!oe,ie=y?Se.NavLink:"div",le=function(e){C(e===fd)},ce=(0,oa.useSwipeable)(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(r),!0).forEach((function(t){sd(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({onSwipedLeft:function(){return le(fd)},onSwipedRight:function(){return le(md)}},pd)),se=function(e,t){e.preventDefault(),e.stopPropagation(),t?(null==f||f(e),O(!0)):(null==p||p(e),S(!0))},ue=(n=[],null!=R&&R.order_amount&&n.push("TP"),null!=F&&F.order_amount&&n.push("SL"),J&&n.push("DC"),n),de=!!ue.length&&!$;return o().useEffect((function(){$&&u&&b(!0)}),[$,u]),L?o().createElement("div",{className:(0,je.A)("".concat(l,"-wrapper"),{deleted:h})},o().createElement(ie,ld({},u?ce:{},{className:(0,je.A)(l,{"show-buttons":x,"has-cancel-button":J,lost:Number(K)<0,won:Number(K)>=0}),onClick:m,onDragStart:function(e){return e.preventDefault()},to:y}),o().createElement("div",{className:"".concat(l,"__body")},o().createElement("div",{className:"".concat(l,"__details")},o().createElement(Ce.IconTradeTypes,{type:U?"".concat(L,"_barrier"):L,size:16}),o().createElement("div",{className:"tag__wrapper"},de&&ue.map((function(e){return o().createElement(Mr.v,{className:"risk-management",label:e,key:e,variant:"custom",size:"sm"})})),ae&&o().createElement(od,ld({currentTick:V,isSold:$,serverTime:_},c)),oe&&o().createElement(ad,{formatted_date:(0,i.formatDate)((0,i.toMoment)(parseInt(re||"")),"DD MMM YYYY"),formatted_time:(0,i.formatTime)(parseInt(re||""),"HH:mm [GMT]")}))),o().createElement("div",{className:"".concat(l,"__details")},o().createElement(Ie.E,{className:"trade-type",size:"sm"},H),o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},o().createElement(Ce.Money,{amount:T,currency:s,show_currency:!0}))),o().createElement("div",{className:"".concat(l,"__details")},o().createElement(Ie.E,{size:"sm",className:"symbol",color:"quill-typography__color--subtle"},G),o().createElement(Ie.E,{className:"profit",size:"sm"},o().createElement(Ce.Money,{amount:K,currency:s,has_sign:!0,show_currency:!0})))),u&&o().createElement("div",{className:"buttons"},J&&o().createElement("button",{className:(0,je.A)({loading:Z}),disabled:Number(c.profit)>=0||d,onClick:function(e){return se(e,!0)}},Z?o().createElement("div",{className:"circle-loader","data-testid":"dt_button_loader"}):o().createElement(o().Fragment,null,o().createElement(Kt.O,{bold:!0,as:"div",className:"label",color:"quill-typography__color--prominent"},(0,i.getCardLabels)().CANCEL),B&&o().createElement(Kt.O,{bold:!0,as:"div",className:"label",color:"quill-typography__color--prominent"},o().createElement(Ce.RemainingTime,{end_time:B,format:"mm:ss",getCardLabels:i.getCardLabels,start_time:_})))),o().createElement("button",{className:(0,je.A)({loading:Q}),disabled:!X,onClick:se},Q?o().createElement("div",{className:"circle-loader","data-testid":"dt_button_loader"}):o().createElement(Kt.O,{bold:!0,as:"div",className:"label",color:"var(--component-textIcon-static-prominentDark)"},(0,i.getCardLabels)().CLOSE))))):null};var _d=["hasButtonsDemo","onClickCancel","onClickSell","positions","setHasButtonsDemo"];function vd(){return vd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vd.apply(null,arguments)}const hd=function(e){var t=e.hasButtonsDemo,r=e.onClickCancel,n=e.onClickSell,a=e.positions,l=void 0===a?[]:a,c=e.setHasButtonsDemo,s=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,_d);return o().useEffect((function(){var e;return t&&c&&(e=setTimeout((function(){return c(!1)}),720)),function(){e&&clearTimeout(e)}}),[]),l.length?o().createElement("div",{className:(0,je.A)("contract-card-list",{"contract-card-list--has-buttons-demo":t&&!l[0].contract_info.sell_time})},l.map((function(e){var t=e.contract_info.contract_id;return o().createElement(yd,vd({key:t,contractInfo:e.contract_info,hasActionButtons:!!n,isSellRequested:e.is_sell_requested,onCancel:function(){return t&&(null==r?void 0:r(t))},onClose:function(){return t&&(null==n?void 0:n(t))},redirectTo:t?{pathname:(0,i.getContractPath)(t),state:{from_table_row:!0}}:""},s))}))):null};var bd=r("../../node_modules/@deriv/quill-icons/dist/esm/react/Standalone/StandaloneLoaderBoldIcon.js");function gd(e){return function(e){if(Array.isArray(e))return Ed(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Ed(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ed(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Sd=function(e){var t=e.isLoadingMore,r=e.hasBottomMargin,n=e.positions,a=e.currency,l=function(e){if("string"==typeof e){var t=e.split(" ");return"".concat(t[0]," ").concat(t[1]," ").concat(t[2])}return(0,i.toMoment)(e).format("DD MMM YYYY")},c=null==n?void 0:n.map((function(e){return e.contract_info.sell_time?l(e.contract_info.sell_time):e.contract_info.purchase_time_unix&&l(e.contract_info.purchase_time_unix)})),s=gd(new Set(c));return null!=n&&n.length?o().createElement(o().Fragment,null,o().createElement("div",{className:(0,je.A)("contract-cards-sections",r&&"contract-cards-sections--has-bottom-margin")},s.map((function(e){return o().createElement("div",{className:"contract-cards-section",key:e},o().createElement(Ie.E,{as:"p",className:"contract-cards-section__title",bold:!0,size:"sm"},e),o().createElement(hd,{positions:n.filter((function(t){return t.contract_info.sell_time?l(t.contract_info.sell_time)===e:t.contract_info.purchase_time_unix&&l(t.contract_info.purchase_time_unix)===e})),currency:a}))}))),t&&o().createElement("div",{className:"load-more-spinner","data-testid":"dt_load_more_spinner"},o().createElement(bd.A,{iconSize:"md"}))):null};const wd=o().memo(Sd);function Ad(e){return function(e){if(Array.isArray(e))return xd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||kd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Od(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||kd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kd(e,t){if(e){if("string"==typeof e)return xd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xd(e,t):void 0}}function xd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Cd=function(e){var t=e.contractTypeFilter,r=e.onApplyContractTypeFilter,n=Od(o().useState(!1),2),a=n[0],i=n[1],l=Od(o().useState(t),2),c=l[0],s=l[1],u=function(e){var t=e.target.id;c.includes(t)?s(Ad(c.filter((function(e){return e!==t})))):s([].concat(Ad(c),[t]))};return o().createElement(o().Fragment,null,o().createElement(Qa.v.Standard,{className:"filter__chip",dropdown:!0,isDropdownOpen:a,onClick:function(){return i(!a)},selected:!!c.length,size:"md"},o().createElement(Ie.E,{size:"sm"},o().createElement(J.Localize,{i18n_default_text:"Trade types"})),!!c.length&&o().createElement(Ie.E,null,"(",c.length,")")),o().createElement(De.A.Root,{isOpen:a,onClose:function(){i(!1),s(t)},position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Filter by trade types"})}),o().createElement(De.A.Content,{className:"filter__item__wrapper"},Mt.Ou.map((function(e){var t=e.tradeType,r=e.id;return o().createElement(De.e,{checked:c.includes(r),checkboxPosition:"right",className:"filter__item",id:r,key:r,label:t,onChange:u,size:"md"})}))),o().createElement(De.A.Footer,{alignment:"horizontal",isSecondaryButtonDisabled:!c.length,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Apply"}),onAction:function(){return r(c)}},secondaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Clear All"}),onAction:function(){return s([])}},shouldCloseOnSecondaryButtonClick:!1}))))};var jd=r("../../node_modules/@deriv-com/quill-ui/dist/components/SelectionControl/radio/radio-group/index.js"),Td=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedChevronRightSmBoldIcon.js");const Ld=function(e){var t=e.customTimeRangeFilter,r=e.setShowDatePicker;return o().createElement("button",{className:"custom-time-filter__wrapper",onClick:function(){return r(!0)}},o().createElement(Ie.E,{size:"md",className:"custom-time-filter__label"},o().createElement(J.Localize,{i18n_default_text:"Custom"})),t&&o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},t),o().createElement(Td.A,{className:"custom-time-filter__icon",fill:"var(--component-textIcon-normal-default)"}))};var Pd=r("../../node_modules/moment/moment.js"),Nd=r.n(Pd);function Id(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Dd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Md=function(e){var t=e.applyHandler,r=e.handleDateChange,n=e.onClose,a=e.isOpen,l=e.setCustomTimeRangeFilter,c=Id(o().useState(),2),s=c[0],u=c[1],d=Id(o().useState([]),2),f=d[0],m=d[1];return o().createElement(De.A.Root,{isOpen:a,onClose:n,position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Choose a date range"})}),o().createElement(De.A.Content,null,o().createElement(ll.l,{allowPartialRange:!0,className:"date-picker__action-sheet",locale:"en-GB",selectRange:!0,onFormattedDate:function(e){var t=e.trim(),r=t.endsWith("-");u(r?t.substring(0,t.length-1):t)},onChange:m,optionsConfig:Qu.m$,tileDisabled:function(e){var t=e.date;return Date.parse(t.toDateString())>Date.parse((0,i.toMoment)().toString())},maxDate:new Date})),o().createElement(De.A.Footer,{alignment:"vertical",isPrimaryButtonDisabled:!s,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Apply"}),onAction:function(){l(s),Array.isArray(f)&&f.length&&r({from:(0,i.toMoment)(f[0]),to:f[1]?(0,i.toMoment)(f[1]):Nd()(f[0]).endOf("day")},{shouldFilterContractTypes:!0}),t()}}})))};function zd(e){return zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zd(e)}function Rd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rd(Object(r),!0).forEach((function(t){Ud(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ud(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=zd(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=zd(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==zd(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Bd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Bd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Vd=[{value:"0",label:o().createElement(J.Localize,{i18n_default_text:"All time"})},{value:"Today",label:o().createElement(J.Localize,{i18n_default_text:"Today"})},{value:"Yesterday",label:o().createElement(J.Localize,{i18n_default_text:"Yesterday"})},{value:"7",label:o().createElement(J.Localize,{i18n_default_text:"Last 7 days"})},{value:"30",label:o().createElement(J.Localize,{i18n_default_text:"Last 30 days"})},{value:"60",label:o().createElement(J.Localize,{i18n_default_text:"Last 60 days"})},{value:"90",label:o().createElement(J.Localize,{i18n_default_text:"Last 90 days"})}];const Hd=function(e){var t,r=e.customTimeRangeFilter,n=e.handleDateChange,a=e.setTimeFilter,l=e.setCustomTimeRangeFilter,c=e.setNoMatchesFound,s=e.timeFilter,u=qd(o().useState(!1),2),d=u[0],f=u[1],m=qd(o().useState(!1),2),p=m[0],y=m[1],_=r||s||"0",v=!(!r&&!s),h=function(){a(""),l(""),f(!1),n({to:(0,i.toMoment)().endOf("day"),is_batch:!0},{shouldFilterContractTypes:!0}),c(!1)};return o().createElement(o().Fragment,null,o().createElement(Qa.v.Standard,{className:"filter__chip",dropdown:!0,isDropdownOpen:d,onClick:function(){return f(!d)},selected:v,size:"md"},o().createElement(Ie.E,{size:"sm"},r||(null===(t=Vd.find((function(e){return e.value===(s||"0")})))||void 0===t?void 0:t.label))),o().createElement(De.A.Root,{isOpen:d,onClose:function(){return f(!1)},position:"left",expandable:!1},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:o().createElement(J.Localize,{i18n_default_text:"Filter by time"})}),o().createElement(De.A.Content,{className:"filter__item__wrapper"},o().createElement(jd.z,{className:"filter__item--radio",onToggle:function(e){var t,r=e.target.value;if("0"!==r){a(r),f(!1);var o={Today:{from:(0,i.toMoment)().startOf("day"),to:(0,i.toMoment)().endOf("day")},Yesterday:{from:(0,i.toMoment)().subtract(1,"days").startOf("day"),to:(0,i.toMoment)().subtract(1,"days").endOf("day")},default:{from:(0,i.toMoment)().startOf("day").subtract(Number(r),"day").add(1,"s"),to:(0,i.toMoment)().endOf("day")}};n(Fd(Fd({},null!==(t=o[r])&&void 0!==t?t:o.default),{},{is_batch:!0}),{shouldFilterContractTypes:!0})}else h()},selected:_,size:"sm"},Vd.map((function(e){var t=e.value,r=e.label;return o().createElement(jd.z.Item,{value:t,label:r,key:t,radioButtonPosition:"right"})}))),o().createElement(Ld,{customTimeRangeFilter:r,setShowDatePicker:y})),o().createElement(De.A.Footer,{alignment:"vertical",secondaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Reset"}),onAction:h},shouldCloseOnSecondaryButtonClick:!1}))),p&&o().createElement(Md,{applyHandler:function(){y(!1),f(!1)},handleDateChange:n,isOpen:p,onClose:function(){return y(!1)},setCustomTimeRangeFilter:l}))};const Gd=function(e){var t=e.currency,r=e.hasBottomAlignment,n=e.is_bold,a=void 0===n||n,l=e.positionsCount,c=void 0===l?"":l,s=e.totalProfitLoss;return o().createElement("div",{className:(0,je.A)("total-profit-loss",r&&"bottom"),"data-testid":"dt_total_profit_loss"},o().createElement(Ie.E,{bold:a,size:"sm",className:"total-profit-loss__label"},r?o().createElement(J.Localize,{i18n_default_text:"Last {{positionsCount}} contracts:",values:{positionsCount:c}}):(0,i.getCardLabels)().TOTAL_PROFIT_LOSS),o().createElement(Ie.E,{className:(0,je.A)("total-profit-loss__amount",{positive:+s>0,negative:+s<0}),bold:a,size:"sm"},o().createElement(Ce.Money,{amount:s,currency:t,show_currency:!0,has_sign:!0})))};const Yd=function(e){var t=e.isClosedTab,r=(0,Oo.q)().positions,n=r.setClosedContractTypeFilter,o=r.setOpenContractTypeFilter,a=r.openContractTypeFilter,i=r.closedContractTypeFilter;return{contractTypeFilter:t?i:a,setContractTypeFilter:t?n:o}};const Wd=function(){var e=(0,Oo.q)().positions;return{timeFilter:e.timeFilter,setTimeFilter:e.setTimeFilter,customTimeRangeFilter:e.customTimeRangeFilter,setCustomTimeRangeFilter:e.setCustomTimeRangeFilter}};function $d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Kd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Jd=(0,he.observer)((function(e){var t,r,n=e.hasButtonsDemo,a=e.isClosedTab,i=e.setHasButtonsDemo,l=Yd({isClosedTab:a}),c=l.contractTypeFilter,u=l.setContractTypeFilter,d=Wd(),f=d.timeFilter,m=d.setTimeFilter,p=d.customTimeRangeFilter,y=d.setCustomTimeRangeFilter,_=$d(o().useState([]),2),v=_[0],h=_[1],b=$d(o().useState(!1),2),g=b[0],E=b[1],S=(0,s.A)(),w=S.common,A=S.client,O=S.portfolio,k=(a?{}:w).server_time,x=void 0===k?void 0:k,C=A.currency,j=O.active_positions,T=O.is_active_empty,L=O.is_loading,P=O.onClickCancel,N=O.onClickSell,I=O.onMount,D=function(){var e=o().useContext(pe);if(!e)throw new Error("useReportsStore must be used within ReportsStoreProvider");return e}().profit_table,M=D.clearTable,z=D.data,R=D.fetchNextBatch,F=D.handleScroll,U=D.handleDateChange,q=D.is_empty,B=D.is_loading,V=D.onMount,H=D.onUnmount,G=o().useMemo((function(){return z.map((function(e){return{contract_info:e}}))}),[z]),Y=o().useMemo((function(){return a?G:j}),[j,a,G]),W=(a?!f&&!p&&!c.length:!c.length)&&(a?q:T),$=W||g,K=!!v.length&&(a||(null===(t=v[0])||void 0===t||null===(r=t.contract_info)||void 0===r?void 0:r.status)),J=a?B&&!v.length:L,X=!a||!(!f&&!p),Z=a?o().createElement(wd,{currency:C,positions:v,isLoadingMore:B,hasBottomMargin:X}):o().createElement(hd,{currency:C,hasButtonsDemo:n,onClickCancel:a?void 0:P,onClickSell:a?void 0:N,positions:v,setHasButtonsDemo:i,serverTime:x});return o().useEffect((function(){var e=(0,Qu.H9)(Y,c);c.length?(h(e),a||E(!e.length)):(E(!1),h(Y)),a&&E(!e.length&&!!(f||p||c.length))}),[a,Y,c,f,p]),o().useEffect((function(){return a?V(!0):I(),function(){a&&(M(),H())}}),[]),J||!K&&!$?o().createElement(Ce.Loading.DTraderV2,{is_positions:!0,is_closed_tab:a}):o().createElement("div",{className:"positions-page__".concat(a?Qu.Eu.CLOSED.toLowerCase():Qu.Eu.OPEN.toLowerCase()),onScroll:a?function(e){a&&F(e,!0)}:void 0},!W&&o().createElement("div",{className:"positions-page__filter__wrapper"},a?o().createElement(Hd,{timeFilter:f,setTimeFilter:m,handleDateChange:U,customTimeRangeFilter:p,setCustomTimeRangeFilter:y,setNoMatchesFound:E}):o().createElement(Cd,{contractTypeFilter:c,onApplyContractTypeFilter:function(e){u(e),a&&(M(),R(!0))}})),$?o().createElement(rd,{isClosedTab:a,noMatchesFound:g}):K&&o().createElement(o().Fragment,null,X&&o().createElement(Gd,{positionsCount:v.length,currency:C,hasBottomAlignment:a,totalProfitLoss:(0,Qu.jw)(v)}),Z))}));const Xd=Jd;function Zd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Qd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qd(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const ef=(0,he.observer)((function(){var e=Zd(o().useState(!1),2),t=e[0],r=e[1],n=Zd(o().useState((0,i.getPositionsV2TabIndexFromURL)()),2),a=n[0],l=n[1],c=Zd(Ne("guide_dtrader_v2",{trade_types_selection:!1,trade_page:!1,positions_page:!1}),1)[0],u=(0,Se.useHistory)(),d=(0,s.A)(),f=d.client.is_logged_in,m=d.ui.is_dark_mode_on,p=(0,Oo.q)().positions.onUnmount,y=[{id:Qu.Eu.OPEN.toLowerCase(),title:o().createElement(J.Localize,{i18n_default_text:"Open"}),content:o().createElement(Xd,{hasButtonsDemo:t,setHasButtonsDemo:r})},{id:Qu.Eu.CLOSED.toLowerCase(),title:o().createElement(J.Localize,{i18n_default_text:"Closed"}),content:o().createElement(Xd,{isClosedTab:!0})}];return o().useEffect((function(){return(0,Qu.RN)(y[a].id),null!=c&&c.positions_page&&r(!0),function(){u.location.pathname.startsWith("/contract/")||p()}}),[]),o().createElement(jt,null,o().createElement("div",{className:"positions-page"},o().createElement(wr.o.Container,{contentStyle:"fill",className:"positions-page__tabs",size:"md",selectedTabIndex:a,onChangeTab:function(e){l(e),(0,Qu.RN)(y[e].id)}},o().createElement(wr.o.List,null,y.map((function(e){var t=e.id,r=e.title;return o().createElement(wr.o.Trigger,{key:t},r)}))),o().createElement(wr.o.Content,{className:"positions-page__tabs-content"},y.map((function(e){var t=e.id,r=e.content;return o().createElement(wr.o.Panel,{key:t},r)}))))),!(null!=c&&c.positions_page)&&f&&o().createElement(wa,{type:"positions_page",is_dark_mode_on:m,callback:function(){return r(!0)}}))}));const tf=function(e){var t=e.label,r=e.value,n=e.date,a=e.time;return o().createElement("div",{className:"entry-exit-details__table-row"},o().createElement("div",{className:"entry-exit-details__table-cell"},o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},t)),o().createElement("div",{className:"entry-exit-details__table-cell"},o().createElement(Ie.E,{size:"sm"},r),o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},n),o().createElement(Kt.O,{color:"quill-typography__color--subtle"},a)))};const rf=function(e){var t=e.title,r=e.children,n=e.className;return o().createElement("div",{className:(0,je.A)("card-wrapper",n)},t&&o().createElement(Ie.E,{size:"sm",bold:!0,className:"title"},t),r)};function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nf.apply(null,arguments)}var of=function(e){if(e){var t=new Date(1e3*e),r=Nd()(t);return{date:(0,i.formatDate)(r,"DD MMM YYYY"),time:(0,i.formatTime)(e,"HH:mm:ss [GMT]")}}};const af=function(e){var t=e.contract_info,r=t.entry_tick_time,a=t.entry_spot_display_value,l=t.exit_tick_time,c=t.date_start,s=t.exit_tick_display_value,u=(0,n.useMemo)((function(){var e;return{entry:r?of(r):void 0,exit:l?of(l):void 0,start:c?of(c):void 0,end:(0,i.getEndTime)(t)?of(null!==(e=(0,i.getEndTime)(t))&&void 0!==e?e:0):void 0}}),[t]),d=a?(0,i.addComma)(a):null,f=s?(0,i.addComma)(s):null;return o().createElement(rf,{title:o().createElement(J.Localize,{i18n_default_text:"Entry & exit details"}),className:"entry-exit-details"},o().createElement("div",{className:"entry-exit-details__table"},u.start&&o().createElement(tf,{label:o().createElement(J.Localize,{i18n_default_text:"Start time"}),value:u.start.date,time:u.start.time}),u.entry&&d&&o().createElement(tf,nf({label:o().createElement(J.Localize,{i18n_default_text:"Entry spot"}),value:d},u.entry)),u.end&&o().createElement(tf,{label:o().createElement(J.Localize,{i18n_default_text:"Exit time"}),value:u.end.date,time:u.end.time}),u.exit&&f&&o().createElement(tf,nf({label:o().createElement(J.Localize,{i18n_default_text:"Exit spot"}),value:f},u.exit))))};var lf=r("../../node_modules/@deriv-com/quill-ui/dist/components/Pagination/index.js");function cf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return sf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?sf(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const uf=function(e){var t=e.history,r=void 0===t?[]:t,a=e.currency,l=e.is_multiplier,c=cf((0,n.useState)(0),2),s=c[0],u=c[1],d=Math.ceil(r.length/4),f=o().useCallback((function(e){u(e.currentPage-1)}),[]);if(!r.length)return null;var m=r.reduce((function(e,t,n){return n%4||e.push(r.slice(n,n+4)),e}),[]).map((function(e,t){return{id:t,component:o().createElement(o().Fragment,null,e.map((function(e,t){return o().createElement("div",{key:"take-profit-history-".concat(t),className:"take-profit-history__table-row"},o().createElement("div",{className:bt()("take-profit-history__table-cell","take-profit-history__table-cell--left")},o().createElement(Kt.O,{color:"quill-typography__color--subtle",size:"sm"},(0,i.formatDate)(e.order_date,"DD MMM YYYY")),o().createElement(Kt.O,{color:"quill-typography__color--subtle"},(0,i.formatTime)(Number(e.order_date)))),o().createElement("div",{className:"take-profit-history__table-cell"},o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},e.display_name),o().createElement(Ie.E,{size:"sm"},0===Math.abs(Number(e.order_amount))?(0,J.localize)("Cancelled"):"".concat((0,i.formatMoney)(String(a),String(e.order_amount),!0)," ").concat(a))))})))}}));return o().createElement(rf,{title:l?o().createElement(J.Localize,{i18n_default_text:"TP & SL History"}):o().createElement(J.Localize,{i18n_default_text:"TP History"}),className:"take-profit-history"},o().createElement("div",{className:bt()("take-profit-history__table",{"take-profit-history__table--fixed-height":r.length>4})},o().createElement(Ri,{classname:"take-profit-history__carousel",current_index:s,is_swipeable:!0,pages:m,setCurrentIndex:u})),d>1&&o().createElement(lf.d,{initialPage:s+1,contentLength:r.length,contentPerPage:4,hideChevron:!0,onClickPagination:f,variant:"bullet"}))};const df=function(e){var t=e.contract_info;return o().createElement(rf,{title:o().createElement(J.Localize,{i18n_default_text:"How do I earn a payout?"})},o().createElement(Ie.E,{size:"sm"},t.longcode))};const ff=function(){var e=(0,s.A)(),t=e.contract_replay,r=e.contract_trade.getContractById,o=t.contract_store,a=t.onMount,i=t.onUnmount,l=o.contract_info,c=r(l.contract_id),u=(0,kt.useLocation)();return(0,n.useEffect)((function(){var e=u.pathname.split("/").pop();e!=l.contract_id&&a(parseInt(e))}),[u.pathname,a,i,l.contract_id]),{contract_info:l,contract:c,is_loading:!l.contract_id}};var mf=r("./src/Modules/Contract/Containers/replay-chart.tsx");const pf=(0,he.observer)((function(){var e=ff().contract_info,t=(0,i.isResetContract)(e.contract_type),r=(0,i.isAccumulatorContract)(e.contract_type);return o().createElement("div",{className:"contract-details-chart"},o().createElement(mf.A,{is_accumulator_contract:r,is_reset_contract:t,is_vertical_scroll_disabled:!0}))}));var yf,_f=r("./src/App/Components/Elements/PositionsDrawer/helpers/index.ts"),vf=r("./src/Stores/Modules/Trading/Helpers/logic.ts");function hf(e){return hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hf(e)}function bf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bf(Object(r),!0).forEach((function(t){Ef(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ef(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=hf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=hf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==hf(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Sf=function(e,t){var r,n,o,a,l,c=e.tick_count,s=e.tick_passed,u=e.contract_type,d=Number(c)<2?t.TICK:t.TICKS,f=(0,i.isAccumulatorContract)(u)?"".concat(s," ").concat(t.TICKS):"".concat(c," ").concat(d);return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,[null!==(r=e.transaction_ids)&&void 0!==r&&r.buy?"".concat(e.transaction_ids.buy," (").concat(t.BUY,")"):"",null!==(n=e.transaction_ids)&&void 0!==n&&n.sell?"".concat(e.transaction_ids.sell," (").concat(t.SELL,")"):""]),t.STAKE,e.buy_price&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.buy_price,!0)," ").concat(e.currency):""),t.DURATION,Number(c)>0?f:"".concat(null!==(o=(0,i.getDurationTime)(e))&&void 0!==o?o:""," ").concat(null!==(a=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==a?a:"")),t.PAYOUT_PER_POINT,null!==(l=e.display_number_of_contracts)&&void 0!==l?l:""),t.POTENTIAL_PAYOUT,e.payout)},wf=function(e,t){var r,n,o,a,l,c,s=Sf(e,t),u=function(e,t){var r,n;if(null!==(r=e.cancellation)&&void 0!==r&&r.ask_price&&e.currency)return n=(0,i.isUserCancelled)(e)?t.EXECUTED:(0,vf.d)(e)?t.EXPIRED:t.ACTIVE,["".concat((0,i.formatMoney)(e.currency,e.cancellation.ask_price,!0)," ").concat(e.currency),"(".concat(n,")")]}(e,t);return gf(gf(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,s[t.REFERENCE_ID]),t.MULTIPLIER,e.multiplier?"x".concat(e.multiplier):""),t.STAKE,s[t.STAKE]),t.COMMISSION,e.commission?"".concat((0,i.formatMoney)(e.currency,e.commission,!0)," ").concat(e.currency):""),u&&Ef({},t.DEAL_CANCEL_FEE,u)),{},Ef(Ef(Ef({},t.TAKE_PROFIT,null!==(r=e.limit_order)&&void 0!==r&&null!==(n=r.take_profit)&&void 0!==n&&n.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET),t.STOP_LOSS,null!==(o=e.limit_order)&&void 0!==o&&null!==(a=o.stop_loss)&&void 0!==a&&a.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.stop_loss.order_amount,!0)," ").concat(e.currency):t.NOT_SET),t.STOP_OUT_LEVEL,null!==(l=e.limit_order)&&void 0!==l&&null!==(c=l.stop_out)&&void 0!==c&&c.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.stop_out.order_amount,!0)," ").concat(e.currency):""))},Af=function(e,t){var r,n=e.barrier,o=e.purchase_time,a=e.shortcode,l=(0,i.isForwardStarting)(null!=a?a:"",o),c=(0,i.getStartTime)(null!=a?a:""),s=(0,i.hasForwardContractStarted)(null!=a?a:""),u=l&&!!c&&!s,d=Sf(e,t);return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,d[t.REFERENCE_ID]),t.DURATION,d[t.DURATION]),t.BARRIER,null!==(r=u?"TBD":n)&&void 0!==r?r:""),t.STAKE,d[t.STAKE]),t.POTENTIAL_PAYOUT,d[t.POTENTIAL_PAYOUT])},Of=function(e,t){var r,n,o,a=Sf(e,t);return Ef(Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,a[t.REFERENCE_ID]),t.DURATION,a[t.DURATION]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),t.PAYOUT_PER_POINT,"".concat(a[t.PAYOUT_PER_POINT]," ").concat(e.currency)),t.STAKE,a[t.STAKE]),t.TAKE_PROFIT,null!==(n=e.limit_order)&&void 0!==n&&null!==(o=n.take_profit)&&void 0!==o&&o.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET)},kf=function(e,t){var r,n=Sf(e,t),o=null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:"";return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,n[t.REFERENCE_ID]),t.DURATION,"".concat(o," ").concat(+o>1?(0,i.getUnitMap)().t.name_plural:(0,i.getUnitMap)().t.name_singular)),t.TARGET,(0,_f.Vb)(e)),t.STAKE,n[t.STAKE]),t.POTENTIAL_PAYOUT,n[t.POTENTIAL_PAYOUT])},xf=function(e,t){var r,n,o=Sf(e,t);return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,o["".concat(t.REFERENCE_ID)]),t.DURATION,"".concat(null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:""," ").concat(null!==(n=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==n?n:"")),t.STRIKE_PRICE,((0,i.isResetContract)(e.contract_type)?(0,i.addComma)(e.entry_spot_display_value):(0,_f.Vb)(e))||" - "),t.PAYOUT_PER_POINT,"".concat(o[t.PAYOUT_PER_POINT]," ").concat(e.currency)),t.STAKE,o[t.STAKE])},Cf=function(e,t){var r,n,o=Sf(e,t);return Ef(Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,o["".concat(t.REFERENCE_ID)]),t.DURATION,"".concat(null!==(r=(0,i.getDurationTime)(e))&&void 0!==r?r:""," ").concat(null!==(n=(0,i.getDurationUnitText)((0,i.getDurationPeriod)(e)))&&void 0!==n?n:"")),t.HIGH_BARRIER,e.high_barrier),t.LOW_BARRIER,e.low_barrier),t.STAKE,o[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},jf=function(e,t){var r,n=Sf(e,t);return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,n[t.REFERENCE_ID]),t.DURATION,n[t.DURATION]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),t.STAKE,n[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},Tf=function(e,t){var r,n,o,a,l=Sf(e,t),c=e.contract_type==i.CONTRACT_TYPES.LB_CALL;return a=null!==(r=e.transaction_ids)&&void 0!==r&&r.sell?c?t.LOW_SPOT:t.HIGH_SPOT:c?t.INDICATIVE_LOW_SPOT:t.INDICATIVE_HIGH_SPOT,Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,l[t.REFERENCE_ID]),t.DURATION,l[t.DURATION]),t.MULTIPLIER,null!==(n=e.multiplier)&&void 0!==n?n:""),a,null!==(o=e.barrier)&&void 0!==o?o:""),t.STAKE,l[t.STAKE])},Lf=function(e,t){var r,n,a,l,c=Sf(e,t);return gf(gf(gf(Ef(Ef(Ef({},t.REFERENCE_ID,c[t.REFERENCE_ID]),t.DURATION,[c[t.DURATION],{caption:o().createElement(J.Localize,{key:"reset_time",i18n_default_text:"The reset time is {{ reset_time }}",values:{reset_time:void 0!==e.tick_count?"".concat(Math.floor(Number(e.tick_count)/2)," ").concat(Number(e.tick_count)<2?t.TICK:t.TICKS):(0,i.formatResetDuration)(e)}})}]),t.BARRIER,null!==(r=e.barrier)&&void 0!==r?r:""),e.reset_barrier?Ef({},t.RESET_BARRIER,e.reset_barrier):{}),e.reset_time?Ef({},t.RESET_TIME,null!==(a=e.reset_time,l=new Date(1e3*a),n=["".concat(l.getUTCDate().toString().padStart(2,"0")," ").concat(l.toLocaleString("en-GB",{month:"short",timeZone:"UTC"})," ").concat(l.getUTCFullYear()),"".concat(l.getUTCHours().toString().padStart(2,"0"),":").concat(l.getUTCMinutes().toString().padStart(2,"0"),":").concat(l.getUTCSeconds().toString().padStart(2,"0")," GMT")])&&void 0!==n?n:""):{}),{},Ef(Ef({},t.STAKE,c[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):""))},Pf=function(e,t){var r=Sf(e,t);return Ef(Ef(Ef(Ef({},t.REFERENCE_ID,r[t.REFERENCE_ID]),t.DURATION,r[t.DURATION]),t.STAKE,r[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},Nf=function(e,t){var r,n,o=Sf(e,t);return Ef(Ef(Ef(Ef(Ef({},t.REFERENCE_ID,o[t.REFERENCE_ID]),t.DURATION,o[t.DURATION]),t.SELECTED_TICK,[null!==(r=e.selected_tick)&&void 0!==r?r:"",{caption:null!==(n=e.barrier)&&void 0!==n?n:""}]),t.STAKE,o[t.STAKE]),t.POTENTIAL_PAYOUT,e.payout&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.payout,!0)," ").concat(e.currency):"")},If=(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(yf={},i.CONTRACT_TYPES.TURBOS.LONG,Of),i.CONTRACT_TYPES.TURBOS.SHORT,Of),i.CONTRACT_TYPES.MULTIPLIER.DOWN,wf),i.CONTRACT_TYPES.MULTIPLIER.UP,wf),i.CONTRACT_TYPES.MATCH_DIFF.MATCH,kf),i.CONTRACT_TYPES.MATCH_DIFF.DIFF,kf),i.CONTRACT_TYPES.EVEN_ODD.EVEN,kf),i.CONTRACT_TYPES.EVEN_ODD.ODD,kf),i.CONTRACT_TYPES.OVER_UNDER.OVER,kf),i.CONTRACT_TYPES.OVER_UNDER.UNDER,kf),Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(yf,i.CONTRACT_TYPES.PUT,Af),i.CONTRACT_TYPES.PUTE,Af),i.CONTRACT_TYPES.CALLE,Af),i.CONTRACT_TYPES.CALL,Af),i.CONTRACT_TYPES.TOUCH.ONE_TOUCH,Af),i.CONTRACT_TYPES.TOUCH.NO_TOUCH,Af),i.CONTRACT_TYPES.ACCUMULATOR,(function(e,t){var r,n,o,a=Sf(e,t);return gf(gf(Ef({},t.REFERENCE_ID,a[t.REFERENCE_ID]),gf({},(e.is_expired||e.is_sold)&&Ef({},t.DURATION,a[t.DURATION]))),{},Ef(Ef({},t.GROWTH_RATE,e.growth_rate?"".concat((0,i.getGrowthRatePercentage)(e.growth_rate),"%"):""),t.STAKE,a[t.STAKE]),gf({},(null===(r=e.limit_order)||void 0===r?void 0:r.take_profit)&&Ef({},t.TAKE_PROFIT,null!==(n=e.limit_order)&&void 0!==n&&null!==(o=n.take_profit)&&void 0!==o&&o.order_amount&&e.currency?"".concat((0,i.formatMoney)(e.currency,e.limit_order.take_profit.order_amount,!0)," ").concat(e.currency):t.NOT_SET)))})),i.CONTRACT_TYPES.VANILLA.CALL,xf),i.CONTRACT_TYPES.VANILLA.PUT,xf),i.CONTRACT_TYPES.END.IN,Cf),Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(Ef(yf,i.CONTRACT_TYPES.END.OUT,Cf),i.CONTRACT_TYPES.STAY.IN,Cf),i.CONTRACT_TYPES.STAY.OUT,Cf),i.CONTRACT_TYPES.ASIAN.UP,jf),i.CONTRACT_TYPES.ASIAN.DOWN,jf),i.CONTRACT_TYPES.LB_HIGH_LOW,(function(e,t){var r,n,o,a,i,l=Sf(e,t);return gf(gf(Ef(Ef(Ef({},t.REFERENCE_ID,l[t.REFERENCE_ID]),t.DURATION,l[t.DURATION]),t.MULTIPLIER,null!==(r=e.multiplier)&&void 0!==r?r:""),Ef(Ef({},null!==(n=e.transaction_ids)&&void 0!==n&&n.sell?t.HIGH_SPOT:t.INDICATIVE_HIGH_SPOT,null!==(o=e.high_barrier)&&void 0!==o?o:""),null!==(a=e.transaction_ids)&&void 0!==a&&a.sell?t.LOW_SPOT:t.INDICATIVE_LOW_SPOT,null!==(i=e.low_barrier)&&void 0!==i?i:"")),{},Ef({},t.STAKE,l[t.STAKE]))})),i.CONTRACT_TYPES.LB_CALL,Tf),i.CONTRACT_TYPES.LB_PUT,Tf),i.CONTRACT_TYPES.RESET.CALL,Lf),i.CONTRACT_TYPES.RESET.PUT,Lf),Ef(Ef(Ef(Ef(Ef(yf,i.CONTRACT_TYPES.TICK_HIGH_LOW.HIGH,Nf),i.CONTRACT_TYPES.TICK_HIGH_LOW.LOW,Nf),i.CONTRACT_TYPES.FALL,Cf),i.CONTRACT_TYPES.RUN_HIGH_LOW.HIGH,Pf),i.CONTRACT_TYPES.RUN_HIGH_LOW.LOW,Pf));const Df=function(e){var t=e;if(t.contract_type){var r=If[t.contract_type];return{details:r?r(t,(0,i.getCardLabelsV2)()):{}}}};function Mf(e){return Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mf(e)}function zf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Rf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rf(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Ff=function(e){var t=e.contract_info,r=Df(t),n=r?r.details:{};return o().createElement(rf,{title:o().createElement(J.Localize,{i18n_default_text:"Order Details"})},o().createElement("div",{className:"order-details"},o().createElement("div",{className:"order-details__table"},Object.entries(n).map((function(e){var t=zf(e,2),r=t[0],n=t[1];return o().createElement("div",{className:"order-details__table-row",key:r},o().createElement("div",{className:"order-details__table-row-cell"},o().createElement(Ie.E,{size:"sm",color:"quill-typography__color--subtle"},r)),o().createElement("div",{className:"order-details__table-row-cell"},Array.isArray(n)?n.map((function(e,t){var n;return["number","string"].includes(Mf(e))?o().createElement(Ie.E,{key:"".concat(r,"_").concat(t),size:"sm"},e):o().createElement(Kt.O,{key:"".concat(r,"_").concat(t),size:"sm",color:"quill-typography__color--subtle"},null!==(n=null==e?void 0:e.caption)&&void 0!==n?n:"")})):o().createElement(Ie.E,{size:"sm"},n)))})))))};function Uf(e){return Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Uf(e)}function qf(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Uf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Uf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Uf(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Bf={isTakeProfitVisible:!1,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!1},Vf=function(e){return qf(qf(qf(qf(qf({},i.CONTRACT_TYPES.ACCUMULATOR,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.MULTIPLIER.UP,{isTakeProfitVisible:!0,isDealCancellationVisible:!0,isStopLossVisible:!0,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.MULTIPLIER.DOWN,{isTakeProfitVisible:!0,isDealCancellationVisible:!0,isStopLossVisible:!0,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.TURBOS.LONG,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0}),i.CONTRACT_TYPES.TURBOS.SHORT,{isTakeProfitVisible:!0,isDealCancellationVisible:!1,isStopLossVisible:!1,isTpHistoryVisible:!0})[e]||Bf},Hf=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedCircleInfoSmRegularIcon.js");function Gf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yf(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const Wf=function(e){var t=e.header_content,r=e.body_content,n=e.info_message,a=Gf(o().useState(!1),2),i=a[0],l=a[1];return o().createElement(o().Fragment,null,o().createElement("button",{onClick:function(){return l(!i)}},o().createElement(Hf.A,{fill:"var(--component-textIcon-normal-default)"})),o().createElement(De.M,{isNonExpandable:!0,shouldCloseModalOnSwipeDown:!0,isOpened:i,toggleModal:l,primaryButtonLabel:o().createElement(J.Localize,{i18n_default_text:"Got it"}),shouldCloseOnPrimaryButtonClick:!0,isMobile:!0,showHandleBar:!0},o().createElement(De.M.Header,{title:t}),o().createElement(De.M.Body,null,o().createElement("div",{className:"risk-management-info-modal__container"},o().createElement(Ie.E,{size:"md"},r),n&&o().createElement(Zc.H,{message:n,size:"sm",status:"info"})))))};const $f=(0,he.observer)((function(e){var t=e.format,r=void 0===t?"mm:ss":t,n=(0,s.A)().common.server_time,a=(ff().contract_info.cancellation||{}).date_expiry;return!a||n.unix()>+a?null:o().createElement(Mr.v,{className:"deal-cancellation-badge","data-testid":"dt_deal_cancellation_badge",icon:o().createElement(nd.A,{key:"open-contract-card",fill:"var(--component-tag-label-color-default)"}),label:o().createElement(Ce.RemainingTime,{end_time:a,format:r,getCardLabels:i.getCardLabelsV2,start_time:n}),size:"sm",variant:"custom"})}));function Kf(e){return Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kf(e)}function Jf(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=Kf(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Kf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kf(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Zf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zf(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Qf=(0,he.observer)((function(e){var t,r,n,a,l,c,s=e.label,u=e.modal_body_content,d=e.is_deal_cancellation,f=void 0!==d&&d,m=e.value,p=e.type,y=Xf(o().useState(Boolean(m)),2),_=y[0],v=y[1],h=Xf(o().useState(!1),2),b=h[0],g=h[1],E=Xf(o().useState(!1),2),S=E[0],w=E[1],A=Xf(o().useState(),2),O=A[0],k=A[1],x=Xf(o().useState(!1),2),C=x[0],j=x[1],T=ff(),L=T.contract_info,P=T.contract,N=L.contract_type,I=L.currency,D=L.validation_params,M=P.validation_errors,z=P.updateLimitOrder,R=P.clearContractUpdateConfigValues,F=(0,i.isValidToCancel)(L),U=(0,i.isAccumulatorContract)(N),q=(0,Qu.Dd)(L);o().useEffect((function(){return m&&(k(m),v(Boolean(m))),function(){return R()}}),[R,m]);var B=F,V=Math.abs(m),H="contract_update_".concat(p),G=null!==(t=null===(r=M[H])||void 0===r?void 0:r[0])&&void 0!==t?t:"",Y=F?o().createElement(J.Localize,{i18n_default_text:"Take profit and/or stop loss are not available while deal cancellation is active."}):null,W=Jf(Jf(Jf({},i.CONTRACT_TYPES.ACCUMULATOR,o().createElement(J.Localize,{i18n_default_text:"Take profit cant be adjusted for ongoing accumulator contracts."})),i.CONTRACT_TYPES.MULTIPLIER.UP,Y),i.CONTRACT_TYPES.MULTIPLIER.DOWN,Y),$=p&&(null!==(n=null==D||null===(a=D[p])||void 0===a?void 0:a.min)&&void 0!==n?n:0),K=p&&(null!==(l=null==D||null===(c=D[p])||void 0===c?void 0:c.max)&&void 0!==l?l:0),X=function(){var e="take_profit"===p?(0,J.localize)("take profit"):(0,J.localize)("stop loss");return O?$&&+O<+$?(0,J.localize)("Please enter a {{field_label}} amount that's at least {{min_value}}.",{field_label:e,min_value:$}):K&&+O>+K?(0,J.localize)("Maximum {{field_label}} allowed is {{max_value}}.",{field_label:e,max_value:K}):G:(0,J.localize)("Please enter a {{field_label}} amount.",{field_label:e})},Z=C?X():"";return o().createElement("div",{className:"risk-management-item__container"},o().createElement("div",{className:"risk-management-item"},o().createElement("span",{className:"risk-management-item__title"},o().createElement(Ie.E,{size:"sm"},s),o().createElement(Wf,{header_content:s,body_content:u,info_message:W[N]||""})),!f&&(U&&I?o().createElement(Ie.E,{size:"sm"},(0,i.formatMoney)(I,V,!0)," ",I):o().createElement(ji.j,{disabled:B,checked:_,onChange:function(e){var t;(R(),e)?(g(!0),k(""),w(!0),j(!1)):(null===(t=P.onChange)||void 0===t||t.call(P,{name:"has_contract_update_".concat(p),value:e}),z(),v(!_))}})),F&&f&&o().createElement($f,null)),!U&&_&&I&&o().createElement(Ii.A,{variant:"fill",inputSize:"md",disabled:b,textAlignment:"center",value:"".concat((0,i.formatMoney)(I,"stop_loss"==p?-V:V,!0)," ").concat(I),onClick:function(){R(),k(V),g(!0),j(!1)},onFocus:function(){return g(!0)}}),o().createElement(De.A.Root,{expandable:!1,isOpen:b,position:"left",onClose:function(){w(!1),g(!1),j(!1)}},o().createElement(De.A.Portal,{shouldCloseOnDrag:!0},o().createElement(De.A.Header,{title:s}),o().createElement(De.A.Content,{className:"risk-management-item__action-sheet-content"},b&&o().createElement(De.T,{allowDecimals:!0,allowSign:!1,className:"text-field--custom",customType:"commaRemoval",decimals:(0,i.getDecimalPlaces)(I),message:Z,minusDisabled:Number(O)-1<=0,name:p,noStatusIcon:!0,onChange:function(e){var t,r=e.target.value;k(r),j(!0),null===(t=P.onChange)||void 0===t||t.call(P,{name:"contract_update_".concat(p),value:r})},placeholder:(0,J.localize)("Amount"),regex:/[^0-9.,]/g,status:Z?"error":"neutral",textAlignment:"center",inputMode:"decimal",unitLeft:(0,i.getCurrencyDisplayCode)(I),value:O,variant:"fill"}),!!q&&o().createElement(Gd,{currency:(0,i.getCurrencyDisplayCode)(I),is_bold:!1,totalProfitLoss:q})),o().createElement(De.A.Footer,{shouldCloseOnPrimaryButtonClick:!1,primaryAction:{content:o().createElement(J.Localize,{i18n_default_text:"Save"}),onAction:function(){j(!0);var e=X();if(e){var t;null===(t=P.onChange)||void 0===t||t.call(P,{name:H,value:e})}else{var r;if(S)null===(r=P.onChange)||void 0===r||r.call(P,{name:"has_contract_update_".concat(p),value:!0}),w(!1);z(),g(!1)}}}}))))}));const em=Qf;const tm=(0,he.observer)((function(){var e,t,r=ff().contract_info,n=r.limit_order;return Vf(null!==(e=r.contract_type)&&void 0!==e?e:"").isTakeProfitVisible?o().createElement(em,{label:o().createElement(J.Localize,{i18n_default_text:"Take profit"}),modal_body_content:o().createElement(J.Localize,{i18n_default_text:"When your profit reaches or exceeds the set amount, your trade will be closed automatically."}),value:null==n||null===(t=n.take_profit)||void 0===t?void 0:t.order_amount,type:"take_profit"}):null}));const rm=(0,he.observer)((function(){var e,t,r=ff().contract_info,n=r.limit_order;return Vf(null!==(e=r.contract_type)&&void 0!==e?e:"").isStopLossVisible?o().createElement(em,{label:o().createElement(J.Localize,{i18n_default_text:"Stop loss"}),modal_body_content:o().createElement(J.Localize,{i18n_default_text:"When your loss reaches or exceeds the set amount, your trade will be closed automatically."}),value:null==n||null===(t=n.stop_loss)||void 0===t?void 0:t.order_amount,type:"stop_loss"}):null}));const nm=(0,he.observer)((function(){var e,t=ff().contract_info,r=Vf(null!==(e=t.contract_type)&&void 0!==e?e:"").isDealCancellationVisible;return(0,i.isValidToCancel)(t)&&r&&(0,i.isOpen)(t)?o().createElement(rf,null,o().createElement(em,{label:o().createElement(J.Localize,{i18n_default_text:"Deal cancellation"}),modal_body_content:o().createElement(J.Localize,{i18n_default_text:"When this is active, you can cancel your trade within the chosen time frame. Your stake will be returned without loss."}),is_deal_cancellation:!0})):null}));var om=r("../../node_modules/@deriv-com/utils/dist/deriv-utils.js");function am(){return am=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},am.apply(null,arguments)}var im=(0,he.observer)((function(e){var t=e.contract_info,r=t.bid_price,n=t.currency,a=t.contract_id,l=t.cancellation,c=(void 0===l?{}:l).date_expiry,u=t.profit,d=t.contract_type,f=(0,s.A)(),m=f.contract_replay,p=f.common.server_time,y=m.onClickCancel,_=m.onClickSell,v=m.is_sell_requested,h=(0,i.isValidToSell)(t),b=(0,i.isValidToCancel)(t),g=(0,i.isMultiplierContract)(d),E=(0,i.getCardLabelsV2)(),S=om.DW.formatMoney(r||0,{currency:n}),w=Number(u)<0&&b,A=w?"":"".concat(S," ").concat(n),O="".concat(E.CLOSE," ").concat(A),k={color:"black-white",size:"lg",fullWidth:!0};return o().createElement("div",{className:"contract-details-footer--container"},g?o().createElement(o().Fragment,null,o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(Or.$n,am({label:O,isLoading:v,disabled:w,onClick:function(){return _(a)}},k))),b&&o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(Or.$n,am({onClick:function(){return y(a)},label:o().createElement(o().Fragment,null,E.CANCEL," ",o().createElement(Ce.RemainingTime,{as:"span",end_time:c,format:"mm:ss",getCardLabels:i.getCardLabelsV2,start_time:p})),disabled:Number(u)>=0,variant:"secondary"},k)))):o().createElement("span",{className:"contract-details-footer-button__wrapper"},o().createElement(Or.$n,am({label:h?"".concat(E.CLOSE," ").concat(S," ").concat(n):E.RESALE_NOT_OFFERED,isLoading:v&&h,isOpaque:!0,onClick:h?function(){return _(a)}:void 0,disabled:!h,variant:"primary"},k))))}));const lm=im;const cm=function(e){var t=e.class_name,r=e.contract_info,n=e.server_time,a=r.purchase_time,l=r.sell_time,c=r.shortcode,s=!!l||(0,i.isEnded)(r),u=(0,i.isForwardStarting)(null!=c?c:"",a),d=(0,i.getStartTime)(null!=c?c:""),f=(0,i.hasForwardContractStarted)(null!=c?c:"");return u&&!!d&&!f&&!s?o().createElement("div",{className:(0,je.A)("banner__wrapper",t)},o().createElement("div",{className:"banner__content--left"},o().createElement(Kt.O,{size:"sm",className:"banner__text"},o().createElement(J.Localize,{i18n_default_text:"This contract starts on"})),o().createElement(Kt.O,{bold:!0,size:"sm",className:"banner__text"},(0,i.formatDate)((0,i.toMoment)(parseInt(d||"")),"DD MMM YYYY"),", ",(0,i.formatTime)(parseInt(d||""),"HH:mm [GMT]"))),o().createElement(Ie.E,{bold:!0,size:"md",className:"banner__timer",as:"div"},o().createElement(Xt.A,{fill:"var(--component-textIcon-static-prominentDark)"}),o().createElement(Ce.RemainingTime,{as:"span",className:"banner__timer__countdown",end_time:parseInt(d||""),getCardLabels:i.getCardLabels,start_time:n,key:"remaining-time"}))):null};var sm=r("../../node_modules/@deriv/quill-icons/dist/esm/react/LabelPaired/LabelPairedArrowLeftSmBoldIcon.js");const um=(0,he.observer)((function(){var e=(0,Se.useLocation)().state,t=(0,Se.useHistory)(),r=(0,s.A)().common.routeBackInApp;return o().createElement("header",{className:"header contract-details-header-v2"},o().createElement(o().Suspense,{fallback:o().createElement("div",null)},o().createElement(ta.K,{variant:"tertiary",icon:o().createElement(sm.A,{height:"22px",width:"13px","data-testid":"arrow",key:"arrow"}),className:"arrow",color:"black-white",onClick:function(){return!(0,i.isEmptyObject)(e)&&e.from_table_row?t.goBack():r(t)}}),o().createElement(Ie.E,{size:"md",bold:!0,color:"quill-typography__color--prominent"},o().createElement(J.Localize,{i18n_default_text:"Contract details"}))))}));function dm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fm(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fm(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fm(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var mm=(0,he.observer)((function(){var e,t,r=ff(),n=r.contract_info,a=r.is_loading,l=n.contract_id,c=n.currency,u=n.contract_type,d=n.limit_order,f=null!=d?d:{take_profit:{},stop_loss:{}},m=f.take_profit,p=f.stop_loss,y=dm(o().useState([]),2),_=y[0],v=y[1],h=(0,s.A)().common.server_time,b=Vf(null!=u?u:""),g=b.isTakeProfitVisible,E=b.isStopLossVisible,S=(0,i.isValidToSell)(n),w=o().useCallback((function(e){e&&i.WS.contractUpdateHistory(e).then((function(e){v(e.contract_update_history.sort((function(e,t){return Number(null==t?void 0:t.order_date)-Number(null==e?void 0:e.order_date)})))})).catch((function(){return null}))}),[]);if(o().useEffect((function(){w(l)}),[l,null==m?void 0:m.order_amount,null==p?void 0:p.order_amount,w]),a)return o().createElement(Ce.Loading.DTraderV2,{is_contract_details:!0});var A=(0,i.isMultiplierContract)(n.contract_type),O=(0,i.isValidToCancel)(n),k=((0,i.hasContractEntered)(n)||(0,i.isForwardStarting)(null!==(e=null==n?void 0:n.shortcode)&&void 0!==e?e:"",n.purchase_time))&&(0,i.isOpen)(n),x=Vf(null!==(t=n.contract_type)&&void 0!==t?t:""),C=x.isTpHistoryVisible,j=x.isDealCancellationVisible,T=A&&O,L=(0,i.isOpen)(n)&&(g||E)&&(S||j);return(0,i.isAccumulatorContract)(n.contract_type)&&(L=(0,i.isOpen)(n)&&Boolean(d)),o().createElement(o().Fragment,null,o().createElement(um,null),o().createElement("div",{className:bt()("contract-details",{"contract-details--two-buttons":k&&T,"contract-details--one-button":k&&!T})},o().createElement(cm,{contract_info:n,server_time:h}),o().createElement(yd,{contractInfo:n,serverTime:h,currency:c}),o().createElement(pf,null),o().createElement(nm,null),L&&o().createElement(rf,null,o().createElement(tm,null),o().createElement(rm,null)),o().createElement(Ff,{contract_info:n}),o().createElement(df,{contract_info:n}),o().createElement(af,{contract_info:n}),C&&_.length>0&&o().createElement(uf,{history:_,currency:c,is_multiplier:A})),k&&o().createElement(lm,{contract_info:n}))}));const pm=mm;const ym=[{path:i.routes.trade,component:Zu,exact:!0,default:!1},{path:i.routes.trader_positions,component:ef,is_authenticated:!0,default:!1},{path:i.routes.contract,component:pm,is_authenticated:!0,default:!1},{path:"/*",component:(0,n.lazy)((function(){return Promise.resolve().then(r.bind(r,"./src/Modules/Page404/index.ts"))})),default:!1}];var _m=r("./src/Modules/Page404/index.ts");function vm(){return vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vm.apply(null,arguments)}const hm=(0,he.observer)((function(){var e=(0,s.A)(),t=e.client,r=e.common,a=e.portfolio,i=t.is_logged_in,l=r.current_language,c=a.onMount,u=a.onUnmount;return o().useEffect((function(){return c(),u}),[]),o().createElement(n.Suspense,{fallback:o().createElement(Ce.UILoader,null)},o().createElement(Se.Switch,null,ym.map((function(e,t){return o().createElement(Ce.RouteWithSubroutes,vm({key:t,is_logged_in:i,language:l,Component404:_m.default,should_redirect_login:!0,routes:ym,to:""},e))}))))}));function bm(e){return bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bm(e)}function gm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Em(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=bm(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bm(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bm(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Sm=(0,he.observer)((function(){var e,t=(0,s.A)(),r=t.common,n=r.services_error,a=r.resetServicesError,l=t.ui.is_mf_verification_pending_modal_visible,c=t.client.is_logged_in,u=(0,ze.P)(),d=u.is_multiplier,f=u.proposal_info,m=u.validation_errors,p=u.trade_types,y=u.contract_type,_=u.trade_type_tab,v=ff().contract_info,h=(0,Dr.d)().addSnackbar,b=(0,Se.useLocation)().pathname,g=n||{},E=g.code,S=g.message,w=!(0,i.isEmptyObject)(n),A=ot({services_error:n,is_mf_verification_pending_modal_visible:l}),O=null!==(e=f[(0,Mt.H1)(p,y,_)[0]])&&void 0!==e?e:{},k=O.has_error,x=O.error_field,C=O.message,j=k&&!x&&!Object.keys(m).some((function(e){return m[e].length})),T=!(!w&&!j)&&(b===i.routes.trade?w&&!A||j:!(b!==i.routes.trader_positions&&!location.pathname.startsWith("/contract/"))&&w),L=T&&E===nt,P=location.pathname.startsWith("/contract/")&&d&&(0,i.isValidToCancel)(v)?"104px":"48px",N={actionText:(0,J.localize)("View"),onActionClick:function(){return window.open((0,i.getStaticUrl)("tnc/trading-terms.pdf",!0))}};return o().useEffect((function(){T&&h(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gm(Object(r),!0).forEach((function(t){Em(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({message:null!=S?S:C,status:"fail",hasCloseButton:!0,hasFixedHeight:!1,onSnackbarRemove:a,style:{marginBottom:c?P:"-8px",width:"calc(100% - var(--core-spacing-800)"}},L?N:{}))}),[T,L]),o().createElement(Wa.C,null)}));const wm=Sm;function Am(e){return function(e){if(Array.isArray(e))return Om(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Om(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Om(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Om(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const km=function(e){var t=e.passthrough,r=(0,a.A)(t.root_store,t.WS);return o().useEffect((function(){return function(){return r.ui.setPromptHandler(!1)}}),[r]),o().useLayoutEffect((function(){var e,t,r=document.head,n=r.querySelectorAll('link[rel="stylesheet"]'),o=null===(e=n[n.length-1])||void 0===e||null===(t=e.href)||void 0===t?void 0:t.includes("/trader"),a=Am(n).filter((function(e){var t;return null==e||null===(t=e.href)||void 0===t?void 0:t.includes("/trader")}));if(!o){var i=null==a?void 0:a.map((function(e){return null==e?void 0:e.cloneNode(!0)}));return i.forEach((function(e){return r.appendChild(e)})),function(){return null==i?void 0:i.forEach((function(e){return r.removeChild(e)}))}}}),[]),o().useEffect((function(){window.location.pathname===i.routes.trade&&(0,Ho._S)()}),[window.location.pathname]),o().createElement(c.A,{store:r},o().createElement(ye,null,o().createElement(l.A,{store:r},o().createElement(_e._,null,o().createElement(ve.n,null,o().createElement(xe,null),o().createElement(hm,null),o().createElement(wm,null))))))}},"./src/Modules/Contract/Containers/contract-replay-widget.tsx":(e,t,r)=>{r.d(t,{dO:()=>A,fy:()=>w,$i:()=>E,WN:()=>S});var n=r("react"),o=r.n(n),a=r("./src/Modules/Contract/Components/Digits/index.ts"),i=r("./src/App/Components/Animations/index.ts"),l=r("../../node_modules/classnames/index.js"),c=r.n(l),s=r("@deriv/components"),u=r("@deriv/translations"),d=r("@deriv/shared"),f=r("mobx-react-lite"),m=r("../stores/src/useStore.ts");function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,l=[],c=!0,s=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}const _=(0,f.observer)((function(e){var t=e.contract_info,r=(0,m.A)().ui.is_mobile,n=r?47:150,a=p(o().useState(!0),2),i=a[0],l=a[1],f=function(e){e?(e.preventDefault(),("keydown"!==e.type||"keydown"===e.type&&"Enter"===e.key)&&l(!i)):l(!i)};return o().createElement("div",{className:"info-box-longcode"},o().createElement(s.Icon,{icon:"IcContractFlag",className:"info-box-longcode-icon",size:24}),o().createElement("div",{className:"info-box-longcode-wrapper",onClick:r?f:void 0,onKeyDown:f},o().createElement(s.Text,{size:"xs",className:c()("info-box-longcode-text",{"info-box-longcode-text--collapsed":i||r,"info-box-longcode-text--collapsed--fixed-height":!d.isTabletOs&&(i||r)})},t.longcode)," ",(null==t?void 0:t.longcode)&&t.longcode.length>n&&o().createElement(s.Text,{as:"a",href:"#",size:"xs",onClick:f,className:"info-box-longcode-text"},i||r?o().createElement(u.Localize,{i18n_default_text:"View more"}):o().createElement(u.Localize,{i18n_default_text:"View less"}))),o().createElement(s.Modal,{className:"info-box-longcode--modal",is_open:r&&!i,title:o().createElement(u.Localize,{i18n_default_text:"Trade info"}),has_close_icon:!1,should_close_on_click_outside:!0,small:!0,toggleModal:f},o().createElement(s.Modal.Body,null,o().createElement(s.Text,{size:"xs"},t.longcode)),o().createElement(s.Modal.Footer,null,o().createElement(s.Button,{className:"info-box-longcode--modal-button",primary:!0,large:!0,onClick:f},o().createElement(u.Localize,{i18n_default_text:"OK"})))))}));const v=function(e){var t=e.message,r=void 0===t?"":t,n=e.onClickClose;return r?o().createElement("div",{className:"message"},o().createElement("div",{className:"message-icon"},o().createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16"},o().createElement("g",{fill:"none",fillRule:"evenodd"},o().createElement("circle",{cx:"8",cy:"8",r:"8",fill:"#F44336"}),o().createElement("path",{fill:"#FFF",fillRule:"nonzero",d:"M8 7.293l3.146-3.147a.5.5 0 0 1 .708.708L8.707 8l3.147 3.146a.5.5 0 0 1-.708.708L8 8.707l-3.146 3.147a.5.5 0 0 1-.708-.708L7.293 8 4.146 4.854a.5.5 0 1 1 .708-.708L8 7.293z"})))),o().createElement("div",{className:"message-text"},r),o().createElement("div",{className:"message-close",onClick:n},o().createElement(s.Icon,{icon:"IcCross"}))):null};const h=function(e){var t=e.contract_info,r=e.error_message,n=e.removeError,a=!!t.longcode;return o().createElement(i.F,{is_visible:a,className:"info-box-container",keyname:"info-box-container"},!!t.contract_type&&o().createElement("div",{className:"info-box"},o().createElement(_,{contract_info:t})),o().createElement(v,{message:r,onClickClose:n}))};var b=r("./src/Modules/SmartChart/Components/bottom-widgets.tsx"),g=r("./src/Modules/SmartChart/Components/top-widgets.tsx"),E=(0,f.observer)((function(){var e=(0,m.A)(),t=e.contract_replay,r=e.ui.is_mobile,n=t.contract_store,i=n.contract_info,l=n.digits_info,c=n.display_status,s=n.is_digit_contract,u=n.is_ended;return o().createElement(a.A,{is_digit_contract:s,is_ended:u,is_mobile:r,contract_info:i,digits_info:l,display_status:c})})),S=(0,f.observer)((function(){var e=(0,m.A)().contract_replay,t=e.contract_store,r=e.removeErrorMessage,n=e.error_message,a=t.contract_info;return o().createElement(h,{contract_info:a,error_message:n,removeError:r})})),w=function(){return o().createElement(g.A,{InfoBox:o().createElement(S,null),is_title_enabled:!1})},A=function(){return o().createElement(b.A,{Widget:o().createElement(E,null)})}},"./src/Modules/Contract/Containers/replay-chart.tsx":(e,t,r)=>{r.d(t,{A:()=>_});var n=r("react"),o=r.n(n),a=r("@deriv/components"),i=r("@deriv/shared"),l=r("mobx-react-lite"),c=r("../stores/src/useStore.ts"),s=r("./src/Stores/useTraderStores.tsx"),u=r("./src/Modules/Contract/Containers/contract-replay-widget.tsx"),d=r("./src/Modules/SmartChart/Components/Markers/marker.tsx"),f=function(e){var t=e.contract_info,r=null!=t?t:{},n=r.contract_type,a=r.entry_spot,i=r.reset_time,l=r.reset_barrier,c=/CALL/i.test(null!=n?n:""),s=Math.max(Number(a),Number(l));return c&&(s=Math.min(Number(a),Number(l))),o().createElement(o().Fragment,null,o().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(i),y:s},marker_content_props:{className:"sc-barrier_gradient sc-barrier_gradient--".concat(c?"to-bottom":"to-top")}}),o().createElement(d.A,{is_positioned_behind:!0,marker_config:{ContentComponent:"div",x:Number(i),y:Number(l)},marker_content_props:{className:"sc-reset_barrier"}}))};const m=o().memo(f);var p=r("./src/Modules/SmartChart/index.js"),y=r("../../node_modules/@deriv-com/ui/dist/hooks/useDevice.js");const _=(0,l.observer)((function(e){var t,r=e.is_dark_theme_prop,n=e.is_accumulator_contract,l=e.is_reset_contract,f=e.is_vertical_scroll_disabled,_=(0,s.P)(),v=(0,c.A)(),h=v.contract_replay,b=v.common,g=v.ui,E=(0,y.Y)().isMobile,S=h.contract_store,w=h.chart_state,A=h.chartStateChange,O=h.margin,k=S.contract_config,x=S.is_digit_contract,C=S.barriers_array,j=S.getContractsArray,T=S.markers_array,L=S.contract_info,P=L.underlying,N=L.audit_details,I=L.barrier_count,D="READY"===w||"SCROLL_TO_LEFT"===w,M=b.app_routing_history,z=b.current_language,R=b.is_socket_opened,F=g.is_chart_layout_default,U=g.is_chart_countdown_visible,q=k||{},B=q.end_epoch,V=q.chart_type,H=q.start_epoch,G=q.granularity,Y=r||g.is_dark_mode_on,W=!(null==L||!L.is_forward_starting||(0,i.hasContractStarted)(L)||!L.is_sold),$="DBot"===(0,i.getPlatformRedirect)(M).name,K={language:z,theme:Y&&!$?"dark":"light",position:F?"bottom":"left",countdown:U,assetInformation:!1,isHighestLowestMarkerEnabled:!1},J=D&&k?k.scroll_to_epoch:void 0,X=N?N.all_ticks:[],Z=_.wsForget,Q=_.wsSubscribe,ee=_.wsSendRequest,te=_.wsForgetStream,re=function(){return!E&&x},ne=(0,a.usePrevious)(H),oe=!!(0,i.getEndTime)(L),ae=(0,i.isDtraderV2DesktopEnabled)(g.is_desktop)||(0,i.isDtraderV2MobileEnabled)(g.is_mobile);return o().createElement(p.GR,{id:"replay",barriers:C,bottomWidgets:re()?u.dO:void 0,chartControlsWidgets:null,chartType:V,endEpoch:B,margin:O,isMobile:E,enabledNavigationWidget:!E,enabledChartFooter:!1,granularity:G,requestAPI:ee,requestForget:Z,requestForgetStream:te,crosshair:E?0:void 0,maxTick:E?8:void 0,requestSubscribe:Q,settings:K,startEpoch:W?L.purchase_time:H,scrollToEpoch:J,stateChangeListener:A,symbol:P,allTicks:X,topWidgets:ae?function(){return o().createElement(o().Fragment,null)}:u.fy,isConnectionOpened:R,isStaticChart:!!n&&!!B&&Number(H)<Number(ne),shouldFetchTradingTimes:!1,should_zoom_out_on_yaxis:n,yAxisMargin:(t={top:E?96:148,bottom:re()?128:112},E&&(t.bottom=48,t.top=48),t),anchorChartToLeft:E,shouldFetchTickHistory:"seconds"!==(0,i.getDurationUnitText)((0,i.getDurationPeriod)(L))||"open"===L.status,shouldDrawTicksFromContractInfo:n,contractInfo:L,contracts_array:j(),isLive:!oe,isVerticalScrollEnabled:!f,startWithDataFitMode:!0},T.map((function(e){var t=e.content_config,r=e.marker_config,n=e.react_key,a=e.type;return o().createElement(d.A,{key:n,marker_config:r,marker_content_props:t,is_positioned_before:("SPOT_ENTRY"===a||"SPOT_EXIT"===a)&&2===I})})),l&&(null==L?void 0:L.reset_time)&&o().createElement(m,{contract_info:L}))}))},"./src/Stores/Modules/Trading/Helpers/end-time.ts":(e,t,r)=>{r.d(t,{X:()=>i,h:()=>l});var n=r("../../node_modules/moment/moment.js"),o=r.n(n),a=function(e,t){var r=o()(e);return r.minute(Math.ceil(r.minute()/t)*t)},i=function(e,t,r,n){for(var i=0;i<r.length;i++)if(t.isAfter(r[i])&&t.isBefore(n[i]))return a(t,5).format("HH:mm");for(var l=0;l<r.length;l++){var c=o()(r[l]);if(c.isAfter(e))return a(c,5).format("HH:mm")}return a(e,5).format("HH:mm")},l=function(e,t,r){var n={start:t.map((function(t){return e.isBefore(t)?o()(t).clone():e})),end:r};return n.start.length>0&&(n.start[0]=a(n.start[0],5)),n}},"./src/Stores/Modules/Trading/Helpers/logic.ts":(e,t,r)=>{r.d(t,{d:()=>o});var n=r("./src/_common/base/server_time.ts"),o=function(e){var t;return!(null===(t=e.cancellation)||void 0===t||!t.date_expiry)&&e.cancellation.date_expiry<n.A.get().unix()}}}]);
//# sourceMappingURL=trader.trader-app-v2.bae6f5f000fa003d8c4b.js.map